---
**Author:** CCN
**CreationDate:** D:20200608182358+02'00'
**ModDate:** D:20200608182358+02'00'
---

<!-- Página 1 de 37 -->

Guía de Seguridad de las TIC
CCN-STIC 858
Implantación de sistemas SaaS en modo local (on-premise)
Junio 2020

![Imagen 1 - Página 1](858 DD_assets\pagina1_img1.jpeg)

![Imagen 2 - Página 1](858 DD_assets\pagina1_img2.jpeg)

![Imagen 3 - Página 1](858 DD_assets\pagina1_img3.png)

---

<!-- Página 2 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
Edita:
 Centro Criptológico Nacional, 2020
NIPO: 083-20-107-X
Fecha de Edición: junio de 2020
LIMITACIÓN DE RESPONSABILIDAD
El presente documento se proporciona de acuerdo con los términos en él recogidos, rechazando
expresamente cualquier tipo de garantía implícita que se pueda encontrar relacionada. En ningún caso,
el Centro Criptológico Nacional puede ser considerado responsable del daño directo, indirecto, fortuito
o extraordinario derivado de la utilización de la información y software que se indican incluso cuando se
advierta de tal posibilidad.
AVISO LEGAL
Quedan rigurosamente prohibidas, sin la autorización escrita del Centro Criptológico Nacional, bajo las
sanciones establecidas en las leyes, la reproducción parcial o total de este documento por cualquier
medio o procedimiento, comprendidos la reprografía y el tratamiento informático, y la distribución de
ejemplares del mismo mediante alquiler o préstamo públicos.
2
Centro Cript ológico Nacional 2

![Imagen 1 - Página 2](858 DD_assets\pagina2_img1.png)

![Imagen 2 - Página 2](858 DD_assets\pagina2_img2.png)

![Imagen 3 - Página 2](858 DD_assets\pagina2_img3.png)

![Imagen 4 - Página 2](858 DD_assets\pagina2_img4.png)

![Imagen 5 - Página 2](858 DD_assets\pagina2_img5.jpeg)

---

<!-- Página 3 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
PRÓLOGO
En un mundo cada vez más complejo y globalizado, en el que las tecnologías de la información
y la comunicación (TIC) desempeñan un papel de suma importancia, hemos de ser conscientes
de que la gestión adecuada de la ciberseguridad constituye un reto colectivo al que
necesariamente hemos de enfrentar. Resulta necesario garantizar la protección de la
capacidad económica, tecnológica y política de nuestro país, máxime cuando la proliferación
de ataques dirigidos y el robo de información sensible representan una realidad incontestable.
Por ello, resulta imprescindible estar al día de las amenazas y vulnerabilidades asociadas al uso
de las nuevas tecnologías. El conocimiento de los riesgos que se ciernen sobre el ciberespacio
ha de servir para implementar con garantías las medidas, tanto procedimentales como
técnicas y organizativas, que permitan un entorno seguro y confiable.
La Ley 11/2002, de 6 de mayo, reguladora del Centro Nacional de Inteligencia (CNI),
encomienda al Centro Nacional de Inteligencia el ejercicio de las funciones relativas a la
seguridad de las tecnologías de la información y de protección de la información clasificada, a
la vez que confiere a su Secretario de Estado Director la responsabilidad de dirigir el Centro
Criptológico Nacional (CCN).
Partiendo del conocimiento y la experiencia del CNI sobre amenazas y vulnerabilidades en
materia de riesgos emergentes, el Centro realiza, a través del Centro Criptológico Nacional,
regulado por el Real Decreto 421/2004, de 12 de marzo, diversas actividades directamente
relacionadas con la seguridad de las TIC, orientadas a la formación de personal experto, al
empleo de tecnologías de seguridad adecuadas y a la aplicación de políticas y procedimientos
de seguridad.
Precisamente, esta serie de documentos CCN-STIC es un claro reflejo de la labor que este
organismo lleva a cabo en materia de implementación de seguridad, permitiendo la aplicación
de políticas y procedimientos, pues las guías han sido elaboradas con un claro objetivo:
mejorar el grado de ciberseguridad de las organizaciones, conscientes de la importancia que
tiene el establecimiento de un marco de referencia en esta materia que sirva de apoyo para
que el personal de la Administración lleve a cabo la difícil tarea de proporcionar seguridad a
los sistemas de las TIC bajo su responsabilidad.
Con esta serie de documentos, el Centro Criptológico Nacional, en cumplimiento de sus
cometidos y de lo reflejado en el Real Decreto 3/2010 por el que se regula el Esquema
Nacional en el ámbito de la Administración electrónica, contribuye a mejorar la ciberseguridad
española y mantener las infraestructuras y los sistemas de información de todas las
administraciones públicas con unos niveles óptimos de seguridad. Todo ello, con el fin de
generar confianza y garantías en el uso de estas tecnologías, protegiendo la confidencialidad
de los datos y garantizando su autenticidad, integridad y disponibilidad.
Junio de 2020
Paz Esteban López
Secretaria de Estado
Directora del Centro Criptológico Nacional
3
Centro Cript ológico Nacional 3

![Imagen 1 - Página 3](858 DD_assets\pagina3_img1.png)

![Imagen 2 - Página 3](858 DD_assets\pagina3_img2.png)

![Imagen 3 - Página 3](858 DD_assets\pagina3_img3.png)

![Imagen 4 - Página 3](858 DD_assets\pagina3_img4.png)

![Imagen 5 - Página 3](858 DD_assets\pagina3_img5.png)

---

<!-- Página 4 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
ÍNDICE
1. INTRODUCCIÓN ................................................................................................................ 5
2. OBJETO ............................................................................................................................. 5
3. ALCANCE .......................................................................................................................... 6
4. IDENTIFICACIÓN Y ACTUALIZACION DE LAS GUIAS ............................................................ 6
5. GUÍA DE INSTALACIÓN Y CONFIGURACIÓN SEGURA DEL SISTEMA .................................... 6
5.1 PRESENTACIÓN Y ARQUITECTURA DE LA SOLUCIÓN .......................................................... 7
5.2 ACCIONES NECESARIAS DE LOS ADMINISTRADORES EN LA INSTALACIÓN ........................ 7
5.3 MANUAL DEL ADMINISTRADOR ......................................................................................... 7
5.4 DIMENSIONAMIENTO DE LA SOLUCIÓN ............................................................................. 8
5.5 CÓMO ESTABLECER UNA CONFIGURACIÓN INICIAL SEGURA ............................................. 9
5.6 CONSIDERACIONES PARA ACTUALIZAR EL SISTEMA ........................................................... 9
5.7 CÓMO REALIZAR PRUEBAS DE INTEGRACIÓN DEL SISTEMA .............................................. 9
5.8 REQUISITOS DE SEGURIDAD ............................................................................................... 9
5.9 REQUISITOS DE SEGURIDAD Y CONTROLES DEL ENS IMPLEMENTADOS .......................... 10
5.10 COMUNICACIÓN DE INCIDENCIAS Y SOLICITUD DE SOPORTE .......................................... 10
5.11 CUALQUIER OTRO ASPECTO PARA MEJORAR DE LA SEGURIDAD..................................... 10
6. GUÍA DE USO SEGURO DEL SISTEMA ............................................................................... 11
6.1 APROXIMACIÓN A LA NORMATIVA DE USO DEL SISTEMA. .............................................. 11
6.2 CONFIGURACIONES Y PROCEDIMIENTOS DE SEGURIDAD QUE DEBAN SER REALIZADAS
POR LOS USUARIOS ................................................................................................................... 11
6.3 COMUNICACIÓN DE INCIDENCIAS Y SOLICITUD DE SOPORTE .......................................... 11
6.4 MANUAL DE USUARIO ...................................................................................................... 11
7. GUÍA DE LA RELACIÓN ENTRE CLIENTE Y PROVEEDOR ..................................................... 11
7.1 ASIGNACIÓN DE LA RESPONSABILIDAD DE CADA PARTE RESPECTO AL ANEXO II DEL ENS12
7.2 ANÁLISIS DE RIESGOS DE LA SOLUCIÓN IMPLANTADA ..................................................... 12
ANEXO I ............................................................................................................................... 14
ANEXO II .............................................................................................................................. 32
4
Centro Cript ológico Nacional 4

![Imagen 1 - Página 4](858 DD_assets\pagina4_img1.png)

![Imagen 2 - Página 4](858 DD_assets\pagina4_img2.png)

![Imagen 3 - Página 4](858 DD_assets\pagina4_img3.png)

![Imagen 4 - Página 4](858 DD_assets\pagina4_img4.png)

---

<!-- Página 5 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
1. INTRODUCCIÓN
Se han cumplido más de diez años desde que se promulgara el Real Decreto
3/2010, de 8 de enero, por el que se regula el Esquema Nacional de Seguridad en el
ámbito de la Administración Electrónica, modificado posteriormente por el Real
Decreto 951/2015. Posteriormente, se han promulgado cuatro (4) Instrucciones
Técnicas de Seguridad (ITS) en base a Resoluciones de la Secretaría de Estado de
Función Pública.
Asimismo, han transcurrido más de dos años desde que, con la participación de
la Entidad Nacional de Acreditación (ENAC), se desarrollara el Esquema de Certificación
del Esquema Nacional de Seguridad (ENS), referencial que ha servido para que, tras
superar las preceptivas auditorías, hayan obtenido la Certificación de Conformidad con
el ENS múltiples sistemas de información de entidades pertenecientes tanto al sector
público como al privado.
El camino recorrido ha permitido detectar aspectos que han surgido de la
constante evolución de los sistemas y del perfeccionamiento del propio Esquema de
Certificación del ENS. Una de tales circunstancias se da cuando una organización
contrata externamente un sistema, subsistema o solución integrante del mismo, que,
pese a haber sido originariamente diseñada o/y explotada en la Nube (en modalidad
SaaS, habitualmente), se implanta en la infraestructura tecnológica de la propia
organización cliente, en modo local; lo que se conoce como ON-PREMISE.
Mientras que en las soluciones prestadas desde la Nube las medidas de
seguridad corresponden casi en exclusiva al prestador del servicio, en las soluciones
implantadas ON-PREMISE las medidas de seguridad se reparten entre ambos:
proveedor que suministra y organización cliente que contrata.
El Anexo I de la presente Guía contiene una propuesta de reparto de la
responsabilidad de implantar las correspondientes medidas de seguridad, que deberá
acomodarse a cada caso en particular.
NOTA: Debe considerarse que el hecho de que un proveedor privado esté en posesión y
pueda exhibir la correspondiente Certificación de Conformidad con el Esquema
Nacional de Seguridad de los servicios soportados por su sistema de información, junto
con el hecho de que cualquier organización del Sector Público realice un adecuada
instalación de una solución externalizada conforme a las pautas de seguridad dadas
por el proveedor, no eximirán en ningún caso a la misma de sus obligaciones con
respecto al cumplimiento y adecuación del Real Decreto 3/2010 y por ello, conforme a
la Resolución de 13 de octubre de 2016, de la Secretaría de Estado de Administraciones
Públicas, por la que se aprueba la Instrucción Técnica de Seguridad de conformidad con
el Esquema Nacional de Seguridad, obtener la correspondiente Declaración o
Certificación de Conformidad acorde a la categoría de su sistema.
2. OBJETO
El objeto de esta Guía es desarrollar lo planteado, en primer lugar, en la Guía de
Seguridad CCN-STIC “CCN-CERT IC-01/19 ENS: Criterios adicionales de auditoría y
5
Centro Cript ológico Nacional 5

![Imagen 1 - Página 5](858 DD_assets\pagina5_img1.png)

![Imagen 2 - Página 5](858 DD_assets\pagina5_img2.png)

![Imagen 3 - Página 5](858 DD_assets\pagina5_img3.png)

![Imagen 4 - Página 5](858 DD_assets\pagina5_img4.png)

---

<!-- Página 6 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
certificación” y, posteriormente, en el abstract “Requisitos de Seguridad Adicionales
para Soluciones en la Nube (SaaS) implementadas en Modo Local”.
Cada proveedor de soluciones que haya de implantarse en la infraestructura
tecnológica de su cliente en modo local (ON-PREMISE) deberá adaptar el contenido de
este documento a su realidad concreta, considerando que ésta es la finalidad de las
guías: permitir conocer la seguridad inherente en la solución aportada, posibilitando
adaptarla y complementarla con la necesidad existente en cada organización cliente.
Por último, hay que señalar que, para que el sistema de información del
proveedor de servicios pueda alcanzar la Certificación de Conformidad con el ENS, será
necesario que se verifique la idoneidad de las adaptaciones concretas que se hayan
realizado y que, en consecuencia, se tomen como otro requisito añadido a tener en
cuenta para poder otorgar la referida Certificación. Concretamente, se verificarán la
Guía de instalación, la Guía de uso seguro y la Guía de relación entre proveedor y
cliente.
3. ALCANCE
Por practicidad, se han recogido en un único documento las tres (3) guías que se
han considerado necesarias que el proveedor de la solución implantada en modalidad
ON-PREMISE entregue a su cliente: la Guía de instalación (dirigida a administradores),
la Guía de uso seguro (dirigida a usuarios) y la Guía de relación entre proveedor y
cliente.
No obstante, forma parte de la responsabilidad del proveedor de la solución ON-
PREMISE entregar a su cliente tres (3) guías claramente diferenciadas, dado que se
dirigen a perfiles o colectivos distintos: administradores, usuarios y Responsable de
Seguridad y del Sistema.
4. IDENTIFICACIÓN Y ACTUALIZACION DE LAS GUIAS
Las guías que deben proporcionarse al cliente están sujetas a la evolución de las
soluciones suministradas, a la tecnología subyacente o utilizada en cada caso y a lo
dispuesto en el propio ENS y sus normas de desarrollo. En consecuencia, el proveedor
debe mantener las Guías permanentemente actualizadas y proporcionar, o poner a
disposición de sus clientes, las nuevas versiones que estén disponibles y que se
correspondan con los sistemas provistos a sus clientes.
Para ello se identificará claramente la versión y fecha de cada una de ellas, así
como la solución a la que va destinada. Siempre que sea posible, se incluirá un
apartado inicial donde se resuman los cambios más significativos respecto a la versión
anterior.
5. GUÍA DE INSTALACIÓN Y CONFIGURACIÓN SEGURA DEL SISTEMA
Esta guía está dirigida a los administradores del Sistema de Información del
cliente que contrata, para posibilitar la integración en la infraestructura tecnológica de
dicho cliente de un sistema, subsistema o solución, provista por un proveedor externo,
al que llamaremos “solución implantada”, bien haya sido desarrollada por el propio
6
Centro Cript ológico Nacional 6

![Imagen 1 - Página 6](858 DD_assets\pagina6_img1.png)

![Imagen 2 - Página 6](858 DD_assets\pagina6_img2.png)

![Imagen 3 - Página 6](858 DD_assets\pagina6_img3.png)

![Imagen 4 - Página 6](858 DD_assets\pagina6_img4.png)

---

<!-- Página 7 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
proveedor o por un tercero. En cualquier caso, la implementación habitualmente no la
realizará el propio cliente, aunque participe, sino el proveedor.
Esencialmente, el objeto de la citada Guía es instruir sobre el proceso de
instalación y parametrización de la solución, de manera que se mantenga la seguridad
en su conjunto y en todas las dimensiones de la misma. Por este motivo, los
administradores de la organización cliente podrán encontrar en la Guía la información
adecuada relativa a la interconexión de la solución con el resto de la arquitectura e
infraestructura del cliente, incluyendo aplicaciones, activos relacionados con la
tecnología y otros componentes para manejar la información.
Además, la citada Guía también podrá aportar recomendaciones de
configuración de otros activos no provisionados con la solución, pero que forman parte
de la red de la organización cliente donde se implanta y son necesarios para asegurar
el funcionamiento global.
Los epígrafes siguientes señalan los correlativos epígrafes de que debe disponer
la precitada Guía.
5.1 Presentación y arquitectura de la solución
 Se describirá la solución global, se mostrará gráficamente su arquitectura y se
describirán lo más detalladamente posible todos los módulos y elementos en
que se estructura, junto a las relaciones entre ellos.
 Se describirá, asimismo, la infraestructura necesaria en el cliente para
soportar la solución.
 Se describirá la integración de ambas infraestructuras (de la solución y del
cliente), proporcionándose advertencias de seguridad y de los posibles riesgos
derivados de su interacción.
5.2 Acciones necesarias de los administradores en la instalación
Se detallarán todas aquellas acciones necesarias por parte de los
administradores del sistema de información del cliente, que se requieren para
implantar la solución, así como para su posterior mantenimiento.
Además de incluir los extremos necesarios relativos a la configuración y
parametrización inicial de la solución implantada, el proveedor deberá indicar aquellas
precisiones o cautelas de las que tenga conocimiento y que, a su juicio, deban ser
adoptadas por el cliente en relación con otros productos que tenga instalados en su
infraestructura tecnológica y que deban interaccionar con la solución implantada.
5.3 Manual del administrador
Se describirá todo lo necesario que deba conocer el administrador de la
organización cliente para poder desarrollar sus responsabilidades respecto de la
solución implantada, durante todo su ciclo de vida.
Incidirá en aspectos tales como:
7
Centro Cript ológico Nacional 7

![Imagen 1 - Página 7](858 DD_assets\pagina7_img1.png)

![Imagen 2 - Página 7](858 DD_assets\pagina7_img2.png)

![Imagen 3 - Página 7](858 DD_assets\pagina7_img3.png)

![Imagen 4 - Página 7](858 DD_assets\pagina7_img4.png)

---

<!-- Página 8 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
 Estructuración y gestión de usuarios y grupos, junto a la asignación de
derechos de acceso.
 Configuración del nivel de detalle, contenido y funcionalidades que alimenten
las trazas de auditoría y posibilidades de consulta y exportación.
 Configuración de mecanismos de autenticación y su fortaleza, prestando
atención, si procede, a multifactor de autenticación (MFA), LDAP, etc.
 Acceso remoto seguro.
 Consejos de bastionado e información de seguridad por defecto (SbD) y
Privacidad por Defecto (PbD).
 Instalación de aplicaciones de la solución en servidores y, en su caso, en los
clientes de la red.
 Configuración de conexiones internas y externas, incluyendo posible envío de
e-mails y mensajes SMS.
 Desinstalación de productos.
 Metadatos en los documentos generados y/o almacenados.
 Purgado de las tablas de Base de Datos, automático o manual, con posibles
parametrizaciones y gestión de plazos de conservación.
 Implicaciones de protección de datos; y cualesquiera otros aspectos que se
considere relevante incluir.
La ausencia en este Manual del Administrador de cualquier contenido del que
pudiera derivarse una inadecuada configuración del sistema y que pudiera comportar
daños o perjuicios para la entidad cliente o los servicios prestados, será
responsabilidad del proveedor de la solución.
5.4 Dimensionamiento de la solución
Se proporcionará toda la información y tablas necesarias para que los
administradores del cliente puedan dimensionar los recursos necesarios para la
instalación y uso del sistema, evitando la falta de disponibilidad de los mismos, ya sea
de forma inicial o durante todo su ciclo de vida.
Deben considerarse los recursos necesarios en relación con:
 El procesador.
 Memoria.
 Nº de servidores físicos o virtuales.
 Almacenamiento.
 Ancho de banda de comunicaciones.
 Recursos de personal o accesorios hardware necesarios si procede, etc.
En función de parámetros claros:
 Nº de usuarios.
8
Centro Cript ológico Nacional 8

![Imagen 1 - Página 8](858 DD_assets\pagina8_img1.png)

![Imagen 2 - Página 8](858 DD_assets\pagina8_img2.png)

![Imagen 3 - Página 8](858 DD_assets\pagina8_img3.png)

![Imagen 4 - Página 8](858 DD_assets\pagina8_img4.png)

---

<!-- Página 9 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
 Nº de registros a ser tratados diariamente.
 Nº de trámites, etc.
5.5 Cómo establecer una configuración inicial segura
Para alcanzar un funcionamiento seguro de la solución contratada y del resto del
sistema en el que se integra, se considerarán tanto aquellos aspectos de configuración
de la propia solución, como de los elementos comunes de la infraestructura que la
soporta.
A modo de ejemplo, sin que se trate de una relación cerrada, se indicará:
 Subredes necesarias.
 Direccionamiento IP.
 Puertos empleados.
 Mecanismos de autenticación.
 Parámetros de la base de datos.
 Etc.
En este sentido, se utilizarán diagramas capaces de presentar estos conceptos de
forma clara.
5.6 Consideraciones para actualizar el sistema
En este apartado se informará del mecanismo que dispone el
prestador/fabricante para notificar la aparición de parches de seguridad, incluyendo
las vulnerabilidades corregidas y su criticidad, parches acumulativos periódicos
previstos y su frecuencia, precauciones a adoptar para su instalación, verificaciones,
copias de seguridad previas, etc.
También se detallarán las instrucciones específicas de actualización de versiones
y el formato de las hojas de anuncio de las mismas, caso de estar establecido.
5.7 Cómo realizar pruebas de integración del sistema
Se indicarán aquellas posibles pruebas de integración durante y/o tras la
instalación inicial, para garantizar que todos los elementos, ya sean los incluidos en la
solución o pertenecientes a la instalación del cliente, se integran de forma correcta sin
interferencias funcionales ni menoscabo de la seguridad.
5.8 Requisitos de seguridad
Se detallarán aquellos aspectos de la infraestructura del cliente que resultan
necesarios para dotar a la solución implantada del suficiente nivel de seguridad.
Es imperativo profundizar en el nivel de detalle de todo aquello que no se
corresponda con las exigencias o requisitos operativos privativos del negocio del
cliente. Por ejemplo, no bastará con señalar que se requiere un firewall, sino que,
cuando la acción deba ser responsabilidad del proveedor, habrá de especificarse el
9
Centro Cript ológico Nacional 9

![Imagen 1 - Página 9](858 DD_assets\pagina9_img1.png)

![Imagen 2 - Página 9](858 DD_assets\pagina9_img2.png)

![Imagen 3 - Página 9](858 DD_assets\pagina9_img3.png)

![Imagen 4 - Página 9](858 DD_assets\pagina9_img4.png)

---

<!-- Página 10 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
número de subredes a configurar, los puertos que se requieren abiertos de entrada y
salida y su finalidad, direccionamientos, posibles reglas a definir en los firewall, etc.
Los requisitos se determinarán en función de la categoría de seguridad del
sistema. Por ejemplo, para categoría ALTA podrá requerirse una cabina o un servidor
físico con los discos cifrados, si no es la propia aplicación la que cifre los datos.
5.9 Requisitos de seguridad y controles del ENS implementados
Se detallarán en este apartado, de forma resumida, aquellos aspectos de cada
medida de seguridad del Anexo II del ENS que resulten de aplicación atendiendo a la
categoría de seguridad del sistema, en el caso de que se satisfagan de origen.
Caso de no ser así, se indicará la alternativa correcta si hay más de una opción, o
bien se indicará que no se cumple, por lo que el cliente deberá apoyarse en otros
recursos, medidas compensatorias o complementarias de vigilancia.
5.10 Comunicación de incidencias y solicitud de soporte
Si el soporte a los usuarios del sistema lo realiza un Centro de Atención al Usuario
(CAU) del cliente, será éste el encargado de realizar las notificaciones de incidencias o
peticiones de soporte al proveedor. Para ello se especificarán los mecanismos de
notificación: teléfono, correo electrónico, formulario Web, etc., indicando el horario de
atención.
Se indicarán los SLA establecidos, en función de la urgencia de la incidencia o
petición de servicio, prestando especial atención a los incidentes de seguridad.
Si el proveedor asume el soporte directo a los usuarios de la organización cliente
donde se ha implantado la solución, se especificarán asimismo los mecanismos de
contacto y un estudio de la capacidad estimada de incidencias y peticiones de servicio
a tratar.
5.11 Cualquier otro aspecto para mejorar de la seguridad
Se detallará en este apartado cualquier otro aspecto a considerar para la mejora
de la seguridad, señalando sus ventajas e indicando si se trata de una práctica habitual
para este tipo de soluciones.
También se detallarán aquellos módulos o complementos de seguridad que,
siendo opcionales, no se incluyen en la solución de base y deban ser contratados
aparte, señalándose igualmente los beneficios de su incorporación y los riesgos de no
hacerlo.
Para sistemas de categoría ALTA, podría indicarse aquí todo lo necesario para
facilitar la elaboración de un Análisis de Impacto (BIA) al cliente, aportando el
generado por el proveedor en lo que se refiere a su servicio de soporte, y quizá
también el de mantenimiento correctivo, respecto a la solución implantada.
10
Centro Cript ológico Nacional 10

![Imagen 1 - Página 10](858 DD_assets\pagina10_img1.png)

![Imagen 2 - Página 10](858 DD_assets\pagina10_img2.png)

![Imagen 3 - Página 10](858 DD_assets\pagina10_img3.png)

![Imagen 4 - Página 10](858 DD_assets\pagina10_img4.png)

---

<!-- Página 11 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
6. GUÍA DE USO SEGURO DEL SISTEMA
Esta guía está dirigida a los usuarios de aquel sistema, subsistema o solución
contratada, que se implante en la infraestructura del cliente, al objeto de disponer de
todos los recursos necesarios para hacer un uso seguro de la misma.
6.1 Aproximación a la normativa de uso del sistema.
Si bien las normas de uso de medios electrónicos las establece la organización
cliente que contrata la solución, en este apartado el proveedor aportará sugerencias
sobre normas adecuadas a la realidad concreta de la solución, en base a su experiencia
y al conocimiento que posee de la solución que se implanta.
6.2 Configuraciones y procedimientos de seguridad que deban ser
realizadas por los usuarios
Se detallarán aquellas configuraciones y procedimientos de seguridad que deban
ser realizados por los usuarios finales para garantizar un uso seguro del sistema.
También se indicarán posibles configuraciones adicionales, con una explicación
clara del incremento o decremento de la seguridad en función de su ajuste,
configuración o parametrización.
6.3 Comunicación de incidencias y solicitud de soporte
Caso de que el soporte lo suministre directamente el proveedor de la solución, se
especificarán los mecanismos de notificación por parte de los usuarios del sistema:
teléfono, correo electrónico, formulario Web, etc., indicando el horario de atención y
la información identificativa que se le solicitará por parte del personal de soporte. Se
prestará especial atención a los incidentes de seguridad, que se priorizarán.
Si el soporte lo realiza un Centro de Atención al Usuario (CAU) del cliente, será
éste el encargado de realizar las notificaciones de incidencias o peticiones de soporte.
6.4 Manual de Usuario
El Manual de Usuario resaltará las implicaciones de seguridad en aquellas
acciones concretas que puedan realizar los usuarios, especialmente parametrizaciones
permitidas.
Se dispondrá de un apartado dedicado a consejos y buenas prácticas de
seguridad en el escenario de aplicación de la solución implantada.
7. GUÍA DE LA RELACIÓN ENTRE CLIENTE Y PROVEEDOR
Esta Guía contendrá recomendaciones para la gestión de la relación entre el
proveedor de la solución y el cliente contratante, especificando la carga de
responsabilidad para el cumplimiento de cada una de las medidas de seguridad que
determina el Anexo II del ENS, en función de la categoría del sistema.
11
Centro Cript ológico Nacional 11

![Imagen 1 - Página 11](858 DD_assets\pagina11_img1.png)

![Imagen 2 - Página 11](858 DD_assets\pagina11_img2.png)

![Imagen 3 - Página 11](858 DD_assets\pagina11_img3.png)

![Imagen 4 - Página 11](858 DD_assets\pagina11_img4.png)

---

<!-- Página 12 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
Se trata de evitar que quede sin aplicarse una medida de seguridad en el sistema,
subsistema o solución implantada ON-PREMISE responsabilidad exclusiva de una parte,
de la otra u ambas una vez instalada en modo local apoyándose en la infraestructura
del cliente.
7.1 Asignación de la responsabilidad de cada parte respecto al Anexo II
del ENS
Se determinará la asignación de responsabilidad de cada parte, proveedor y
cliente, respecto a las medidas seguridad del Anexo II del ENS que sean de aplicación,
según la categoría del sistema.
Para ello, se ha desarrollado una tabla en el Anexo I de esta Guía, que pueda
servir de ejemplo de partida, dado que la casuística puede ser variopinta y diversa.
En la referida tabla se tiene en cuenta para cada una de las medidas de seguridad
que determina el Anexo II del ENS:
 El código y descripción de la medida.
 La categoría del sistema para el que la medida es de aplicación.
 El porcentaje de responsabilidad en la aplicación de la medida entre el
proveedor que provisiona la solución y el cliente dónde se implanta.
 Las acciones necesarias a ser llevadas a cabo por el proveedor.
 Las acciones a ser llevadas a cabo por el cliente.
 En determinados casos, notas de implantación.
NOTA: Cuando se particularice la tabla para ser entregada en la guía de una solución
concreta, en la columna “notas de implantación” se detallarán, por ejemplo, paneles y
parámetros concretos de configuración relacionados con esa medida, documentación
adicional disponible al respecto, buenas prácticas de uso seguro, etc.
El reparto de responsabilidades cliente-proveedor será fijado, en primera
instancia, por el cliente, aunque podrá ser pactado por ambas partes, atendiendo a las
especiales circunstancias que concurran en cada caso concreto. En cualquier caso, el
reparto final acordado deberá estar determinado en la Guía de Relación entre Cliente y
Proveedor.
7.2 Análisis de riesgos de la solución implantada
Se incluirá el resultado del Análisis de Riesgos del sistema, subsistema o solución
implantada, considerando asimismo las posibles interacciones con otros sistemas del
cliente.
El Análisis de Riesgos deberá ser realizado, conjuntamente, por el cliente y por el
proveedor, asumiendo y responsabilizándose de sus resultados, en la parte que le
corresponda a cada uno de ellos. Dicho Análisis de Riesgos será asimismo evaluado por
la Entidad de Certificación, cuando el cliente se encuentre en un proceso de Auditoría
12
Centro Cript ológico Nacional 12

![Imagen 1 - Página 12](858 DD_assets\pagina12_img1.png)

![Imagen 2 - Página 12](858 DD_assets\pagina12_img2.png)

![Imagen 3 - Página 12](858 DD_assets\pagina12_img3.png)

![Imagen 4 - Página 12](858 DD_assets\pagina12_img4.png)

---

<!-- Página 13 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
de Certificación del ENS que involucre los sistemas de información sobre los que se
prestan los servicios contratados.
A modo de ilustración se ha desarrollado una tabla en el Anexo II de la presente
Guía, que puede servir de inspiración informal de algunas de las posibles amenazas
que podrían afectar a una hipotética solución implantada. Asimismo, se sugieren
acciones de mitigación, tanto a nivel de prevenciones durante el desarrollo por parte
del proveedor, como de acciones de mitigación en manos de la organización cliente
donde se implanta.
En la referida tabla se tienen en cuenta, para cada riesgo identificado:
 El riesgo y su descripción.
 Las posibles consecuencias en caso de materializarse (impacto).
 Posibles acciones de mitigación por parte del proveedor (desarrollador).
 Posibles acciones de mitigación por parte de la organización cliente.
Cuando se aporte el análisis de riesgos al cliente para que lo integre con su
propia gestión general de riesgos, deben de recogerse únicamente las acciones de
mitigación que, de forma efectiva, ha materializado el proveedor a nivel de diseño y
desarrollo, y no las que hubiera podido aplicar. De esta forma, la organización cliente
dispondrá de elementos de decisión para incorporar más o menos medidas propias
que compensen o complementen las del proveedor.
El proveedor, respecto de su propia solución, se hará responsable de la diligencia
y exactitud del Análisis de Riesgos realizado.
13
Centro Cript ológico Nacional 13

![Imagen 1 - Página 13](858 DD_assets\pagina13_img1.png)

![Imagen 2 - Página 13](858 DD_assets\pagina13_img2.png)

![Imagen 3 - Página 13](858 DD_assets\pagina13_img3.png)

![Imagen 4 - Página 13](858 DD_assets\pagina13_img4.png)

---

<!-- Página 14 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
ANEXO I (Ejemplo de asignación de responsabilidades entre proveedor y cliente)
Reparto de responsabilidades entre Proveedor y Cliente
(Coordinación de aplicabilidad de medidas de seguridad del ENS)
Responsabilidad
Medida de Acciones necesarias Acciones necesarias
Categoría Notas de implantación
Seguridad para el proveedor para el cliente
Proveedor Cliente
El proveedor dispone de una política de Existirá una política de seguridad aprobada por La Política de Seguridad del Proveedor es
seguridad accesible para el cliente, por ejemplo, el órgano superior. necesaria solo hasta que el sistema se
en la URL: https://www.proveedor.es/politica- implanta en la infraestructura del cliente. A
org.1
de-seguridad, o se le ha dado a conocer por otro partir de ese momento, la única Política de
Política de TODAS 50% 50%
medio. Seguridad es la del cliente (que habrá de
Seguridad
contemplar la presencia de sistemas on-
premise y redactar preceptos en
consecuencia).
En la Normativa Interna de uso de medios Se dispondrá de normativa documentada Los usuarios deben conocer las funciones de
electrónicos en la organización, se incluirán relacionada con el uso correcto y con el la solución implantada y, en su caso,
capítulos o epígrafes específicos destinados a inadecuado de los activos, junto a sus aceptarán las condiciones de uso de la
sistemas concretos. En este apartado, se incluirá responsabilidades, derechos, deberes y medidas misma.
la documentación necesaria para la implantación disciplinarias.
org.2
y el uso correcto de la solución para cumplir con
Normativa de TODAS 50% 50%
el ENS.
Seguridad
Los usuarios de la solución implantada disponen,
por ejemplo, de un manual de usuario, paneles
de ayuda, avisos desplegables, banners o
mensajes emergentes, con normas de uso
denotando sus responsabilidades.
Se encuentran documentadas las acciones Se adecuarán / complementarán los
org.3 necesarias para la instalación segura de la procedimientos de seguridad de todo el sistema
Procedimientos TODAS 50% 50% solución, los procedimientos de administración, de información para que contemplen la solución
de seguridad así como instrucciones y protocolos de uso implantada.
seguro de la solución por parte de sus usuarios.
Se encuentra documentado el proceso de Existirá un proceso de autorizaciones adecuado
autorizaciones, correspondiente tanto a a todo el sistema de información, que incluya la
org.4
administradores como a usuarios, ya sea en el solución implantada.
Procedimiento de TODAS 50% 50%
entorno de instalación (Guía de instalación),
autorización
como en el entorno de operación (Guía de uso
seguro / manual de usuario).
Centro Criptológico Nacional 14

|  | Reparto de responsabilidades entre Proveedor y Cliente |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | (Coordinación de aplicabilidad de medidas de seguridad del ENS) |  |  |  |  |  |  |  |  |  |
| Medida de <br> Seguridad |  | Categoría |  | Responsabilidad |  |  | Acciones necesarias <br> para el proveedor | Acciones necesarias <br> para el cliente | Notas de implantación |  |
|  |  |  | Proveedor |  | Cliente |  |  |  |  |  |
| org.1 <br> Política de <br> Seguridad |  | TODAS | 50% |  | 50% |  | El proveedor dispone de una política de <br> seguridad accesible para el cliente, por ejemplo, <br> en la URL: https://www.proveedor.es/politica- <br> de-seguridad, o se le ha dado a conocer por otro <br> medio. | Existirá una política de seguridad aprobada por <br> el órgano superior. | La Política de Seguridad del Proveedor es <br> necesaria solo hasta que el sistema se <br> implanta en la infraestructura del cliente. A <br> partir de ese momento, la única Política de <br> Seguridad es la del cliente (que habrá de <br> contemplar la presencia de sistemas on- <br> premise y redactar preceptos en <br> consecuencia). |  |
| org.2 <br> Normativa de <br> Seguridad |  | TODAS | 50% |  | 50% |  | En la Normativa Interna de uso de medios <br> electrónicos en la organización, se incluirán <br> capítulos o epígrafes específicos destinados a <br> sistemas concretos. En este apartado, se incluirá <br> la documentación necesaria para la implantación <br> y el uso correcto de la solución para cumplir con <br> el ENS. <br> Los usuarios de la solución implantada disponen, <br> por ejemplo, de un manual de usuario, paneles <br> de ayuda, avisos desplegables, banners o <br> mensajes emergentes, con normas de uso <br> denotando sus responsabilidades. | Se dispondrá de normativa documentada <br> relacionada con el uso correcto y con el <br> inadecuado de los activos, junto a sus <br> responsabilidades, derechos, deberes y medidas <br> disciplinarias. | Los usuarios deben conocer las funciones de <br> la solución implantada y, en su caso, <br> aceptarán las condiciones de uso de la <br> misma. |  |
| org.3 <br> Procedimientos <br> de seguridad |  | TODAS | 50% |  | 50% |  | Se encuentran documentadas las acciones <br> necesarias para la instalación segura de la <br> solución, los procedimientos de administración, <br> así como instrucciones y protocolos de uso <br> seguro de la solución por parte de sus usuarios. | Se adecuarán / complementarán los <br> procedimientos de seguridad de todo el sistema <br> de información para que contemplen la solución <br> implantada. |  |  |
| org.4 <br> Procedimiento de <br> autorización |  | TODAS | 50% |  | 50% |  | Se encuentra documentado el proceso de <br> autorizaciones, correspondiente tanto a <br> administradores como a usuarios, ya sea en el <br> entorno de instalación (Guía de instalación), <br> como en el entorno de operación (Guía de uso <br> seguro / manual de usuario). | Existirá un proceso de autorizaciones adecuado <br> a todo el sistema de información, que incluya la <br> solución implantada. |  |  |


| Medida de |
| --- |
| Seguridad |


| Acciones necesarias |
| --- |
| para el proveedor |


| Acciones necesarias |
| --- |
| para el cliente |


![Imagen 1 - Página 14](858 DD_assets\pagina14_img1.png)

![Imagen 2 - Página 14](858 DD_assets\pagina14_img2.png)

![Imagen 3 - Página 14](858 DD_assets\pagina14_img3.png)

![Imagen 4 - Página 14](858 DD_assets\pagina14_img4.png)

![Imagen 5 - Página 14](858 DD_assets\pagina14_img5.png)

---

<!-- Página 15 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
El proveedor dispone de una gestión propia de La organización cliente incluirá la solución Ambas partes (proveedor y cliente) deberán
riesgos en la que ha considerado los procesos de implantada como activo o activos. tener un análisis de riesgos actualizado.
desarrollo, implantación, mantenimiento y La organización cliente dispondrá de un Análisis
soporte de la solución (en el caso de que se haya de Riesgos en el que incluirá los riesgos de
subcontratado). gestionar soluciones ON-PREMISE y en su caso,
op.pl.1 En la Guía de instalación segura que se facilita al cuando no se disponga de soporte del
B M A Sí Sí
Análisis de riesgos cliente, el proveedor incluye un análisis de proveedor, deberán establecerse medidas en el
riesgos respecto a la solución que provee. plan de tratamiento de riesgos (PTR).
Se incorporarán los riesgos identificados por el
proveedor en la Guía de instalación de la
solución en la gestión de riesgos global de la
organización cliente.
Se dispone de un mapa esquemático o diagrama La organización cliente dispondrá de
con la arquitectura de la solución que se facilita documentación de las instalaciones, del sistema,
en la Guía de instalación de la solución. Se de accesos al sistema, de la(s) red(es), de las
contempla tanto a nivel de bloques de líneas de defensa… de modo que se facilite la
estructuración de los módulos software de la integración de la solución contratada.
solución, como a nivel de arquitectura
recomendada para implementar la misma
(Balanceadores, servidores web, servidores de
op.pl.2
BBDD, etc.) e integrarla en la red del cliente.
Arquitectura de
B M A 50% 50% Se incluyen diagramas con indicación de las
seguridad
conexiones e interconexiones (flujos de datos)
hacia otros sistemas y hacia el exterior, con
indicación de cómo se han protegido, o pueden
protegerse, incluyendo los protocolos de acceso
empleados.
Se documentarán en la Guía de instalación las
recomendaciones de configuración y
parametrización para mantener un nivel
adecuado de seguridad.
Cuando se incorporen o sustituyan elementos La organización cliente dispondrá de un proceso
op.pl.3 que afecten al desarrollo de software, como para planificar las adquisiciones de soluciones
Adquisición de módulos o librerías, el proveedor de la solución que considere los riesgos, los elementos
TODAS 50% 50%
nuevos verifica que no rompe la seguridad. Si es existentes en la arquitectura actual del sistema y
componentes necesario establece acciones de formación y las necesidades que pueden surgir de su
sensibilización. integración.
Se le entregan a la organización cliente de la La organización cliente dispondrá de un estudio La información de la solución se almacena en
op.pl.4 solución ON-PREMISE, en la Guía de instalación, con la evolución histórica de la capacidad del Base de Datos, siendo responsabilidad del
Dimensionamient tablas para poder dimensionar los recursos que sistema, o Plan de Capacidad, que permita cliente que contrata definir los umbrales de
B M A 50% 50%
o / Gestión de la la soportarán, en función del nº de usuarios, nº dimensionar los componentes en los que se almacenamiento en su sistema y programar
Capacidad de trámites y de otros parámetros que se apoyará la solución con ayuda de las tablas las alertas adecuadas cuando se alcancen
estimen relevantes. Se dimensiona en base a proporcionadas por el fabricante en la Guía de dichos umbrales.
Centro Criptológico Nacional 15

| op.pl.1 <br> Análisis de riesgos | B | M | A | Sí | Sí | El proveedor dispone de una gestión propia de <br> riesgos en la que ha considerado los procesos de <br> desarrollo, implantación, mantenimiento y <br> soporte de la solución (en el caso de que se haya <br> subcontratado). <br> En la Guía de instalación segura que se facilita al <br> cliente, el proveedor incluye un análisis de <br> riesgos respecto a la solución que provee. | La organización cliente incluirá la solución <br> implantada como activo o activos. <br> La organización cliente dispondrá de un Análisis <br> de Riesgos en el que incluirá los riesgos de <br> gestionar soluciones ON-PREMISE y en su caso, <br> cuando no se disponga de soporte del <br> proveedor, deberán establecerse medidas en el <br> plan de tratamiento de riesgos (PTR). <br> Se incorporarán los riesgos identificados por el <br> proveedor en la Guía de instalación de la <br> solución en la gestión de riesgos global de la <br> organización cliente. | Ambas partes (proveedor y cliente) deberán <br> tener un análisis de riesgos actualizado. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| op.pl.2 <br> Arquitectura de <br> seguridad | B | M | A | 50% | 50% | Se dispone de un mapa esquemático o diagrama <br> con la arquitectura de la solución que se facilita <br> en la Guía de instalación de la solución. Se <br> contempla tanto a nivel de bloques de <br> estructuración de los módulos software de la <br> solución, como a nivel de arquitectura <br> recomendada para implementar la misma <br> (Balanceadores, servidores web, servidores de <br> BBDD, etc.) e integrarla en la red del cliente. <br> Se incluyen diagramas con indicación de las <br> conexiones e interconexiones (flujos de datos) <br> hacia otros sistemas y hacia el exterior, con <br> indicación de cómo se han protegido, o pueden <br> protegerse, incluyendo los protocolos de acceso <br> empleados. <br> Se documentarán en la Guía de instalación las <br> recomendaciones de configuración y <br> parametrización para mantener un nivel <br> adecuado de seguridad. | La organización cliente dispondrá de <br> documentación de las instalaciones, del sistema, <br> de accesos al sistema, de la(s) red(es), de las <br> líneas de defensa… de modo que se facilite la <br> integración de la solución contratada. |  |
| op.pl.3 <br> Adquisición de <br> nuevos <br> componentes | TODAS |  |  | 50% | 50% | Cuando se incorporen o sustituyan elementos <br> que afecten al desarrollo de software, como <br> módulos o librerías, el proveedor de la solución <br> verifica que no rompe la seguridad. Si es <br> necesario establece acciones de formación y <br> sensibilización. | La organización cliente dispondrá de un proceso <br> para planificar las adquisiciones de soluciones <br> que considere los riesgos, los elementos <br> existentes en la arquitectura actual del sistema y <br> las necesidades que pueden surgir de su <br> integración. |  |
| op.pl.4 <br> Dimensionamient <br> o / Gestión de la <br> Capacidad | B | M | A | 50% | 50% | Se le entregan a la organización cliente de la <br> solución ON-PREMISE, en la Guía de instalación, <br> tablas para poder dimensionar los recursos que <br> la soportarán, en función del nº de usuarios, nº <br> de trámites y de otros parámetros que se <br> estimen relevantes. Se dimensiona en base a | La organización cliente dispondrá de un estudio <br> con la evolución histórica de la capacidad del <br> sistema, o Plan de Capacidad, que permita <br> dimensionar los componentes en los que se <br> apoyará la solución con ayuda de las tablas <br> proporcionadas por el fabricante en la Guía de | La información de la solución se almacena en <br> Base de Datos, siendo responsabilidad del <br> cliente que contrata definir los umbrales de <br> almacenamiento en su sistema y programar <br> las alertas adecuadas cuando se alcancen <br> dichos umbrales. |


![Imagen 1 - Página 15](858 DD_assets\pagina15_img1.png)

![Imagen 2 - Página 15](858 DD_assets\pagina15_img2.png)

![Imagen 3 - Página 15](858 DD_assets\pagina15_img3.png)

![Imagen 4 - Página 15](858 DD_assets\pagina15_img4.png)

![Imagen 5 - Página 15](858 DD_assets\pagina15_img5.png)

---

<!-- Página 16 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
recursos de procesador, memoria, capacidad en instalación.
disco, recursos humanos, etc.
Asimismo, la solución contempla parametrizar y
elaborar estadísticas, permitiendo la
monitorización del almacenamiento y gestionar
la retención de la información.
Para categoría alta, los componentes La organización cliente procurará que los
op.pl.5
adicionales, proporcionados conjuntamente con componentes de la infraestructura TIC que
Componentes B M A 100% 0%
la solución implantada, están certificados. interactúen con la solución implantada estén
certificados
certificados.
La solución cubre las necesidades del cliente Se procedimentará a nivel interno la gestión de La solución implantada dispone de
facilitándole la gestión de los usuarios: los usuarios registrados en sus sistemas. mecanismos de consulta para listar los
Identificación, estado, responsable o área a la El cliente deberá gestionar mediante usuarios dados de alta en la aplicación.
op.acc.1 que pertenece, roles asignados, permisos en procedimientos las altas, modificaciones y bajas Los usuarios de la solución implantada
TODAS 70% 30%
Identificación base a dichos roles, etc. de usuarios, así como las autorizaciones y pueden ser dados de baja o deshabilitados en
notificaciones de dichos cambios. cualquier momento y pueden tener definida
una fecha de caducidad previamente
establecida.
La solución no permite que un usuario sin La organización cliente gestionara los derechos
op.acc.2
estar dado de alta, o sin los oportunos permisos, de acceso de todo el sistema, incluidos los
Requisitos de TODAS 50% 50%
pueda acceder a recursos no habilitados. derechos de acceso que puedan corresponder a
acceso
los usuarios a la solución implantada.
La solución implantada permite la segregación Existirá un proceso interno documentado, En la solución implantada se pueden definir
de funciones y tareas mediante la asignación de relacionado con la segregación de funciones y los distintos usuarios y grupos de usuarios.
permisos a usuarios específicos y a grupos de tareas en el sistema de información de la Se gestiona la asignación de permisos
usuarios. organización cliente. mediante opciones de menú, asociación de
La solución implantada permite la gestión roles a los usuarios o grupos, etc., lo que
diferenciada de las tareas críticas por dos o más permite establecer a qué funcionalidades
op.acc.3
usuarios mediante flujos, restringiendo los accede cada usuario.
Segregación de B M A 70% 30%
accesos individuales. Se pueden lanzar La solución dispone de opciones de consulta
funciones y tareas
notificaciones o alertas a un usuario y listado de usuarios y grupos, junto a las
Administrador. funcionalidades permitidas.
La solución considera la separación de funciones
de operación, configuración, mantenimiento y
auditoria; no permite accesos a entornos o
capas no asociadas a un perfil de acceso.
La aplicación permite la asignación y el bloqueo La organización cliente dispondrá de un proceso
Op.acc.4 o cancelación ágiles de accesos de usuario. interno relacionado con las altas, modificaciones
Proceso de y bajas de los usuarios, asociado con los
gestión de TODAS 30% 70% principios de mínima funcionalidad, necesidad
derechos de de conocer y capacidad de autorizar (según la
acceso medida de seguridad org.4).
Centro Criptológico Nacional 16

|  |  |  |  |  |  | recursos de procesador, memoria, capacidad en <br> disco, recursos humanos, etc. <br> Asimismo, la solución contempla parametrizar y <br> elaborar estadísticas, permitiendo la <br> monitorización del almacenamiento y gestionar <br> la retención de la información. | instalación. |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| op.pl.5 <br> Componentes <br> certificados | B | M | A | 100% | 0% | Para categoría alta, los componentes <br> adicionales, proporcionados conjuntamente con <br> la solución implantada, están certificados. | La organización cliente procurará que los <br> componentes de la infraestructura TIC que <br> interactúen con la solución implantada estén <br> certificados. |  |
| op.acc.1 <br> Identificación | TODAS |  |  | 70% | 30% | La solución cubre las necesidades del cliente <br> facilitándole la gestión de los usuarios: <br> Identificación, estado, responsable o área a la <br> que pertenece, roles asignados, permisos en <br> base a dichos roles, etc. | Se procedimentará a nivel interno la gestión de <br> los usuarios registrados en sus sistemas. <br> El cliente deberá gestionar mediante <br> procedimientos las altas, modificaciones y bajas <br> de usuarios, así como las autorizaciones y <br> notificaciones de dichos cambios. | La solución implantada dispone de <br> mecanismos de consulta para listar los <br> usuarios dados de alta en la aplicación. <br> Los usuarios de la solución implantada <br> pueden ser dados de baja o deshabilitados en <br> cualquier momento y pueden tener definida <br> una fecha de caducidad previamente <br> establecida. |
| op.acc.2 <br> Requisitos de <br> acceso | TODAS |  |  | 50% | 50% | La solución no permite que un usuario sin <br> estar dado de alta, o sin los oportunos permisos, <br> pueda acceder a recursos no habilitados. | La organización cliente gestionara los derechos <br> de acceso de todo el sistema, incluidos los <br> derechos de acceso que puedan corresponder a <br> los usuarios a la solución implantada. |  |
| op.acc.3 <br> Segregación de <br> funciones y tareas | B | M | A | 70% | 30% | La solución implantada permite la segregación <br> de funciones y tareas mediante la asignación de <br> permisos a usuarios específicos y a grupos de <br> usuarios. <br> La solución implantada permite la gestión <br> diferenciada de las tareas críticas por dos o más <br> usuarios mediante flujos, restringiendo los <br> accesos individuales. Se pueden lanzar <br> notificaciones o alertas a un usuario <br> Administrador. <br> La solución considera la separación de funciones <br> de operación, configuración, mantenimiento y <br> auditoria; no permite accesos a entornos o <br> capas no asociadas a un perfil de acceso. | Existirá un proceso interno documentado, <br> relacionado con la segregación de funciones y <br> tareas en el sistema de información de la <br> organización cliente. | En la solución implantada se pueden definir <br> los distintos usuarios y grupos de usuarios. <br> Se gestiona la asignación de permisos <br> mediante opciones de menú, asociación de <br> roles a los usuarios o grupos, etc., lo que <br> permite establecer a qué funcionalidades <br> accede cada usuario. <br> La solución dispone de opciones de consulta <br> y listado de usuarios y grupos, junto a las <br> funcionalidades permitidas. |
| Op.acc.4 <br> Proceso de <br> gestión de <br> derechos de <br> acceso | TODAS |  |  | 30% | 70% | La aplicación permite la asignación y el bloqueo <br> o cancelación ágiles de accesos de usuario. | La organización cliente dispondrá de un proceso <br> interno relacionado con las altas, modificaciones <br> y bajas de los usuarios, asociado con los <br> principios de mínima funcionalidad, necesidad <br> de conocer y capacidad de autorizar (según la <br> medida de seguridad org.4). |  |


![Imagen 1 - Página 16](858 DD_assets\pagina16_img1.png)

![Imagen 2 - Página 16](858 DD_assets\pagina16_img2.png)

![Imagen 3 - Página 16](858 DD_assets\pagina16_img3.png)

![Imagen 4 - Página 16](858 DD_assets\pagina16_img4.png)

![Imagen 5 - Página 16](858 DD_assets\pagina16_img5.png)

---

<!-- Página 17 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
Para que las contraseñas sean únicamente La organización cliente debe definir su política Se puede asociar el proceso de altas al
conocidas por el propio usuario, éstas se de comunicación de claves. Los usuarios deben directorio activo del sistema.
guardan cifradas en la solución implantada; Para confirmar la recepción de las credenciales y ser Si el sistema es de categoría media o superior
las altas de usuarios gestionadas por personal de notificados de las condiciones de uso del y la solución implantada únicamente permite
servicio, como el Centro de Atención al Usuario servicio. un factor de autenticación, o admite varios,
(CAU) de la organización cliente, se han previsto Deben existir, asimismo, controles en el sistema pero de forma no simultánea, deberá
contraseñas de un solo uso que se generan de para la autenticación, considerando diferentes apoyarse en un segundo factor existente en
forma aleatoria y se remiten directamente al niveles y factores de composición y vigencia. la red del cliente, o en una solución externa,
propio usuario (móvil o correo) sin ser estas La organización cliente debe establecer una de forma que ambos factores se
conocidas por la persona del CAU que realiza la política de contraseñas que incluya su robustez y complementen entre sí.
gestión, obligándose asimismo a su reemplazo su fecha de caducidad, dado que las contraseñas La aplicación dispone de funcionalidades que
en el primer acceso a la solución. deben ser cambiadas periódicamente. permiten a la organización cliente
La solución permite establecer la robustez de las Se dispondrá de un proceso periódico de parametrizar la calidad y complejidad de las
contraseñas según diferentes requisitos de revisión de cuentas de usuario, en especial las contraseñas en base a la política que tenga
op.acc.5 seguridad, claramente especificados (acorde a la que disponen de derechos de administración. definida, cubriendo:
Mecanismos de B M A 60% 40% política de contraseñas de la organización Se incluirán otros factores de autenticación,  Permite seleccionar el número mínimo
autentificación cliente). cuando sea necesario según la categorización del de caracteres.
Según la categoría del sistema donde se integre sistema, para compensar y complementar los  Tipología de los caracteres
la solución, se incluyen mecanismos para ofrecidos por la solución aportada por el (alfanuméricos, mayúsculas /
implementar un doble factor de autenticación, o proveedor. minúsculas, caracteres especiales).
bien se apoya con otro factor proporcionado por  Mantiene un histórico de contraseñas
la red de la organización cliente. no permitiendo repetir las últimas
Para integrarse en sistemas de categoría alta, la empleadas.
solución admite que las credenciales se  Permite especificar la periodicidad para
suspenderán tras un periodo definido de no la caducidad de la clave.
utilización.  Permite especificar caducidad de la
contraseña por falta de uso en tras
período determinado, directamente o
apoyándose en LDAP.
 Permite seleccionar el número de
intentos fallidos antes de su bloqueo.
La aplicación no revela información del usuario Para sistemas de categoría alta, se estudiará en Para facilitar el soporte técnico, el sistema
ante intentos de acceso (no conserva el nombre el FW o en el WAF la posibilidad de limitar el muestra por pantalla errores para la
de usuario y menos la clave). acceso desde lugares distintos de los que deba resolución de incidencias, siempre
Se limita el número de intentos permitidos de accederse (por ejemplo, determinados países), codificados, no mostrándose en ningún
autenticación insatisfactoria. siempre que sea adecuado y posible, cuando momento mensajes informativos detallados
op.acc.6 La solución registra tanto los intentos de como suele ocurrir, no lo prevea la solución del error, o de su solución, ni del sistema
B M A 80% 20%
Acceso local autenticación con éxito como los fallidos. implantada. operativo o la base de datos sobre la que
Así mismo, la solución informa a los usuarios de está integrado, que puedan ser aprovechados
sus obligaciones una vez obtenido el acceso. por un atacante para detectar algunas
Para cumplir con requisitos de categoría media, vulnerabilidades.
la solución informa al usuario del último acceso Dichos errores deben facilitarse al Centro de
efectuado con su identidad. atención del Usuario (CAU) de la organización
Centro Criptológico Nacional 17

| op.acc.5 <br> Mecanismos de <br> autentificación | B | M | A | 60% | 40% | Para que las contraseñas sean únicamente <br> conocidas por el propio usuario, éstas se <br> guardan cifradas en la solución implantada; Para <br> las altas de usuarios gestionadas por personal de <br> servicio, como el Centro de Atención al Usuario <br> (CAU) de la organización cliente, se han previsto <br> contraseñas de un solo uso que se generan de <br> forma aleatoria y se remiten directamente al <br> propio usuario (móvil o correo) sin ser estas <br> conocidas por la persona del CAU que realiza la <br> gestión, obligándose asimismo a su reemplazo <br> en el primer acceso a la solución. <br> La solución permite establecer la robustez de las <br> contraseñas según diferentes requisitos de <br> seguridad, claramente especificados (acorde a la <br> política de contraseñas de la organización <br> cliente). <br> Según la categoría del sistema donde se integre <br> la solución, se incluyen mecanismos para <br> implementar un doble factor de autenticación, o <br> bien se apoya con otro factor proporcionado por <br> la red de la organización cliente. <br> Para integrarse en sistemas de categoría alta, la <br> solución admite que las credenciales se <br> suspenderán tras un periodo definido de no <br> utilización. | La organización cliente debe definir su política <br> de comunicación de claves. Los usuarios deben <br> confirmar la recepción de las credenciales y ser <br> notificados de las condiciones de uso del <br> servicio. <br> Deben existir, asimismo, controles en el sistema <br> para la autenticación, considerando diferentes <br> niveles y factores de composición y vigencia. <br> La organización cliente debe establecer una <br> política de contraseñas que incluya su robustez y <br> su fecha de caducidad, dado que las contraseñas <br> deben ser cambiadas periódicamente. <br> Se dispondrá de un proceso periódico de <br> revisión de cuentas de usuario, en especial las <br> que disponen de derechos de administración. <br> Se incluirán otros factores de autenticación, <br> cuando sea necesario según la categorización del <br> sistema, para compensar y complementar los <br> ofrecidos por la solución aportada por el <br> proveedor. | Se puede asociar el proceso de altas al <br> directorio activo del sistema. <br> Si el sistema es de categoría media o superior <br> y la solución implantada únicamente permite <br> un factor de autenticación, o admite varios, <br> pero de forma no simultánea, deberá <br> apoyarse en un segundo factor existente en <br> la red del cliente, o en una solución externa, <br> de forma que ambos factores se <br> complementen entre sí. <br> La aplicación dispone de funcionalidades que <br> permiten a la organización cliente <br> parametrizar la calidad y complejidad de las <br> contraseñas en base a la política que tenga <br> definida, cubriendo: <br>  Permite seleccionar el número mínimo <br> de caracteres. <br>  Tipología de los caracteres <br> (alfanuméricos, mayúsculas / <br> minúsculas, caracteres especiales). <br>  Mantiene un histórico de contraseñas <br> no permitiendo repetir las últimas <br> empleadas. <br>  Permite especificar la periodicidad para <br> la caducidad de la clave. <br>  Permite especificar caducidad de la <br> contraseña por falta de uso en tras <br> período determinado, directamente o <br> apoyándose en LDAP. <br>  Permite seleccionar el número de <br> intentos fallidos antes de su bloqueo. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| op.acc.6 <br> Acceso local | B | M | A | 80% | 20% | La aplicación no revela información del usuario <br> ante intentos de acceso (no conserva el nombre <br> de usuario y menos la clave). <br> Se limita el número de intentos permitidos de <br> autenticación insatisfactoria. <br> La solución registra tanto los intentos de <br> autenticación con éxito como los fallidos. <br> Así mismo, la solución informa a los usuarios de <br> sus obligaciones una vez obtenido el acceso. <br> Para cumplir con requisitos de categoría media, <br> la solución informa al usuario del último acceso <br> efectuado con su identidad. | Para sistemas de categoría alta, se estudiará en <br> el FW o en el WAF la posibilidad de limitar el <br> acceso desde lugares distintos de los que deba <br> accederse (por ejemplo, determinados países), <br> siempre que sea adecuado y posible, cuando <br> como suele ocurrir, no lo prevea la solución <br> implantada. | Para facilitar el soporte técnico, el sistema <br> muestra por pantalla errores para la <br> resolución de incidencias, siempre <br> codificados, no mostrándose en ningún <br> momento mensajes informativos detallados <br> del error, o de su solución, ni del sistema <br> operativo o la base de datos sobre la que <br> está integrado, que puedan ser aprovechados <br> por un atacante para detectar algunas <br> vulnerabilidades. <br> Dichos errores deben facilitarse al Centro de <br> atención del Usuario (CAU) de la organización |


![Imagen 1 - Página 17](858 DD_assets\pagina17_img1.png)

![Imagen 2 - Página 17](858 DD_assets\pagina17_img2.png)

![Imagen 3 - Página 17](858 DD_assets\pagina17_img3.png)

![Imagen 4 - Página 17](858 DD_assets\pagina17_img4.png)

![Imagen 5 - Página 17](858 DD_assets\pagina17_img5.png)

---

<!-- Página 18 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
Para cumplir con requisitos de categoría alta, el cliente, quizá en la Guía de instalación (para
acceso se puede limitar por horario y fechas. administradores), para que puedan así
determinar y resolver las incidencias
reportadas.
La solución se ha elaborado en base a El acceso a la solución en remoto será mediante Se gestionarán y protegerán los certificados
metodologías de desarrollo seguro que impiden mecanismos de autenticación seguros como de servidores necesarios para establecer
los ataques corrientes, del tipo inyección de IPSec o a través de VPN. accesos remotos seguros.
código, alteración de URL, etc. Se realizará un test de intrusión antes de poner
Se relacionarán claramente los puertos que la solución en producción, accesible desde
op.acc.7 deban permanecer abiertos, junto a su Internet.
B M A 60% 40%
Acceso remoto justificación, en la Guía de instalación. Se verificarán los puertos abiertos necesarios
para que funcione la solución y su influencia en
otras soluciones que coexistan en el sistema.
Se analizarán las implicaciones de las reglas
necesarias en el FW en relación a las ya
existentes y la seguridad global.
El proveedor facilita toda la información La organización cliente mantendrá un inventario La organización cliente acordará con el
relacionada con la solución implantada y, en su actualizado de todos los elementos del sistema, proveedor el formato en que éste le
caso, el hardware específico que pudiera ser detallando su naturaleza e identificando a su entregará el inventario correspondiente a la
aportado para la instalación, con miras a facilitar responsable. solución, para facilitar su integración con el
op.exp.1
su inventariado por parte de la organización inventario corporativo.
Inventario de TODAS 50% 50%
cliente.
activos
Se incluye información sobe las librerías,
módulos o complementos individuales
empleados, que deban conocerse por parte de la
organización cliente.
La solución permite cumplir los requerimientos Se retirarán las cuentas y contraseñas estándar y En determinados casos, el proveedor aporta
de configuración segura: Asignación de las por defecto de la solución. Se recomienda una checklist de evaluación de la
funcionalidades según necesidad, control de las eliminar las mismas en servidores y otros configuración segura de la solución.
funciones críticas y deshabilitación de las dispositivos conectados con la misma.
funciones no requeridas. Se atenderá a las consideraciones de bastionado
op.exp.2
Las acciones de los usuarios serán seguras salvo presentes en la Guía de instalación
Configuración de
TODAS 60% 40% que el usuario actúe conscientemente. La proporcionada por el proveedor de la solución.
seguridad
solución dispone de la posibilidad de definir En los casos en los que no sea posible cumplir
(bastionado)
diferentes perfiles y niveles de seguridad. con recomendaciones de configuración de
En la Guía de instalación el proveedor de la seguridad del proveedor, se elaborará un
solución incluirá un apartado con las acciones de documento explicando el motivo por el que no
base de bastionado y aquellas que deban se han podido implementar.
efectuarse con la colaboración del cliente.
El proveedor de la solución dispone de un La organización cliente dispondrá de un
op.exp.3
procedimiento para garantizar la actualización procedimiento para gestionar la configuración,
Gestión de la B M A 50% 50%
de diagramas de estructura, inventario, en base a actualizaciones de diagramas,
configuración
documentación y guías de la solución, siempre documentación, guías, etc., a partir de las
Centro Criptológico Nacional 18

|  |  |  |  |  |  | Para cumplir con requisitos de categoría alta, el <br> acceso se puede limitar por horario y fechas. |  | cliente, quizá en la Guía de instalación (para <br> administradores), para que puedan así <br> determinar y resolver las incidencias <br> reportadas. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| op.acc.7 <br> Acceso remoto | B | M | A | 60% | 40% | La solución se ha elaborado en base a <br> metodologías de desarrollo seguro que impiden <br> los ataques corrientes, del tipo inyección de <br> código, alteración de URL, etc. <br> Se relacionarán claramente los puertos que <br> deban permanecer abiertos, junto a su <br> justificación, en la Guía de instalación. | El acceso a la solución en remoto será mediante <br> mecanismos de autenticación seguros como <br> IPSec o a través de VPN. <br> Se realizará un test de intrusión antes de poner <br> la solución en producción, accesible desde <br> Internet. <br> Se verificarán los puertos abiertos necesarios <br> para que funcione la solución y su influencia en <br> otras soluciones que coexistan en el sistema. <br> Se analizarán las implicaciones de las reglas <br> necesarias en el FW en relación a las ya <br> existentes y la seguridad global. | Se gestionarán y protegerán los certificados <br> de servidores necesarios para establecer <br> accesos remotos seguros. |
| op.exp.1 <br> Inventario de <br> activos | TODAS |  |  | 50% | 50% | El proveedor facilita toda la información <br> relacionada con la solución implantada y, en su <br> caso, el hardware específico que pudiera ser <br> aportado para la instalación, con miras a facilitar <br> su inventariado por parte de la organización <br> cliente. <br> Se incluye información sobe las librerías, <br> módulos o complementos individuales <br> empleados, que deban conocerse por parte de la <br> organización cliente. | La organización cliente mantendrá un inventario <br> actualizado de todos los elementos del sistema, <br> detallando su naturaleza e identificando a su <br> responsable. | La organización cliente acordará con el <br> proveedor el formato en que éste le <br> entregará el inventario correspondiente a la <br> solución, para facilitar su integración con el <br> inventario corporativo. |
| op.exp.2 <br> Configuración de <br> seguridad <br> (bastionado) | TODAS |  |  | 60% | 40% | La solución permite cumplir los requerimientos <br> de configuración segura: Asignación de las <br> funcionalidades según necesidad, control de las <br> funciones críticas y deshabilitación de las <br> funciones no requeridas. <br> Las acciones de los usuarios serán seguras salvo <br> que el usuario actúe conscientemente. La <br> solución dispone de la posibilidad de definir <br> diferentes perfiles y niveles de seguridad. <br> En la Guía de instalación el proveedor de la <br> solución incluirá un apartado con las acciones de <br> base de bastionado y aquellas que deban <br> efectuarse con la colaboración del cliente. | Se retirarán las cuentas y contraseñas estándar y <br> por defecto de la solución. Se recomienda <br> eliminar las mismas en servidores y otros <br> dispositivos conectados con la misma. <br> Se atenderá a las consideraciones de bastionado <br> presentes en la Guía de instalación <br> proporcionada por el proveedor de la solución. <br> En los casos en los que no sea posible cumplir <br> con recomendaciones de configuración de <br> seguridad del proveedor, se elaborará un <br> documento explicando el motivo por el que no <br> se han podido implementar. | En determinados casos, el proveedor aporta <br> una checklist de evaluación de la <br> configuración segura de la solución. |
| op.exp.3 <br> Gestión de la <br> configuración | B | M | A | 50% | 50% | El proveedor de la solución dispone de un <br> procedimiento para garantizar la actualización <br> de diagramas de estructura, inventario, <br> documentación y guías de la solución, siempre | La organización cliente dispondrá de un <br> procedimiento para gestionar la configuración, <br> en base a actualizaciones de diagramas, <br> documentación, guías, etc., a partir de las |  |


![Imagen 1 - Página 18](858 DD_assets\pagina18_img1.png)

![Imagen 2 - Página 18](858 DD_assets\pagina18_img2.png)

![Imagen 3 - Página 18](858 DD_assets\pagina18_img3.png)

![Imagen 4 - Página 18](858 DD_assets\pagina18_img4.png)

![Imagen 5 - Página 18](858 DD_assets\pagina18_img5.png)

---

<!-- Página 19 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
que proceda, tras la implementación de un diferentes soluciones aportadas externamente y
cambio. los cambios que se vayan introduciendo en ellas.
El proveedor de la solución proporcionará La organización cliente dispondrá de un Se acordará entre proveedor de la solución y
periódicamente, y siempre que se requiera procedimiento para analizar, priorizar y organización cliente un canal para reportar
debido a su urgencia, avisos de vulnerabilidades, determinar cuándo aplicar las actualizaciones de incidencias respecto a parches y
nuevos parches, versiones, cambios en la seguridad, parches, mejoras y nuevas versiones actualizaciones instaladas, y para solicitarlos
op.exp.4 configuración, etc. del fabricante de la solución y de otros caso de no haberlos recibido.
TODAS 80% 20%
(Mantenimiento) Antes de publicar un parche, el proveedor ha fabricantes que soportan elementos del sistema.
realizado la batería de pruebas que se han La organización cliente gestionará las garantías y
considerado necesarias y lo ha notificado, y en contratos de mantenimiento.
su caso formado, a todo su personal de soporte La organización cliente gestionará las licencias.
a clientes.
El proveedor de la solución proporcionará toda Se dispondrá de un procedimiento de Gestión de La organización cliente dispondrá de una
la información necesaria a la organización cambios que incluya registro, evaluación, herramienta para registrar las peticiones de
cliente, para que ésta pueda analizar un cambio aprobación, etc. Interviniendo el Responsable de cambio y que sirva de soporte para poder
op.exp.5 anunciado respecto a la solución implantada, Seguridad en aquellas peticiones de cambio que evaluarlas antes de su aprobación,
Gestión de B M A 80% 20% conociendo y evaluando los riesgos que implica puedan implicar riesgo para la seguridad del manteniendo la trazabilidad de las mismas
cambios antes de aprobarlo. sistema. hasta su aprobación e implementación o su
La Gestión de Cambios de la organización cliente desestimación.
incluirá las peticiones de cambio con origen en
los proveedores.
El proveedor garantiza que la solución podrá La organización cliente dispondrá de Cuando por cualquier circunstancia algún
funcionar adecuadamente en el entorno del mecanismos de protección frente a código módulo de la solución implantada sea
cliente junto con los principales softwares de dañino y seguirá las indicaciones de los detectado como virus, deberá gestionar la
op.exp.6 control de código dañino existentes en el fabricantes del mismo, cómo de los configuración del antivirus para declararlo
Protección frente TODAS 20% 80% mercado. desarrolladores de otras aplicaciones en el como falso positivo, tras haberlo confirmado
a código dañino En determinadas ocasiones, se proporciona en la sistema. con el proveedor de la solución.
Guía de instalación una lista actualizada de los Ante interferencias entre la solución implantada
principales antivirus comerciales con los que ha y el antivirus corporativo, puede solicitar ayuda
sido probada la solución implantada. al departamento de soporte del proveedor.
El proveedor de la solución dispondrá de un En la organización cliente se dispondrá de un Se acordará entre el proveedor de la solución
procedimiento de gestión de incidentes procedimiento de gestión de incidentes que, en y la organización cliente un canal para
conforme al ENS y las organizaciones cliente su caso, reaccione y aísle los servicios reportar incidentes de seguridad, como
podrán hacer uso de un canal establecido al proporcionados por la solución en caso de consecuencia del escalado de los mismos
efecto para comunicar comportamientos necesidad, escalando el problema al proveedor desde el CAU del cliente.
op.exp.7
anómalos o incidentes respecto a la solución de la solución.
Gestión de B M A 80% 20%
implantada. Se concienciará a los usuarios de la organización
incidentes
El personal de soporte del proveedor asignará cliente para que comuniquen al Centro de
una categorización y escalado según la criticidad Atención a los Usuarios (CAU) todas las
que perciba el cliente. incidencias sin dilación y siguiendo el
Los registros de auditoría de la solución procedimiento establecido.
implantada permiten trazar la incidencia, bien
Centro Criptológico Nacional 19

|  |  |  |  |  |  | que proceda, tras la implementación de un <br> cambio. | diferentes soluciones aportadas externamente y <br> los cambios que se vayan introduciendo en ellas. |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| op.exp.4 <br> (Mantenimiento) | TODAS |  |  | 80% | 20% | El proveedor de la solución proporcionará <br> periódicamente, y siempre que se requiera <br> debido a su urgencia, avisos de vulnerabilidades, <br> nuevos parches, versiones, cambios en la <br> configuración, etc. <br> Antes de publicar un parche, el proveedor ha <br> realizado la batería de pruebas que se han <br> considerado necesarias y lo ha notificado, y en <br> su caso formado, a todo su personal de soporte <br> a clientes. | La organización cliente dispondrá de un <br> procedimiento para analizar, priorizar y <br> determinar cuándo aplicar las actualizaciones de <br> seguridad, parches, mejoras y nuevas versiones <br> del fabricante de la solución y de otros <br> fabricantes que soportan elementos del sistema. <br> La organización cliente gestionará las garantías y <br> contratos de mantenimiento. <br> La organización cliente gestionará las licencias. | Se acordará entre proveedor de la solución y <br> organización cliente un canal para reportar <br> incidencias respecto a parches y <br> actualizaciones instaladas, y para solicitarlos <br> caso de no haberlos recibido. |
| op.exp.5 <br> Gestión de <br> cambios | B | M | A | 80% | 20% | El proveedor de la solución proporcionará toda <br> la información necesaria a la organización <br> cliente, para que ésta pueda analizar un cambio <br> anunciado respecto a la solución implantada, <br> conociendo y evaluando los riesgos que implica <br> antes de aprobarlo. | Se dispondrá de un procedimiento de Gestión de <br> cambios que incluya registro, evaluación, <br> aprobación, etc. Interviniendo el Responsable de <br> Seguridad en aquellas peticiones de cambio que <br> puedan implicar riesgo para la seguridad del <br> sistema. <br> La Gestión de Cambios de la organización cliente <br> incluirá las peticiones de cambio con origen en <br> los proveedores. | La organización cliente dispondrá de una <br> herramienta para registrar las peticiones de <br> cambio y que sirva de soporte para poder <br> evaluarlas antes de su aprobación, <br> manteniendo la trazabilidad de las mismas <br> hasta su aprobación e implementación o su <br> desestimación. |
| op.exp.6 <br> Protección frente <br> a código dañino | TODAS |  |  | 20% | 80% | El proveedor garantiza que la solución podrá <br> funcionar adecuadamente en el entorno del <br> cliente junto con los principales softwares de <br> control de código dañino existentes en el <br> mercado. <br> En determinadas ocasiones, se proporciona en la <br> Guía de instalación una lista actualizada de los <br> principales antivirus comerciales con los que ha <br> sido probada la solución implantada. | La organización cliente dispondrá de <br> mecanismos de protección frente a código <br> dañino y seguirá las indicaciones de los <br> fabricantes del mismo, cómo de los <br> desarrolladores de otras aplicaciones en el <br> sistema. <br> Ante interferencias entre la solución implantada <br> y el antivirus corporativo, puede solicitar ayuda <br> al departamento de soporte del proveedor. | Cuando por cualquier circunstancia algún <br> módulo de la solución implantada sea <br> detectado como virus, deberá gestionar la <br> configuración del antivirus para declararlo <br> como falso positivo, tras haberlo confirmado <br> con el proveedor de la solución. |
| op.exp.7 <br> Gestión de <br> incidentes | B | M | A | 80% | 20% | El proveedor de la solución dispondrá de un <br> procedimiento de gestión de incidentes <br> conforme al ENS y las organizaciones cliente <br> podrán hacer uso de un canal establecido al <br> efecto para comunicar comportamientos <br> anómalos o incidentes respecto a la solución <br> implantada. <br> El personal de soporte del proveedor asignará <br> una categorización y escalado según la criticidad <br> que perciba el cliente. <br> Los registros de auditoría de la solución <br> implantada permiten trazar la incidencia, bien | En la organización cliente se dispondrá de un <br> procedimiento de gestión de incidentes que, en <br> su caso, reaccione y aísle los servicios <br> proporcionados por la solución en caso de <br> necesidad, escalando el problema al proveedor <br> de la solución. <br> Se concienciará a los usuarios de la organización <br> cliente para que comuniquen al Centro de <br> Atención a los Usuarios (CAU) todas las <br> incidencias sin dilación y siguiendo el <br> procedimiento establecido. | Se acordará entre el proveedor de la solución <br> y la organización cliente un canal para <br> reportar incidentes de seguridad, como <br> consecuencia del escalado de los mismos <br> desde el CAU del cliente. |


![Imagen 1 - Página 19](858 DD_assets\pagina19_img1.png)

![Imagen 2 - Página 19](858 DD_assets\pagina19_img2.png)

![Imagen 3 - Página 19](858 DD_assets\pagina19_img3.png)

![Imagen 4 - Página 19](858 DD_assets\pagina19_img4.png)

![Imagen 5 - Página 19](858 DD_assets\pagina19_img5.png)

---

<!-- Página 20 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
mediante registros con origen en la propia
solución o de los entornos que soportan la
misma (servidor o directorio activo).
Si la incidencia puede ser reiterativa en la
solución, el proveedor informará con la mayor
diligencia a todas las organizaciones cliente que
dispongan de la misma versión y pudieran llegar
a sufrir la misma incidencia y, según el nivel de
riesgo, se apresurará en elaborar y distribuir un
parche que la solucione.
Existe un registro de actividad en la solución Para categoría media, la organización cliente Para categoría alta, el proveedor de la
implantada que registra las acciones más revisará informalmente los registros de actividad solución debe proporcionar la información
importantes que realizan los usuarios. Dicho buscando patrones anormales. necesaria (ubicación, formatos, etc.) para que
registro es configurable, dado que registrarlo Para categoría alta, se empleará un SIEM o puedan tratarse adecuadamente de forma
todo podría significar elevados volúmenes de correlador de eventos para tratar los LOGS de automatizada los diferentes LOGS
información. modo que permita gestionar la seguridad de proporcionados por la solución implantada y
De forma genérica se registra toda la actividad forma centralizada. poder establecer así las alertas adecuadas.
referente a:
 Segregación de funciones y tareas.
op.exp.8
 Gestión de derechos de acceso.
Registro de la
B M A 60% 40%  Mecanismos de autenticación.
actividad de los
De forma específica se establece un campo que
usuarios
permite ser configurado por el cliente para
indicar sobre que módulos o funcionalidades es
necesario llevar a cabo un registro de la
actividad de usuarios.
Los registros reflejan en la medida de lo posible:
 ¿Quién modifica?
 ¿Qué modifica?
 ¿A quién afecta?
 ¿Cuándo modifica?
El proveedor de la solución implantada facilitará Existirá en la organización cliente un proceso de
información respecto a la gestión de los control de las incidencias gestionadas
incidentes al cliente. Para ello, dispone de un internamente, incluyendo las derivadas al
proceso documentado de la gestión para la proveedor de la solución implantada, que
op.exp.9
gestión de incidentes, apoyado en una permita verificar el cumplimiento de los
Registro de
B M A 70% 30% herramienta de registro y seguimiento. Acuerdos de Nivel de Servicio (ANS/SLA)
Gestión de
Dicho registro le permite al proveedor obtener respecto al soporte proporcionado.
incidentes
estadísticas de incidentes acaecidos en la
solución y poner medios para evitar su
ocurrencia futura en relación a todos sus
clientes.
Centro Criptológico Nacional 20

|  |  |  |  |  |  | mediante registros con origen en la propia <br> solución o de los entornos que soportan la <br> misma (servidor o directorio activo). <br> Si la incidencia puede ser reiterativa en la <br> solución, el proveedor informará con la mayor <br> diligencia a todas las organizaciones cliente que <br> dispongan de la misma versión y pudieran llegar <br> a sufrir la misma incidencia y, según el nivel de <br> riesgo, se apresurará en elaborar y distribuir un <br> parche que la solucione. |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| op.exp.8 <br> Registro de la <br> actividad de los <br> usuarios | B | M | A | 60% | 40% | Existe un registro de actividad en la solución <br> implantada que registra las acciones más <br> importantes que realizan los usuarios. Dicho <br> registro es configurable, dado que registrarlo <br> todo podría significar elevados volúmenes de <br> información. <br> De forma genérica se registra toda la actividad <br> referente a: <br>  Segregación de funciones y tareas. <br>  Gestión de derechos de acceso. <br>  Mecanismos de autenticación. <br> De forma específica se establece un campo que <br> permite ser configurado por el cliente para <br> indicar sobre que módulos o funcionalidades es <br> necesario llevar a cabo un registro de la <br> actividad de usuarios. <br> Los registros reflejan en la medida de lo posible: <br>  ¿Quién modifica? <br>  ¿Qué modifica? <br>  ¿A quién afecta? <br>  ¿Cuándo modifica? | Para categoría media, la organización cliente <br> revisará informalmente los registros de actividad <br> buscando patrones anormales. <br> Para categoría alta, se empleará un SIEM o <br> correlador de eventos para tratar los LOGS de <br> modo que permita gestionar la seguridad de <br> forma centralizada. | Para categoría alta, el proveedor de la <br> solución debe proporcionar la información <br> necesaria (ubicación, formatos, etc.) para que <br> puedan tratarse adecuadamente de forma <br> automatizada los diferentes LOGS <br> proporcionados por la solución implantada y <br> poder establecer así las alertas adecuadas. |
| op.exp.9 <br> Registro de <br> Gestión de <br> incidentes | B | M | A | 70% | 30% | El proveedor de la solución implantada facilitará <br> información respecto a la gestión de los <br> incidentes al cliente. Para ello, dispone de un <br> proceso documentado de la gestión para la <br> gestión de incidentes, apoyado en una <br> herramienta de registro y seguimiento. <br> Dicho registro le permite al proveedor obtener <br> estadísticas de incidentes acaecidos en la <br> solución y poner medios para evitar su <br> ocurrencia futura en relación a todos sus <br> clientes. | Existirá en la organización cliente un proceso de <br> control de las incidencias gestionadas <br> internamente, incluyendo las derivadas al <br> proveedor de la solución implantada, que <br> permita verificar el cumplimiento de los <br> Acuerdos de Nivel de Servicio (ANS/SLA) <br> respecto al soporte proporcionado. |  |


![Imagen 1 - Página 20](858 DD_assets\pagina20_img1.png)

![Imagen 2 - Página 20](858 DD_assets\pagina20_img2.png)

![Imagen 3 - Página 20](858 DD_assets\pagina20_img3.png)

![Imagen 4 - Página 20](858 DD_assets\pagina20_img4.png)

![Imagen 5 - Página 20](858 DD_assets\pagina20_img5.png)

---

<!-- Página 21 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
El proveedor de la solución especificará Para categoría alta, la organización cliente debe La organización cliente, caso de no haber sido
claramente en la Guía de instalación dónde se de llevar una gestión centralizada de todos los previsto por el proveedor, debe establecer
almacenan los distintos LOGS (si no es registros de LOGS generados por sus servicios, mecanismos para proteger la
parametrizable), con qué formato, cuando se que le permitan realizar una correlación de los confidencialidad de los LOGS, su integridad y
borran, si están en claro o cifrados, etc. mismos con el objeto de detectar actividades su disponibilidad, incluyéndolos en la política
El proveedor de la solución habilitará un campo inusuales. de backup.
op.exp.10
que permita configurar la ubicación donde se
Protección de los
B M A 50% 50% almacenaran dichos registros (preferiblemente
registros de
en base de datos).
actividad
Los eventos se registran en un formato
estandarizado, comprensible para la mayoría de
los correladores de eventos.
Se especifica el período de retención y
conservación de los LOGS, caso de no ser
configurable.
La solución permite el uso de elementos Existirá un proceso de control de las claves Se emplearán gestores de claves para
criptográficos certificados y acreditados. criptográficas en todo su ciclo de vida. almacenar las contraseñas de administración
Las claves caducadas serán rechazadas. Únicamente se emplearán elementos del sistema y las claves criptográficas
op.exp.11
criptográficos certificados y acreditados. necesarias, incluyendo las requeridas por la
Protección de
B M A 50% 50% solución.
claves
Admitirán grupos de perfiles para su gestión
criptográficas
segura sin que todos quienes accedan
dispongan de acceso global a todo el
contenido.
El proveedor de la solución suscribirá un En determinadas ocasiones la organización Se establecerán de forma clara las
acuerdo contractual con la organización cliente. cliente se adscribe a unas condiciones generales responsabilidades de las partes, proveedor y
Se detallará en él lo que se considera calidad de contratación, las cuales deben leerse cliente, en relación a la solución aportada.
mínima y comportamiento normalizado de la detalladamente con antelación, en evitación de
solución. El proveedor responderá ante desagradables sorpresas futuras.
comportamientos anómalos de la plataforma,
op.ext.1 mediante mantenimiento correctivo,
Contratación y especialmente el que corrija incidentes de
B M A 50% 50%
acuerdos de nivel seguridad.
de servicio (SLA) Como parte de dicho contrato, en una adenda al
mismo, o en un documento aparte, se
establecerán acuerdos de nivel de servicio (SLA).
Los SLA al menos cubrirán las acciones de
respuesta a incidentes reportados por la
organización cliente y frecuencia de elaborar y
facilitar reportes de gestión.
El proveedor de la solución implantada facilitará Existirá un procedimiento interno de evaluación Pueden llegar a acordarse reuniones de
op.ext.2
B M A 70% 30% información del servicio, como pueden ser los de los proveedores, de los niveles de servicio y seguimiento periódicas, aunque sea una vez
Gestión diaria
tiempos de respuesta respecto a los incidentes cumplimiento de los requisitos establecidos, al año, levantándose acta de las mismas y los
Centro Criptológico Nacional 21

| op.exp.10 <br> Protección de los <br> registros de <br> actividad | B | M | A | 50% | 50% | El proveedor de la solución especificará <br> claramente en la Guía de instalación dónde se <br> almacenan los distintos LOGS (si no es <br> parametrizable), con qué formato, cuando se <br> borran, si están en claro o cifrados, etc. <br> El proveedor de la solución habilitará un campo <br> que permita configurar la ubicación donde se <br> almacenaran dichos registros (preferiblemente <br> en base de datos). <br> Los eventos se registran en un formato <br> estandarizado, comprensible para la mayoría de <br> los correladores de eventos. <br> Se especifica el período de retención y <br> conservación de los LOGS, caso de no ser <br> configurable. | Para categoría alta, la organización cliente debe <br> de llevar una gestión centralizada de todos los <br> registros de LOGS generados por sus servicios, <br> que le permitan realizar una correlación de los <br> mismos con el objeto de detectar actividades <br> inusuales. | La organización cliente, caso de no haber sido <br> previsto por el proveedor, debe establecer <br> mecanismos para proteger la <br> confidencialidad de los LOGS, su integridad y <br> su disponibilidad, incluyéndolos en la política <br> de backup. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| op.exp.11 <br> Protección de <br> claves <br> criptográficas | B | M | A | 50% | 50% | La solución permite el uso de elementos <br> criptográficos certificados y acreditados. <br> Las claves caducadas serán rechazadas. | Existirá un proceso de control de las claves <br> criptográficas en todo su ciclo de vida. <br> Únicamente se emplearán elementos <br> criptográficos certificados y acreditados. | Se emplearán gestores de claves para <br> almacenar las contraseñas de administración <br> del sistema y las claves criptográficas <br> necesarias, incluyendo las requeridas por la <br> solución. <br> Admitirán grupos de perfiles para su gestión <br> segura sin que todos quienes accedan <br> dispongan de acceso global a todo el <br> contenido. |
| op.ext.1 <br> Contratación y <br> acuerdos de nivel <br> de servicio (SLA) | B | M | A | 50% | 50% | El proveedor de la solución suscribirá un <br> acuerdo contractual con la organización cliente. <br> Se detallará en él lo que se considera calidad <br> mínima y comportamiento normalizado de la <br> solución. El proveedor responderá ante <br> comportamientos anómalos de la plataforma, <br> mediante mantenimiento correctivo, <br> especialmente el que corrija incidentes de <br> seguridad. <br> Como parte de dicho contrato, en una adenda al <br> mismo, o en un documento aparte, se <br> establecerán acuerdos de nivel de servicio (SLA). <br> Los SLA al menos cubrirán las acciones de <br> respuesta a incidentes reportados por la <br> organización cliente y frecuencia de elaborar y <br> facilitar reportes de gestión. | En determinadas ocasiones la organización <br> cliente se adscribe a unas condiciones generales <br> de contratación, las cuales deben leerse <br> detalladamente con antelación, en evitación de <br> desagradables sorpresas futuras. | Se establecerán de forma clara las <br> responsabilidades de las partes, proveedor y <br> cliente, en relación a la solución aportada. |
| op.ext.2 <br> Gestión diaria | B | M | A | 70% | 30% | El proveedor de la solución implantada facilitará <br> información del servicio, como pueden ser los <br> tiempos de respuesta respecto a los incidentes | Existirá un procedimiento interno de evaluación <br> de los proveedores, de los niveles de servicio y <br> cumplimiento de los requisitos establecidos, | Pueden llegar a acordarse reuniones de <br> seguimiento periódicas, aunque sea una vez <br> al año, levantándose acta de las mismas y los |


![Imagen 1 - Página 21](858 DD_assets\pagina21_img1.png)

![Imagen 2 - Página 21](858 DD_assets\pagina21_img2.png)

![Imagen 3 - Página 21](858 DD_assets\pagina21_img3.png)

![Imagen 4 - Página 21](858 DD_assets\pagina21_img4.png)

![Imagen 5 - Página 21](858 DD_assets\pagina21_img5.png)

---

<!-- Página 22 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
reportados y su comparativa con los SLA más complejo como menor información facilite acuerdos tomados.
acordados. el proveedor.
El proveedor facilitará los correspondientes
canales para reportar incidentes y
periódicamente informes de gestión respecto al
departamento de soporte en lo que respecta al
cliente contratante.
Inicialmente no aplica. Salvo que el propio Para sistemas de categoría alta se tendrá
proveedor en su Plan de Continuidad disponga elegido, estudiado y, a ser posible,
de un proveedor alternativo para transferirle el comprometido contractualmente, un proveedor
op.ext.9 servicio (por ejemplo, el soporte y alternativo para prestar el servicio con las
Medios B M A 0% 100% mantenimiento de la solución aportada) no le mismas garantías de seguridad.
alternativos afecta.
En ese caso se comunicará su existencia, y
preferiblemente sus datos, a la organización
cliente.
El proveedor de la solución incluye el servicio de La organización cliente dispondrá de un análisis
gestión de incidentes y de soporte a las de impacto (BIA) que incluya la solución
organizaciones cliente en su análisis de impacto aportada por el proveedor.
(BIA).
El proveedor de la solución facilitará toda la
op.cont.1
información requerida por el cliente para poder
Análisis de B M A 60% 40%
realizar sus propios análisis de impacto.
impacto
El proveedor facilita un esquema de la
arquitectura de la solución, para que la
organización cliente conozca las dependencias
de los elementos que son críticos para los
servicios soportados por la solución.
Si el proveedor dispone de un plan de Para categoría alta, el Plan de Continuidad
continuidad que esté relacionado, directa o deberá asegurar la solución, siempre que se
op.cont.2 indirectamente, con la solución aportada o con haya determinado su conveniencia en el BIA. En
Plan de B M A 10% 90% servicios de soporte, deberá informar al cliente. caso afirmativo se conciliará la información
continuidad aportada por el proveedor respecto a su Plan de
Continuidad, con el propio Plan de Continuidad
de la organización cliente.
El proveedor informará a la organización cliente La organización cliente deberá realizar pruebas
op.cont.3 de las pruebas realizadas respecto a su Plan de de su Plan de Continuidad, en relación a la
Pruebas B M A 10% 90% continuidad, y en qué fecha las ha realizado, con solución implantada.
periódicas relación al soporte y mantenimiento correctivo
de la solución aportada.
op.mon.1 Inicialmente no aplica. No obstante, el La organización cliente dispondrá de
Detección de B M A 10% 90% proveedor dispondrá en su propia red de herramientas específicas de detección y
intrusión desarrollo, que posiblemente incluya a un prevención de intrusión (IDS/IPS) o aprovechará
Centro Criptológico Nacional 22

|  |  |  |  |  |  | reportados y su comparativa con los SLA <br> acordados. <br> El proveedor facilitará los correspondientes <br> canales para reportar incidentes y <br> periódicamente informes de gestión respecto al <br> departamento de soporte en lo que respecta al <br> cliente contratante. | más complejo como menor información facilite <br> el proveedor. | acuerdos tomados. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| op.ext.9 <br> Medios <br> alternativos | B | M | A | 0% | 100% | Inicialmente no aplica. Salvo que el propio <br> proveedor en su Plan de Continuidad disponga <br> de un proveedor alternativo para transferirle el <br> servicio (por ejemplo, el soporte y <br> mantenimiento de la solución aportada) no le <br> afecta. <br> En ese caso se comunicará su existencia, y <br> preferiblemente sus datos, a la organización <br> cliente. | Para sistemas de categoría alta se tendrá <br> elegido, estudiado y, a ser posible, <br> comprometido contractualmente, un proveedor <br> alternativo para prestar el servicio con las <br> mismas garantías de seguridad. |  |
| op.cont.1 <br> Análisis de <br> impacto | B | M | A | 60% | 40% | El proveedor de la solución incluye el servicio de <br> gestión de incidentes y de soporte a las <br> organizaciones cliente en su análisis de impacto <br> (BIA). <br> El proveedor de la solución facilitará toda la <br> información requerida por el cliente para poder <br> realizar sus propios análisis de impacto. <br> El proveedor facilita un esquema de la <br> arquitectura de la solución, para que la <br> organización cliente conozca las dependencias <br> de los elementos que son críticos para los <br> servicios soportados por la solución. | La organización cliente dispondrá de un análisis <br> de impacto (BIA) que incluya la solución <br> aportada por el proveedor. |  |
| op.cont.2 <br> Plan de <br> continuidad | B | M | A | 10% | 90% | Si el proveedor dispone de un plan de <br> continuidad que esté relacionado, directa o <br> indirectamente, con la solución aportada o con <br> servicios de soporte, deberá informar al cliente. | Para categoría alta, el Plan de Continuidad <br> deberá asegurar la solución, siempre que se <br> haya determinado su conveniencia en el BIA. En <br> caso afirmativo se conciliará la información <br> aportada por el proveedor respecto a su Plan de <br> Continuidad, con el propio Plan de Continuidad <br> de la organización cliente. |  |
| op.cont.3 <br> Pruebas <br> periódicas | B | M | A | 10% | 90% | El proveedor informará a la organización cliente <br> de las pruebas realizadas respecto a su Plan de <br> continuidad, y en qué fecha las ha realizado, con <br> relación al soporte y mantenimiento correctivo <br> de la solución aportada. | La organización cliente deberá realizar pruebas <br> de su Plan de Continuidad, en relación a la <br> solución implantada. |  |
| op.mon.1 <br> Detección de <br> intrusión | B | M | A | 10% | 90% | Inicialmente no aplica. No obstante, el <br> proveedor dispondrá en su propia red de <br> desarrollo, que posiblemente incluya a un | La organización cliente dispondrá de <br> herramientas específicas de detección y <br> prevención de intrusión (IDS/IPS) o aprovechará |  |


![Imagen 1 - Página 22](858 DD_assets\pagina22_img1.png)

![Imagen 2 - Página 22](858 DD_assets\pagina22_img2.png)

![Imagen 3 - Página 22](858 DD_assets\pagina22_img3.png)

![Imagen 4 - Página 22](858 DD_assets\pagina22_img4.png)

![Imagen 5 - Página 22](858 DD_assets\pagina22_img5.png)

---

<!-- Página 23 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
repositorio de código fuente, de los mecanismos dichas funcionalidades en los FW, caso de que
de detección y de prevención de intrusión dispongan de ellas, estén contratadas y
necesarios para minimizar el riesgo de una configuradas.
alteración con fines maliciosos del código que se
distribuirá posteriormente a los clientes.
Para categoría media el proveedor dispone de La organización cliente calculará las métricas de
mediciones relacionadas con los incidentes que categoría media, referidas a la gestión de
op.mon.2
gestiona, que hayan sido abiertas por la incidentes, armonizándolas de ser necesario con
Sistema de B M A 10% 90%
organización cliente, incluyendo los tiempos de las mediciones facilitadas por el proveedor de la
métricas
resolución. solución respecto a los incidentes que le han
sido escalados.
Inicialmente no aplica. No obstante, el La infraestructura TIC que soporta a la solución
mp.if.1 proveedor dispondrá de áreas separadas y implantada, incluyendo los elementos hardware
Áreas separadas protegidas donde se ubicará el repositorio de específicos que pueda incorporar, se instalará en
TODAS 10% 90%
con control de código fuente y el resto de la infraestructura TIC áreas separadas protegidas con control de
acceso necesaria para poder prestar los servicios de acceso.
soporte, mantenimiento y desarrollo.
Inicialmente no aplica. No obstante, el Se identificará a todas las personas que accedan
proveedor dispondrá de un sistema de a los locales donde se encuentran los equipos
identificación de las personas con acceso a la que soportan la solución y únicamente se
sala donde se encuentra el repositorio de código permitirá trabajar en los equipos a personal
mp.if.2 fuente. cualificado que esté debidamente autorizado.
Identificación de TODAS 20% 80% Únicamente personal autorizado e identificado
las personas debería acceder a la parametrización de la
solución en el proceso de implantación en las
dependencias de la organización cliente, bajo la
supervisión del Responsable de Seguridad del
mismo.
Inicialmente no aplica. No obstante, el Se debe disponer de unas instalaciones
mp.if.3 proveedor dispondrá de sus dependencias auxiliares adecuadas para garantizar el eficaz
Acondicionamient TODAS 10% 90% acondicionadas para poder prestar los servicios desempeño de la infraestructura TIC en la que se
o de los locales asociados a la solución implantada apoya la solución implantada, protegiéndola de
(mantenimiento y soporte). los riesgos identificados.
Inicialmente no aplica. No obstante, los Debe garantizarse la energía eléctrica en los
elementos TIC necesarios para prestar servicios equipos que soportan la solución implantada y,
mp.if.4 de soporte y atención al cliente tendrán en caso de fallo de suministro, garantizar su
B M A 20% 80%
Energía eléctrica garantizado el suministro eléctrico durante los funcionamiento mediante SAIS y, a ser posible,
tiempos acordados en los SLA suscritos con la generadores eléctricos.
organización cliente.
Inicialmente no aplica. No obstante, los Deben protegerse frente a incendios los equipos
mp.if.5
elementos TIC necesarios para prestar servicios que soportan la solución implantada, ya sean
Protección frente TODAS 20% 80%
de soporte y atención al cliente tendrán estos fortuitos o deliberados, aplicando al
a incendios
garantizada la protección frente a incendios. menos la normativa industrial pertinente.
Centro Criptológico Nacional 23

|  |  |  |  |  |  | repositorio de código fuente, de los mecanismos <br> de detección y de prevención de intrusión <br> necesarios para minimizar el riesgo de una <br> alteración con fines maliciosos del código que se <br> distribuirá posteriormente a los clientes. | dichas funcionalidades en los FW, caso de que <br> dispongan de ellas, estén contratadas y <br> configuradas. |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| op.mon.2 <br> Sistema de <br> métricas | B | M | A | 10% | 90% | Para categoría media el proveedor dispone de <br> mediciones relacionadas con los incidentes que <br> gestiona, que hayan sido abiertas por la <br> organización cliente, incluyendo los tiempos de <br> resolución. | La organización cliente calculará las métricas de <br> categoría media, referidas a la gestión de <br> incidentes, armonizándolas de ser necesario con <br> las mediciones facilitadas por el proveedor de la <br> solución respecto a los incidentes que le han <br> sido escalados. |  |
| mp.if.1 <br> Áreas separadas <br> con control de <br> acceso | TODAS |  |  | 10% | 90% | Inicialmente no aplica. No obstante, el <br> proveedor dispondrá de áreas separadas y <br> protegidas donde se ubicará el repositorio de <br> código fuente y el resto de la infraestructura TIC <br> necesaria para poder prestar los servicios de <br> soporte, mantenimiento y desarrollo. | La infraestructura TIC que soporta a la solución <br> implantada, incluyendo los elementos hardware <br> específicos que pueda incorporar, se instalará en <br> áreas separadas protegidas con control de <br> acceso. |  |
| mp.if.2 <br> Identificación de <br> las personas | TODAS |  |  | 20% | 80% | Inicialmente no aplica. No obstante, el <br> proveedor dispondrá de un sistema de <br> identificación de las personas con acceso a la <br> sala donde se encuentra el repositorio de código <br> fuente. <br> Únicamente personal autorizado e identificado <br> debería acceder a la parametrización de la <br> solución en el proceso de implantación en las <br> dependencias de la organización cliente, bajo la <br> supervisión del Responsable de Seguridad del <br> mismo. | Se identificará a todas las personas que accedan <br> a los locales donde se encuentran los equipos <br> que soportan la solución y únicamente se <br> permitirá trabajar en los equipos a personal <br> cualificado que esté debidamente autorizado. |  |
| mp.if.3 <br> Acondicionamient <br> o de los locales | TODAS |  |  | 10% | 90% | Inicialmente no aplica. No obstante, el <br> proveedor dispondrá de sus dependencias <br> acondicionadas para poder prestar los servicios <br> asociados a la solución implantada <br> (mantenimiento y soporte). | Se debe disponer de unas instalaciones <br> auxiliares adecuadas para garantizar el eficaz <br> desempeño de la infraestructura TIC en la que se <br> apoya la solución implantada, protegiéndola de <br> los riesgos identificados. |  |
| mp.if.4 <br> Energía eléctrica | B | M | A | 20% | 80% | Inicialmente no aplica. No obstante, los <br> elementos TIC necesarios para prestar servicios <br> de soporte y atención al cliente tendrán <br> garantizado el suministro eléctrico durante los <br> tiempos acordados en los SLA suscritos con la <br> organización cliente. | Debe garantizarse la energía eléctrica en los <br> equipos que soportan la solución implantada y, <br> en caso de fallo de suministro, garantizar su <br> funcionamiento mediante SAIS y, a ser posible, <br> generadores eléctricos. |  |
| mp.if.5 <br> Protección frente <br> a incendios | TODAS |  |  | 20% | 80% | Inicialmente no aplica. No obstante, los <br> elementos TIC necesarios para prestar servicios <br> de soporte y atención al cliente tendrán <br> garantizada la protección frente a incendios. | Deben protegerse frente a incendios los equipos <br> que soportan la solución implantada, ya sean <br> estos fortuitos o deliberados, aplicando al <br> menos la normativa industrial pertinente. |  |


![Imagen 1 - Página 23](858 DD_assets\pagina23_img1.png)

![Imagen 2 - Página 23](858 DD_assets\pagina23_img2.png)

![Imagen 3 - Página 23](858 DD_assets\pagina23_img3.png)

![Imagen 4 - Página 23](858 DD_assets\pagina23_img4.png)

![Imagen 5 - Página 23](858 DD_assets\pagina23_img5.png)

---

<!-- Página 24 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
Inicialmente no aplica. No obstante, los Deben protegerse frente a incidentes causados
mp.if.6
elementos TIC necesarios para prestar servicios por el agua, ya sean fortuitos o deliberados, los
protección frente B M A 20% 80%
de soporte y atención al cliente tendrán equipos que soportan la solución implantada.
a inundaciones
garantizada la protección frente a inundaciones.
No aplica. No obstante, el proveedor debe En el área segura donde se ubica la
registrar la entrada y salida de equipamiento al infraestructura que soporta la solución
mp.if.7
área segura donde se encuentra la implantada, existirá un registro pormenorizado
Registro de
TODAS 10% 90% infraestructura TIC del proveedor de la solución de toda entrada y salida de equipamiento,
entrada y salida
empleada para poder dar servicio de incluyendo la identificación de la persona que
de equipamiento
mantenimiento y soporte, incluido el repositorio autoriza de movimiento.
de código fuente.
No aplica. No obstante, para categoría alta, se Para sistemas de categoría alta, se garantizará la
dispondrá de instalaciones alternativas que existencia y disponibilidad de instalaciones
alberguen la infraestructura TIC necesaria para alternativas que soporten la solución
mp.if.9
prestar servicios de mantenimiento y soporte. implantada, para poder seguir operando en el
Instalaciones B M A 0% 100%
caso de que las instalaciones habituales no estén
alternativas
disponibles. Las instalaciones alternativas
disfrutarán de las mismas garantías de seguridad
que las instalaciones habituales.
El personal de desarrollo, mantenimiento y Se definirán los requisitos que deben satisfacer Se definirán perfiles y grupos de usuarios en
soporte del proveedor tendrán identificadas sus las personas que vayan a ocupar el puesto de la solución, acordes con los requisitos de
mp.per.1 implicaciones respecto a la seguridad. trabajo, en particular, en términos de seguridad.
Caracterización Del mismo modo, el personal del proveedor confidencialidad. Para el Sector Público, además
B M A 50% 50%
del puesto de asignado para implantar la solución en el cliente, de los que constan en la RPT se definirán los
trabajo cumplirá los requerimientos de seguridad puestos sujetos a subcontratación, incidiendo en
establecidos por el propio cliente, además de los implicaciones de seguridad.
del proveedor.
En función de la funcionalidad de la solución Se informará a cada persona que trabaje en la Se suscribirán acuerdos de confidencialidad
implantada, se dispondrá de elementos que solución implantada, de los deberes y con los trabajadores.
permitan al usuario conocer los derechos y responsabilidades de su puesto de trabajo en Se suscribirá un acuerdo de confidencialidad
mp.per.2
obligaciones respecto al uso de la misma. En su materia de seguridad, ya sea personal interno o con el proveedor de la solución.
Deberes y TODAS 50% 50%
defecto, se detallarán en el manual de usuario. subcontratado.
obligaciones
El proveedor de la solución, especialmente su
personal de soporte a clientes, suscribe
cláusulas de confidencialidad.
Todo el personal del proveedor de la solución, Se deben realizar las acciones necesarias para
especialmente el de soporte directo al cliente, concienciar regularmente al personal.
mp.per.3
TODAS 50% 50% estará concienciado respecto a la
Concienciación
confidencialidad y demás dimensiones de la
seguridad.
El proveedor de la solución puede desarrollar Se formará regularmente al personal para el
mp.per.4
TODAS 50% 50% acciones formativas relacionadas con la misma, adecuado desempeño de sus funciones
Formación
de manera que pueda conocerse por los operando la solución, sobre la configuración de
Centro Criptológico Nacional 24

| mp.if.6 <br> protección frente <br> a inundaciones | B | M | A | 20% | 80% | Inicialmente no aplica. No obstante, los <br> elementos TIC necesarios para prestar servicios <br> de soporte y atención al cliente tendrán <br> garantizada la protección frente a inundaciones. | Deben protegerse frente a incidentes causados <br> por el agua, ya sean fortuitos o deliberados, los <br> equipos que soportan la solución implantada. |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| mp.if.7 <br> Registro de <br> entrada y salida <br> de equipamiento | TODAS |  |  | 10% | 90% | No aplica. No obstante, el proveedor debe <br> registrar la entrada y salida de equipamiento al <br> área segura donde se encuentra la <br> infraestructura TIC del proveedor de la solución <br> empleada para poder dar servicio de <br> mantenimiento y soporte, incluido el repositorio <br> de código fuente. | En el área segura donde se ubica la <br> infraestructura que soporta la solución <br> implantada, existirá un registro pormenorizado <br> de toda entrada y salida de equipamiento, <br> incluyendo la identificación de la persona que <br> autoriza de movimiento. |  |
| mp.if.9 <br> Instalaciones <br> alternativas | B | M | A | 0% | 100% | No aplica. No obstante, para categoría alta, se <br> dispondrá de instalaciones alternativas que <br> alberguen la infraestructura TIC necesaria para <br> prestar servicios de mantenimiento y soporte. | Para sistemas de categoría alta, se garantizará la <br> existencia y disponibilidad de instalaciones <br> alternativas que soporten la solución <br> implantada, para poder seguir operando en el <br> caso de que las instalaciones habituales no estén <br> disponibles. Las instalaciones alternativas <br> disfrutarán de las mismas garantías de seguridad <br> que las instalaciones habituales. |  |
| mp.per.1 <br> Caracterización <br> del puesto de <br> trabajo | B | M | A | 50% | 50% | El personal de desarrollo, mantenimiento y <br> soporte del proveedor tendrán identificadas sus <br> implicaciones respecto a la seguridad. <br> Del mismo modo, el personal del proveedor <br> asignado para implantar la solución en el cliente, <br> cumplirá los requerimientos de seguridad <br> establecidos por el propio cliente, además de los <br> del proveedor. | Se definirán los requisitos que deben satisfacer <br> las personas que vayan a ocupar el puesto de <br> trabajo, en particular, en términos de <br> confidencialidad. Para el Sector Público, además <br> de los que constan en la RPT se definirán los <br> puestos sujetos a subcontratación, incidiendo en <br> implicaciones de seguridad. | Se definirán perfiles y grupos de usuarios en <br> la solución, acordes con los requisitos de <br> seguridad. |
| mp.per.2 <br> Deberes y <br> obligaciones | TODAS |  |  | 50% | 50% | En función de la funcionalidad de la solución <br> implantada, se dispondrá de elementos que <br> permitan al usuario conocer los derechos y <br> obligaciones respecto al uso de la misma. En su <br> defecto, se detallarán en el manual de usuario. <br> El proveedor de la solución, especialmente su <br> personal de soporte a clientes, suscribe <br> cláusulas de confidencialidad. | Se informará a cada persona que trabaje en la <br> solución implantada, de los deberes y <br> responsabilidades de su puesto de trabajo en <br> materia de seguridad, ya sea personal interno o <br> subcontratado. | Se suscribirán acuerdos de confidencialidad <br> con los trabajadores. <br> Se suscribirá un acuerdo de confidencialidad <br> con el proveedor de la solución. |
| mp.per.3 <br> Concienciación | TODAS |  |  | 50% | 50% | Todo el personal del proveedor de la solución, <br> especialmente el de soporte directo al cliente, <br> estará concienciado respecto a la <br> confidencialidad y demás dimensiones de la <br> seguridad. | Se deben realizar las acciones necesarias para <br> concienciar regularmente al personal. |  |
| mp.per.4 <br> Formación | TODAS |  |  | 50% | 50% | El proveedor de la solución puede desarrollar <br> acciones formativas relacionadas con la misma, <br> de manera que pueda conocerse por los | Se formará regularmente al personal para el <br> adecuado desempeño de sus funciones <br> operando la solución, sobre la configuración de |  |


![Imagen 1 - Página 24](858 DD_assets\pagina24_img1.png)

![Imagen 2 - Página 24](858 DD_assets\pagina24_img2.png)

![Imagen 3 - Página 24](858 DD_assets\pagina24_img3.png)

![Imagen 4 - Página 24](858 DD_assets\pagina24_img4.png)

![Imagen 5 - Página 24](858 DD_assets\pagina24_img5.png)

---

<!-- Página 25 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
usuarios las funcionalidades y acciones la misma a personal administrador, sobre la
permitidas en la herramienta, así como su uso detección y reacción ante incidentes a los
seguro. usuarios y al CAU y respecto a la correcta gestión
El personal de soporte del proveedor estará de la información tratada por la plataforma a los
formado respecto al uso seguro de la solución usuarios. La referida formación se apoyará en el
implantada en el cliente, de modo que pueda proveedor, al menos inicialmente.
asesorarle con conocimiento de causa.
Se garantizará la existencia y disponibilidad, en Para categoría alta, se garantizará la existencia y El personal alternativo deberá estar sometido
el proveedor de la solución, de varias personas disponibilidad de otras personas, en la a las mismas garantías de seguridad que el
mp.per.9
que se puedan hacer cargo de las funciones de organización cliente, que se puedan hacer cargo personal habitual.
Personal B M A 50% 50%
soporte y mantenimiento correctivo en caso de de las funciones de administración de la solución
alternativo
indisponibilidad del personal habitual. en caso de indisponibilidad del personal
habitual.
No aplica. Se exigirá que los puestos de trabajo Si el servicio suministrado por el proveedor
permanezcan despejados, sin más material incluye personal, también le resultaría de
mp.eq.1
encima de la mesa que el requerido para la aplicación.
Puesto de trabajo B M A *No Sí
actividad que se está realizando en cada
despejado
momento. Para categoría media se guardarán
bajo llave al abandonar el puesto.
La aplicación puede disponer de un tiempo de En la organización cliente donde se haya
inactividad de sesión, debiendo validarse de implantado la solución, se dispondrá de políticas
nuevo una vez alcanzado. al efecto.
Si la organización cliente establece la Mediante directivas de dominio se establecerán
mp.eq.2
cancelación de las sesiones abiertas, los tiempos de inactividad del usuario antes de
Bloqueo de B M A 30% 70%
habitualmente en accesos remotos a la solución, bloqueo del puesto, requiriéndose una nueva
puesto de trabajo
el proveedor habrá realizado el desarrollo autenticación.
previendo que esta casuística no altere o dañe la Para categoría alta, las políticas de cancelación
integridad de la base de datos. de sesiones inactivas pueden establecerse a
nivel de directivas de dominio.
No aplica. No obstante, si los desarrolladores o Los portátiles evitarán conectarse remotamente
personal de mantenimiento y soporte del a la solución desde redes no seguras. Se evitará
proveedor de la solución trabajan en remoto que el equipo contenga memorizadas claves de
mp.ep.3
sobre equipos portátiles, se dispondrá de acceso remoto a la organización y/o a la
Protección de B M A 0% 100%
políticas y medidas de seguridad adecuadas, que solución.
equipos portátiles
incluyan el uso de VPN y tal vez cifrado del disco. Se dispondrá en la organización cliente de una
política de trabajo remoto que se desarrollará
con las medidas de seguridad oportunas.
El proveedor de la solución mantendrá el La organización cliente dispondrá de medios
soporte acordado y no se considerarán, salvo alternativos de tratamiento para soportar la
mp.eq.9
limitaciones en los niveles de servicio, fallos en solución, conforme a los tiempos establecidos
Medios B M A 50% 50%
la atención por no disponer de medios en el análisis de impacto.
alternativos
alternativos.
Centro Criptológico Nacional 25

|  |  |  |  |  |  | usuarios las funcionalidades y acciones <br> permitidas en la herramienta, así como su uso <br> seguro. <br> El personal de soporte del proveedor estará <br> formado respecto al uso seguro de la solución <br> implantada en el cliente, de modo que pueda <br> asesorarle con conocimiento de causa. | la misma a personal administrador, sobre la <br> detección y reacción ante incidentes a los <br> usuarios y al CAU y respecto a la correcta gestión <br> de la información tratada por la plataforma a los <br> usuarios. La referida formación se apoyará en el <br> proveedor, al menos inicialmente. |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| mp.per.9 <br> Personal <br> alternativo | B | M | A | 50% | 50% | Se garantizará la existencia y disponibilidad, en <br> el proveedor de la solución, de varias personas <br> que se puedan hacer cargo de las funciones de <br> soporte y mantenimiento correctivo en caso de <br> indisponibilidad del personal habitual. | Para categoría alta, se garantizará la existencia y <br> disponibilidad de otras personas, en la <br> organización cliente, que se puedan hacer cargo <br> de las funciones de administración de la solución <br> en caso de indisponibilidad del personal <br> habitual. | El personal alternativo deberá estar sometido <br> a las mismas garantías de seguridad que el <br> personal habitual. |
| mp.eq.1 <br> Puesto de trabajo <br> despejado | B | M | A | *No | Sí | No aplica. | Se exigirá que los puestos de trabajo <br> permanezcan despejados, sin más material <br> encima de la mesa que el requerido para la <br> actividad que se está realizando en cada <br> momento. Para categoría media se guardarán <br> bajo llave al abandonar el puesto. | Si el servicio suministrado por el proveedor <br> incluye personal, también le resultaría de <br> aplicación. |
| mp.eq.2 <br> Bloqueo de <br> puesto de trabajo | B | M | A | 30% | 70% | La aplicación puede disponer de un tiempo de <br> inactividad de sesión, debiendo validarse de <br> nuevo una vez alcanzado. <br> Si la organización cliente establece la <br> cancelación de las sesiones abiertas, <br> habitualmente en accesos remotos a la solución, <br> el proveedor habrá realizado el desarrollo <br> previendo que esta casuística no altere o dañe la <br> integridad de la base de datos. | En la organización cliente donde se haya <br> implantado la solución, se dispondrá de políticas <br> al efecto. <br> Mediante directivas de dominio se establecerán <br> los tiempos de inactividad del usuario antes de <br> bloqueo del puesto, requiriéndose una nueva <br> autenticación. <br> Para categoría alta, las políticas de cancelación <br> de sesiones inactivas pueden establecerse a <br> nivel de directivas de dominio. |  |
| mp.ep.3 <br> Protección de <br> equipos portátiles | B | M | A | 0% | 100% | No aplica. No obstante, si los desarrolladores o <br> personal de mantenimiento y soporte del <br> proveedor de la solución trabajan en remoto <br> sobre equipos portátiles, se dispondrá de <br> políticas y medidas de seguridad adecuadas, que <br> incluyan el uso de VPN y tal vez cifrado del disco. | Los portátiles evitarán conectarse remotamente <br> a la solución desde redes no seguras. Se evitará <br> que el equipo contenga memorizadas claves de <br> acceso remoto a la organización y/o a la <br> solución. <br> Se dispondrá en la organización cliente de una <br> política de trabajo remoto que se desarrollará <br> con las medidas de seguridad oportunas. |  |
| mp.eq.9 <br> Medios <br> alternativos | B | M | A | 50% | 50% | El proveedor de la solución mantendrá el <br> soporte acordado y no se considerarán, salvo <br> limitaciones en los niveles de servicio, fallos en <br> la atención por no disponer de medios <br> alternativos. | La organización cliente dispondrá de medios <br> alternativos de tratamiento para soportar la <br> solución, conforme a los tiempos establecidos <br> en el análisis de impacto. |  |


![Imagen 1 - Página 25](858 DD_assets\pagina25_img1.png)

![Imagen 2 - Página 25](858 DD_assets\pagina25_img2.png)

![Imagen 3 - Página 25](858 DD_assets\pagina25_img3.png)

![Imagen 4 - Página 25](858 DD_assets\pagina25_img4.png)

![Imagen 5 - Página 25](858 DD_assets\pagina25_img5.png)

---

<!-- Página 26 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
Cuando por motivo de la operativa y La organización cliente deberá disponer de un
funcionalidad de la solución implantada pueda sistema cortafuegos que separe la red interna
afectarse a este control del cliente abriendo del exterior. Para categoría alta dispondrá de
determinados puertos y/o creando reglas doble corona de clusters de FW, de diferentes
específicas en el cortafuegos (FW), se informa fabricantes.
mp.com.1 claramente en la Guía de instalación de la Se deben estudiar con detenimiento las
B M A 40% 60%
Perímetro seguro solución implantada de todos los puntos implicaciones de requerir crear nuevas reglas en
necesarios para que la organización cliente el FW para la seguridad global del perímetro.
pueda realizar en la configuración del FW, Únicamente personal especializado y autorizado
balanceadores, etc., los cambios necesarios para debe crear reglas en el FW, tras contrastar su
mantener la eficacia y compatibilidad de las necesidad.
funciones de seguridad del perímetro.
Cuando el proveedor de la solución requiera Se emplearán VPN para accesos desde el
prestar soporte remoto, se establecerán VPN, exterior del perímetro, siempre que la solución
temporales y controladas, que empleen implantada no disponga de la suficiente
mp.com.2 algoritmos de cifrado acreditados y con alcance seguridad propia (ser un portal Web).
Protección de la B M A 50% 50% limitado. Se registrarán y verificarán los LOGS. Para categoría alta, se verificará el cifrado de los
confidencialidad datos tratados por la aplicación y, en su caso, se
cifrará la base de datos en que se apoye o se
albergará en una cabina de discos que cifre por
hardware.
La solución implantada dispondrá de Si la solución implantada ha de ser accesible
prevenciones frente a acciones de alteración de desde el exterior sin VPN, se estudiará la
la información, ataques de inyección de código, posibilidad de implantar alguna solución tipo
o secuestros de sesión, especialmente si es Web Application Firewall (WAF), en coordinación
mp.com.3
accedida desde Internet. con el proveedor de la solución.
Protección de la
B M A 50% 50% La aplicación solo permitirá como medios de Se realizará periódicamente algún test de
autenticidad y la
autenticación los descritos en los controles de intrusión, especialmente cuando se introduzcan
integridad
acceso. modificaciones significativas en la solución.
Los perfiles de usuario y sus derechos, si son
gestionados por la propia solución, se
almacenarán cifrados con la robustez adecuada.
No aplica. No obstante, el proveedor de la Para categoría alta, se segregará la solución
solución proporciona en la Guía de instalación implantada de otras redes cuya coexistencia
mp.com.4
información sobre la arquitectura de la solución, pueda entrañar riesgo para la seguridad global
Segregación de B M A 0% 100%
junto a posibilidades y consideraciones ante de la organización cliente.
redes
posibles segregaciones. Se atenderá a las consideraciones del proveedor
de la solución en la Guía de instalación.
No aplica. Salvo los medios de comunicación Para categoría alta, se garantizarán medios
mp.com.9 empleados por el proveedor para prestar alternativos de comunicaciones para mantener
Medios B M A 0% 100% soporte sobre la solución implantada, si esta es el acceso a la solución, cuando éste se requiere
alternativos de categoría alta. desde el exterior del perímetro de la
organización cliente.
Centro Criptológico Nacional 26

| mp.com.1 <br> Perímetro seguro | B | M | A | 40% | 60% | Cuando por motivo de la operativa y <br> funcionalidad de la solución implantada pueda <br> afectarse a este control del cliente abriendo <br> determinados puertos y/o creando reglas <br> específicas en el cortafuegos (FW), se informa <br> claramente en la Guía de instalación de la <br> solución implantada de todos los puntos <br> necesarios para que la organización cliente <br> pueda realizar en la configuración del FW, <br> balanceadores, etc., los cambios necesarios para <br> mantener la eficacia y compatibilidad de las <br> funciones de seguridad del perímetro. | La organización cliente deberá disponer de un <br> sistema cortafuegos que separe la red interna <br> del exterior. Para categoría alta dispondrá de <br> doble corona de clusters de FW, de diferentes <br> fabricantes. <br> Se deben estudiar con detenimiento las <br> implicaciones de requerir crear nuevas reglas en <br> el FW para la seguridad global del perímetro. <br> Únicamente personal especializado y autorizado <br> debe crear reglas en el FW, tras contrastar su <br> necesidad. |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| mp.com.2 <br> Protección de la <br> confidencialidad | B | M | A | 50% | 50% | Cuando el proveedor de la solución requiera <br> prestar soporte remoto, se establecerán VPN, <br> temporales y controladas, que empleen <br> algoritmos de cifrado acreditados y con alcance <br> limitado. Se registrarán y verificarán los LOGS. | Se emplearán VPN para accesos desde el <br> exterior del perímetro, siempre que la solución <br> implantada no disponga de la suficiente <br> seguridad propia (ser un portal Web). <br> Para categoría alta, se verificará el cifrado de los <br> datos tratados por la aplicación y, en su caso, se <br> cifrará la base de datos en que se apoye o se <br> albergará en una cabina de discos que cifre por <br> hardware. |  |
| mp.com.3 <br> Protección de la <br> autenticidad y la <br> integridad | B | M | A | 50% | 50% | La solución implantada dispondrá de <br> prevenciones frente a acciones de alteración de <br> la información, ataques de inyección de código, <br> o secuestros de sesión, especialmente si es <br> accedida desde Internet. <br> La aplicación solo permitirá como medios de <br> autenticación los descritos en los controles de <br> acceso. <br> Los perfiles de usuario y sus derechos, si son <br> gestionados por la propia solución, se <br> almacenarán cifrados con la robustez adecuada. | Si la solución implantada ha de ser accesible <br> desde el exterior sin VPN, se estudiará la <br> posibilidad de implantar alguna solución tipo <br> Web Application Firewall (WAF), en coordinación <br> con el proveedor de la solución. <br> Se realizará periódicamente algún test de <br> intrusión, especialmente cuando se introduzcan <br> modificaciones significativas en la solución. |  |
| mp.com.4 <br> Segregación de <br> redes | B | M | A | 0% | 100% | No aplica. No obstante, el proveedor de la <br> solución proporciona en la Guía de instalación <br> información sobre la arquitectura de la solución, <br> junto a posibilidades y consideraciones ante <br> posibles segregaciones. | Para categoría alta, se segregará la solución <br> implantada de otras redes cuya coexistencia <br> pueda entrañar riesgo para la seguridad global <br> de la organización cliente. <br> Se atenderá a las consideraciones del proveedor <br> de la solución en la Guía de instalación. |  |
| mp.com.9 <br> Medios <br> alternativos | B | M | A | 0% | 100% | No aplica. Salvo los medios de comunicación <br> empleados por el proveedor para prestar <br> soporte sobre la solución implantada, si esta es <br> de categoría alta. | Para categoría alta, se garantizarán medios <br> alternativos de comunicaciones para mantener <br> el acceso a la solución, cuando éste se requiere <br> desde el exterior del perímetro de la <br> organización cliente. |  |


![Imagen 1 - Página 26](858 DD_assets\pagina26_img1.png)

![Imagen 2 - Página 26](858 DD_assets\pagina26_img2.png)

![Imagen 3 - Página 26](858 DD_assets\pagina26_img3.png)

![Imagen 4 - Página 26](858 DD_assets\pagina26_img4.png)

![Imagen 5 - Página 26](858 DD_assets\pagina26_img5.png)

---

<!-- Página 27 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
No aplica. Si se emplean soportes, debe existir una política
mp.si.1 de etiquetado en la organización cliente, que
TODAS 0% 100%
Etiquetado incluya los empleados para realizar backups de
la solución implantada.
No aplica. No obstante, se recomendará al Debe existir una política de cifrado para medios
cliente, ya sea en acciones de soporte, o en la removibles, incluidos aquellos en los que
mp.si.2 Guía de instalación y demás documentación de pudieran externalizarse copias de seguridad,
B M A 10% 90%
Criptografía la solución, que cuando se realicen copias en incluidas las de la solución implantada, que
elementos extraíbles se evalúe configurar su considere el riesgo y la calificación de la
cifrado empleando algoritmos acreditados. información almacenada.
No aplica. Se custodiarán debidamente los soportes
empleados, especialmente los que contengan las
mp.si.3 copias de seguridad de la solución implantada.
TODAS 0% 100%
Custodia Las copias de seguridad se conservarán en una
ubicación distinta de la que contiene la base de
datos copiada.
No aplica. Se debe garantizar que los dispositivos portátiles
y móviles junto a los soportes, como pueden ser
mp.si.4 los que contienen las copias de seguridad,
TODAS 0% 100%
Transporte permanezcan bajo el control de la organización
cliente y que satisfacen sus requisitos de
seguridad mientras están siendo desplazados.
Se emplearán datos específicos de prueba. No La organización cliente dispondrá de una política Se conservarán registros y evidencias del
obstante, cuando el personal de proveedor deba de borrado y destrucción conforme borrado y destrucción seguros.
realizar acciones con datos del cliente, procurará a estándares acreditados.
anonimizarlos previamente. El responsable de seguridad de la organización
Si no fuera posible, se emplearán las mismas cliente procederá a confirmar el proceso y el
medidas de seguridad que en producción y al producto empleado para borrar o destruir los
mp.si.5
acabar se emplearán métodos de borrado activos incluidos en la solución implantada, o
Borrado y B M A 50% 50%
seguro, conforme a productos certificados. que la soportan, antes de su retirada.
destrucción
Cuando se deban desinstalar versiones, o se
proceda a retirar maquinas incluidas en la
solución, se procederá a un borrado seguro y en
su caso destrucción certificada con indicación
individual del número de serie de los soportes
destruidos.
El proveedor de la solución emplea una Si la organización cliente dispone de una
metodología de desarrollo que tiene en cuenta metodología de desarrollo que tenga en cuenta
la seguridad. No obstante, en desarrollos a la seguridad, puede exigirse al proveedor de la
mp.sw.1
B M A 100% 0% medida se podrá emplear la metodología de la solución que los desarrollos a medida se
Desarrollo
organización cliente. adapten a la misma.
Se dispone de evidencias de control del La organización cliente requerirá a los
desarrollo y de la calidad del mismo, así como de proveedores de la solución, habitualmente si es
Centro Criptológico Nacional 27

| mp.si.1 <br> Etiquetado | TODAS |  |  | 0% | 100% | No aplica. | Si se emplean soportes, debe existir una política <br> de etiquetado en la organización cliente, que <br> incluya los empleados para realizar backups de <br> la solución implantada. |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| mp.si.2 <br> Criptografía | B | M | A | 10% | 90% | No aplica. No obstante, se recomendará al <br> cliente, ya sea en acciones de soporte, o en la <br> Guía de instalación y demás documentación de <br> la solución, que cuando se realicen copias en <br> elementos extraíbles se evalúe configurar su <br> cifrado empleando algoritmos acreditados. | Debe existir una política de cifrado para medios <br> removibles, incluidos aquellos en los que <br> pudieran externalizarse copias de seguridad, <br> incluidas las de la solución implantada, que <br> considere el riesgo y la calificación de la <br> información almacenada. |  |
| mp.si.3 <br> Custodia | TODAS |  |  | 0% | 100% | No aplica. | Se custodiarán debidamente los soportes <br> empleados, especialmente los que contengan las <br> copias de seguridad de la solución implantada. <br> Las copias de seguridad se conservarán en una <br> ubicación distinta de la que contiene la base de <br> datos copiada. |  |
| mp.si.4 <br> Transporte | TODAS |  |  | 0% | 100% | No aplica. | Se debe garantizar que los dispositivos portátiles <br> y móviles junto a los soportes, como pueden ser <br> los que contienen las copias de seguridad, <br> permanezcan bajo el control de la organización <br> cliente y que satisfacen sus requisitos de <br> seguridad mientras están siendo desplazados. |  |
| mp.si.5 <br> Borrado y <br> destrucción | B | M | A | 50% | 50% | Se emplearán datos específicos de prueba. No <br> obstante, cuando el personal de proveedor deba <br> realizar acciones con datos del cliente, procurará <br> anonimizarlos previamente. <br> Si no fuera posible, se emplearán las mismas <br> medidas de seguridad que en producción y al <br> acabar se emplearán métodos de borrado <br> seguro, conforme a productos certificados. <br> Cuando se deban desinstalar versiones, o se <br> proceda a retirar maquinas incluidas en la <br> solución, se procederá a un borrado seguro y en <br> su caso destrucción certificada con indicación <br> individual del número de serie de los soportes <br> destruidos. | La organización cliente dispondrá de una política <br> de borrado y destrucción conforme <br> a estándares acreditados. <br> El responsable de seguridad de la organización <br> cliente procederá a confirmar el proceso y el <br> producto empleado para borrar o destruir los <br> activos incluidos en la solución implantada, o <br> que la soportan, antes de su retirada. | Se conservarán registros y evidencias del <br> borrado y destrucción seguros. |
| mp.sw.1 <br> Desarrollo | B | M | A | 100% | 0% | El proveedor de la solución emplea una <br> metodología de desarrollo que tiene en cuenta <br> la seguridad. No obstante, en desarrollos a <br> medida se podrá emplear la metodología de la <br> organización cliente. <br> Se dispone de evidencias de control del <br> desarrollo y de la calidad del mismo, así como de | Si la organización cliente dispone de una <br> metodología de desarrollo que tenga en cuenta <br> la seguridad, puede exigirse al proveedor de la <br> solución que los desarrollos a medida se <br> adapten a la misma. <br> La organización cliente requerirá a los <br> proveedores de la solución, habitualmente si es |  |


![Imagen 1 - Página 27](858 DD_assets\pagina27_img1.png)

![Imagen 2 - Página 27](858 DD_assets\pagina27_img2.png)

![Imagen 3 - Página 27](858 DD_assets\pagina27_img3.png)

![Imagen 4 - Página 27](858 DD_assets\pagina27_img4.png)

![Imagen 5 - Página 27](858 DD_assets\pagina27_img5.png)

---

<!-- Página 28 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
los datos de prueba empleados y cuáles de ésta a medida, el cumplimiento de un proceso
dichas pruebas son respecto a la seguridad. de desarrollo en entorno separado al de
Se estará en condiciones de evidenciar la producción.
seguridad del proceso mediante diagramas u
otros elementos en la Guía de instalación o
demás documentación de la solución.
La solución final implantada incluye requisitos
de seguridad y, en concreto, elementos de
identificación y autenticación, así como de
protección de la información que trate.
La solución implantada incluye registro de pistas
de auditoria.
El proveedor de la solución realiza análisis de La organización cliente requerirá al proveedor
vulnerabilidades y pruebas de penetración de la de la solución evidencias de la realización de
misma periódicamente, especialmente si se ha análisis de vulnerabilidades.
modificado la versión de la solución de forma Para categoría media, la organización cliente
relevante. realizará pruebas de penetración antes de la
Todo desarrollo para la solución, incluidas sus puesta en producción de la solución implantada.
mp.sw.2 sucesivas versiones, evoluciones o parches, Para categoría alta se realizará un análisis de
Aceptación y B M A 70% 30% deberán haber sido comprobados antes de su coherencia en la integración de la solución
puesta en servicio lanzamiento con respecto a los requerimientos implantada con los sistemas existentes.
de seguridad en un entorno aislado y sin datos
reales.
El proveedor de la solución dará soporte a la
organización cliente, si es requerido, con
respecto a las pruebas de preproducción para
evitar el deterioro de la seguridad.
El proveedor cumple con la legislación aplicable La organización cliente incluirá requerimientos Si el proveedor actúa como Encargado de
en materia de protección de datos. de protección de datos en sus sistemas y para Tratamiento, el reparto de responsabilidades
El proveedor colaborará con el Delegado de las soluciones externas que se contraten. se regirá por las exigencias de la legislación
Protección de Datos (DPD) de la organización Dispondrá de un DPD que supervisará el impacto en materia de Protección de Datos
mp.info.1
TODAS *Sí Sí cliente, para evidenciar el nivel de cumplimiento o el riesgo que tiene la solución en el ámbito de (RGPD+LOPDGDD).
de la solución a la normativa. la privacidad. Si lo estima necesario solicitará la En caso contrario, la responsabilidad será
El proceso de desarrollo de la solución realización de una EIPD. 100% del cliente.
considerara la privacidad por defecto (PbD). Contemplará la gestión del riesgo, incluyendo la
privacidad, en la organización.
El proveedor de la solución mantendrá su propia Deberá disponerse en la organización cliente de
política de calificación. La certificación del una política de calificación de la información.
mp.info.2 sistema de desarrollo, mantenimiento y soporte Los activos de información deberán estar
Calificación de la B M A 0% 100% de la solución respecto al ENS, por parte del inventariados.
información proveedor, determina el nivel de los servicios y
datos a tratar por la solución una vez implantada
en la organización cliente.
Centro Criptológico Nacional 28

|  |  |  |  |  |  | los datos de prueba empleados y cuáles de <br> dichas pruebas son respecto a la seguridad. <br> Se estará en condiciones de evidenciar la <br> seguridad del proceso mediante diagramas u <br> otros elementos en la Guía de instalación o <br> demás documentación de la solución. <br> La solución final implantada incluye requisitos <br> de seguridad y, en concreto, elementos de <br> identificación y autenticación, así como de <br> protección de la información que trate. <br> La solución implantada incluye registro de pistas <br> de auditoria. | ésta a medida, el cumplimiento de un proceso <br> de desarrollo en entorno separado al de <br> producción. |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| mp.sw.2 <br> Aceptación y <br> puesta en servicio | B | M | A | 70% | 30% | El proveedor de la solución realiza análisis de <br> vulnerabilidades y pruebas de penetración de la <br> misma periódicamente, especialmente si se ha <br> modificado la versión de la solución de forma <br> relevante. <br> Todo desarrollo para la solución, incluidas sus <br> sucesivas versiones, evoluciones o parches, <br> deberán haber sido comprobados antes de su <br> lanzamiento con respecto a los requerimientos <br> de seguridad en un entorno aislado y sin datos <br> reales. <br> El proveedor de la solución dará soporte a la <br> organización cliente, si es requerido, con <br> respecto a las pruebas de preproducción para <br> evitar el deterioro de la seguridad. | La organización cliente requerirá al proveedor <br> de la solución evidencias de la realización de <br> análisis de vulnerabilidades. <br> Para categoría media, la organización cliente <br> realizará pruebas de penetración antes de la <br> puesta en producción de la solución implantada. <br> Para categoría alta se realizará un análisis de <br> coherencia en la integración de la solución <br> implantada con los sistemas existentes. |  |
| mp.info.1 | TODAS |  |  | *Sí | Sí | El proveedor cumple con la legislación aplicable <br> en materia de protección de datos. <br> El proveedor colaborará con el Delegado de <br> Protección de Datos (DPD) de la organización <br> cliente, para evidenciar el nivel de cumplimiento <br> de la solución a la normativa. <br> El proceso de desarrollo de la solución <br> considerara la privacidad por defecto (PbD). | La organización cliente incluirá requerimientos <br> de protección de datos en sus sistemas y para <br> las soluciones externas que se contraten. <br> Dispondrá de un DPD que supervisará el impacto <br> o el riesgo que tiene la solución en el ámbito de <br> la privacidad. Si lo estima necesario solicitará la <br> realización de una EIPD. <br> Contemplará la gestión del riesgo, incluyendo la <br> privacidad, en la organización. | Si el proveedor actúa como Encargado de <br> Tratamiento, el reparto de responsabilidades <br> se regirá por las exigencias de la legislación <br> en materia de Protección de Datos <br> (RGPD+LOPDGDD). <br> En caso contrario, la responsabilidad será <br> 100% del cliente. |
| mp.info.2 <br> Calificación de la <br> información | B | M | A | 0% | 100% | El proveedor de la solución mantendrá su propia <br> política de calificación. La certificación del <br> sistema de desarrollo, mantenimiento y soporte <br> de la solución respecto al ENS, por parte del <br> proveedor, determina el nivel de los servicios y <br> datos a tratar por la solución una vez implantada <br> en la organización cliente. | Deberá disponerse en la organización cliente de <br> una política de calificación de la información. <br> Los activos de información deberán estar <br> inventariados. |  |


![Imagen 1 - Página 28](858 DD_assets\pagina28_img1.png)

![Imagen 2 - Página 28](858 DD_assets\pagina28_img2.png)

![Imagen 3 - Página 28](858 DD_assets\pagina28_img3.png)

![Imagen 4 - Página 28](858 DD_assets\pagina28_img4.png)

![Imagen 5 - Página 28](858 DD_assets\pagina28_img5.png)

---

<!-- Página 29 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
No aplica. No obstante, el proveedor podría Para categoría alta, la información con un nivel
incorporar mecanismos de cifrado a la solución alto en confidencialidad se cifrará tanto durante
implantada. su almacenamiento como durante su
mp.info.3
B M A 0% 100% transmisión. Se emplearán sistemas de cifrado
Cifrado
en las cabinas de discos si la solución implantada
no incorpora mecanismos de cifrado por
software.
La solución implantada, de ser necesario, Existirá una política de firma electrónica. La firma electrónica es un servicio externo a
permitirá el empleo o la integración con otros Para categoría media, se verificará que la cualquier sistema on-premise, por lo que la
servicios susceptibles de emplear firmas solución implantada emplee sistemas de firma máxima responsabilidad recae sobre el
electrónicas ya sea para autenticación o para electrónica avanzada, basados en certificados cliente. El proveedor únicamente deberá
mp.info.4 asegurar la integridad de la información cualificados. garantizar la integración.
B M A 10% 90%
Firma electrónica gestionada. Se gestionarán los certificados, incluyendo el
proveedor, las fechas de caducidad y las
direcciones para el correo electrónico de aviso
de renovación, a ser posible de forma
centralizada.
Para categoría alta, de ser necesario por aplicar Si es de aplicación, e tendrán en cuenta los sellos El sellado de tiempo, por sus propias
este control, la solución implantada se basa en de tiempo en la política de firma electrónica. características, es una función externa a
mp.info.5 sellos de tiempo electrónicos cualificados. Para categoría alta, de ser necesario, la solución cualquier sistema on-premise, por lo que la
B M A 10% 90%
Sellos de tiempo implantada se basará en sellos de tiempo máxima responsabilidad recae sobre el
electrónicos cualificados. cliente. El proveedor únicamente deberá
Se gestionarán los sellos de tiempo. garantizar la integración.
Este control puede ser cubierto por Se dispondrá de normativa referida al borrado Los datos tratados son del cliente, por lo que
procedimientos y herramientas del cliente. No de metadatos. la máxima responsabilidad recae sobre él. El
obstante, podría dotarse a la solución de Pueden implantarse soluciones internas, proveedor deberá garantizar que ha
mecanismos de control y borrado de automáticas, o procedimientos manuales, que suministrado las herramientas necesarias
mp.info.6
determinados metadatos en los documentos complementen a las prestaciones de la solución para que pueda llevarse a cabo.
Limpieza de TODAS 10% 90%
generados y/o almacenados. implantada.
documentos
Debe recordarse que, en base al ENI, ciertos
metadatos son requeridos a efectos de
interoperabilidad, por lo que no siempre es
aconsejable una eliminación indiscriminada.
El proveedor de la solución realizará La organización cliente dispondrá de un
recomendaciones respecto a las copias de procedimiento de copias en el que se
seguridad de la solución en la Guía de configurarán las copias conforme a los RPO
instalación. declarados en el BIA y siguiendo las
mp.info.9
recomendaciones del proveedor de la solución.
Copias de TODAS 10% 90%
El proceso de copias debe incluir la información,
seguridad
aplicaciones, datos de configuración, etc. de la
solución implantada.
La organización cliente debe ser capaz de
realizar una restauración completa en caso de
Centro Criptológico Nacional 29

| mp.info.3 <br> Cifrado | B | M | A | 0% | 100% | No aplica. No obstante, el proveedor podría <br> incorporar mecanismos de cifrado a la solución <br> implantada. | Para categoría alta, la información con un nivel <br> alto en confidencialidad se cifrará tanto durante <br> su almacenamiento como durante su <br> transmisión. Se emplearán sistemas de cifrado <br> en las cabinas de discos si la solución implantada <br> no incorpora mecanismos de cifrado por <br> software. |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| mp.info.4 <br> Firma electrónica | B | M | A | 10% | 90% | La solución implantada, de ser necesario, <br> permitirá el empleo o la integración con otros <br> servicios susceptibles de emplear firmas <br> electrónicas ya sea para autenticación o para <br> asegurar la integridad de la información <br> gestionada. | Existirá una política de firma electrónica. <br> Para categoría media, se verificará que la <br> solución implantada emplee sistemas de firma <br> electrónica avanzada, basados en certificados <br> cualificados. <br> Se gestionarán los certificados, incluyendo el <br> proveedor, las fechas de caducidad y las <br> direcciones para el correo electrónico de aviso <br> de renovación, a ser posible de forma <br> centralizada. | La firma electrónica es un servicio externo a <br> cualquier sistema on-premise, por lo que la <br> máxima responsabilidad recae sobre el <br> cliente. El proveedor únicamente deberá <br> garantizar la integración. |
| mp.info.5 <br> Sellos de tiempo | B | M | A | 10% | 90% | Para categoría alta, de ser necesario por aplicar <br> este control, la solución implantada se basa en <br> sellos de tiempo electrónicos cualificados. | Si es de aplicación, e tendrán en cuenta los sellos <br> de tiempo en la política de firma electrónica. <br> Para categoría alta, de ser necesario, la solución <br> implantada se basará en sellos de tiempo <br> electrónicos cualificados. <br> Se gestionarán los sellos de tiempo. | El sellado de tiempo, por sus propias <br> características, es una función externa a <br> cualquier sistema on-premise, por lo que la <br> máxima responsabilidad recae sobre el <br> cliente. El proveedor únicamente deberá <br> garantizar la integración. |
| mp.info.6 <br> Limpieza de <br> documentos | TODAS |  |  | 10% | 90% | Este control puede ser cubierto por <br> procedimientos y herramientas del cliente. No <br> obstante, podría dotarse a la solución de <br> mecanismos de control y borrado de <br> determinados metadatos en los documentos <br> generados y/o almacenados. | Se dispondrá de normativa referida al borrado <br> de metadatos. <br> Pueden implantarse soluciones internas, <br> automáticas, o procedimientos manuales, que <br> complementen a las prestaciones de la solución <br> implantada. <br> Debe recordarse que, en base al ENI, ciertos <br> metadatos son requeridos a efectos de <br> interoperabilidad, por lo que no siempre es <br> aconsejable una eliminación indiscriminada. | Los datos tratados son del cliente, por lo que <br> la máxima responsabilidad recae sobre él. El <br> proveedor deberá garantizar que ha <br> suministrado las herramientas necesarias <br> para que pueda llevarse a cabo. |
| mp.info.9 <br> Copias de <br> seguridad | TODAS |  |  | 10% | 90% | El proveedor de la solución realizará <br> recomendaciones respecto a las copias de <br> seguridad de la solución en la Guía de <br> instalación. | La organización cliente dispondrá de un <br> procedimiento de copias en el que se <br> configurarán las copias conforme a los RPO <br> declarados en el BIA y siguiendo las <br> recomendaciones del proveedor de la solución. <br> El proceso de copias debe incluir la información, <br> aplicaciones, datos de configuración, etc. de la <br> solución implantada. <br> La organización cliente debe ser capaz de <br> realizar una restauración completa en caso de |  |


![Imagen 1 - Página 29](858 DD_assets\pagina29_img1.png)

![Imagen 2 - Página 29](858 DD_assets\pagina29_img2.png)

![Imagen 3 - Página 29](858 DD_assets\pagina29_img3.png)

![Imagen 4 - Página 29](858 DD_assets\pagina29_img4.png)

![Imagen 5 - Página 29](858 DD_assets\pagina29_img5.png)

---

<!-- Página 30 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
evento disruptivo, con la ayuda del proveedor
de la solución de ser necesario.
Se deben planificar restauraciones de prueba, en
periodos adecuados, que permitan acreditar la
integridad de las copias y del proceso.
Cuando una de las funcionalidades de la solución Debe existir en la organización cliente una
implantada sea el envío de notificaciones política de correo electrónico y procedimientos
mediante correo electrónico, se dispondrá de un de seguridad que incluyan los principales
registro de actividades completo que incluya los problemas de seguridad que suele tener
correos electrónicos enviados. asociados: cifrado de adjuntos sensibles,
Se valorará la posibilidad de incluir limitaciones de uso, etc., así como mecanismos
funcionalidades antispam en relación al envío de de seguridad: antivirus en relación a correos
correos electrónicos automáticos desde la entrantes y salientes y antispam. También se
mp.s.1
solución, en base a permitir configurar: articulará la concienciación del usuario.
Protección del TODAS 50% 50%
 Número de correos enviados por minuto. Si la solución implantada no dispone de un
correo electrónico
 Número de destinatarios que se pueden servidor de correo electrónico propio, sino que
asignar en un solo correo. se integra con el servidor de correo corporativo
 Tamaño máximo del contenido del correo. de la organización cliente a través del protocolo
 Establecer las posibles acciones a realizar si SMTP, será este servidor el que se encargue de
se intenta sobrepasar los parámetros realizar la gestión requerida y deberá
definidos, como cancelar el envío y enviar supervisarse.
una notificación al usuario y/o al
administrador.
A nivel del desarrollo de la solución, el La organización cliente debe gestionar la
proveedor ha tenido en cuenta la prevención de seguridad en los servicios publicados mediante
manipulación de URL, prevención de ataques de la solución implantada, incluyendo análisis de
inyección de código, prevención de intentos de seguridad o hacking ético al menos una vez año.
escalado de privilegios, de ataques "Cross site Se externalizan a terceros para lograr una
scripting", de ataques de manipulación de separación entre quién gestiona y quién realiza
programas o dispositivos o de sistemas de las pruebas de penetración.
almacenamiento, ya sea a nivel de las diferentes Debe establecer una norma relacionada con las
mp.s.2 fases de desarrollo o bien en el propio ciclo de medidas de seguridad de los servidores y de la
Protección de vida del producto una vez en producción. seguridad de las aplicaciones. Puede derivarse
B M A 50% 50%
servicios y El proveedor establece auditorias de seguridad o parte de la seguridad de los entornos publicados
aplicaciones Web hacking en sus productos para detectar mediante Web Applications Firewall (WAF).
vulnerabilidades, inicialmente y a cada nueva Todas las aplicaciones web de la solución son
versión con cambios significativos. comprobadas antes de ser puestas en
Se tienen en cuenta reglas que limiten el producción y se verifica que se cumplen los
número de sesiones, tiempos de sesión o criterios de aceptación en materia de seguridad
volumen de datos transferidos. y no se deteriora la seguridad de otros
Se siguen por defecto las recomendaciones componentes del sistema, comprobándose las
Owasp para el desarrollo y se consideran las posibles vulnerabilidades según los principales
principales vulnerabilidades declaradas por el estándares del sector.
Centro Criptológico Nacional 30

|  |  |  |  |  |  |  | evento disruptivo, con la ayuda del proveedor <br> de la solución de ser necesario. <br> Se deben planificar restauraciones de prueba, en <br> periodos adecuados, que permitan acreditar la <br> integridad de las copias y del proceso. |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| mp.s.1 <br> Protección del <br> correo electrónico | TODAS |  |  | 50% | 50% | Cuando una de las funcionalidades de la solución <br> implantada sea el envío de notificaciones <br> mediante correo electrónico, se dispondrá de un <br> registro de actividades completo que incluya los <br> correos electrónicos enviados. <br> Se valorará la posibilidad de incluir <br> funcionalidades antispam en relación al envío de <br> correos electrónicos automáticos desde la <br> solución, en base a permitir configurar: <br>  Número de correos enviados por minuto. <br>  Número de destinatarios que se pueden <br> asignar en un solo correo. <br>  Tamaño máximo del contenido del correo. <br>  Establecer las posibles acciones a realizar si <br> se intenta sobrepasar los parámetros <br> definidos, como cancelar el envío y enviar <br> una notificación al usuario y/o al <br> administrador. | Debe existir en la organización cliente una <br> política de correo electrónico y procedimientos <br> de seguridad que incluyan los principales <br> problemas de seguridad que suele tener <br> asociados: cifrado de adjuntos sensibles, <br> limitaciones de uso, etc., así como mecanismos <br> de seguridad: antivirus en relación a correos <br> entrantes y salientes y antispam. También se <br> articulará la concienciación del usuario. <br> Si la solución implantada no dispone de un <br> servidor de correo electrónico propio, sino que <br> se integra con el servidor de correo corporativo <br> de la organización cliente a través del protocolo <br> SMTP, será este servidor el que se encargue de <br> realizar la gestión requerida y deberá <br> supervisarse. |  |
| mp.s.2 <br> Protección de <br> servicios y <br> aplicaciones Web | B | M | A | 50% | 50% | A nivel del desarrollo de la solución, el <br> proveedor ha tenido en cuenta la prevención de <br> manipulación de URL, prevención de ataques de <br> inyección de código, prevención de intentos de <br> escalado de privilegios, de ataques "Cross site <br> scripting", de ataques de manipulación de <br> programas o dispositivos o de sistemas de <br> almacenamiento, ya sea a nivel de las diferentes <br> fases de desarrollo o bien en el propio ciclo de <br> vida del producto una vez en producción. <br> El proveedor establece auditorias de seguridad o <br> hacking en sus productos para detectar <br> vulnerabilidades, inicialmente y a cada nueva <br> versión con cambios significativos. <br> Se tienen en cuenta reglas que limiten el <br> número de sesiones, tiempos de sesión o <br> volumen de datos transferidos. <br> Se siguen por defecto las recomendaciones <br> Owasp para el desarrollo y se consideran las <br> principales vulnerabilidades declaradas por el | La organización cliente debe gestionar la <br> seguridad en los servicios publicados mediante <br> la solución implantada, incluyendo análisis de <br> seguridad o hacking ético al menos una vez año. <br> Se externalizan a terceros para lograr una <br> separación entre quién gestiona y quién realiza <br> las pruebas de penetración. <br> Debe establecer una norma relacionada con las <br> medidas de seguridad de los servidores y de la <br> seguridad de las aplicaciones. Puede derivarse <br> parte de la seguridad de los entornos publicados <br> mediante Web Applications Firewall (WAF). <br> Todas las aplicaciones web de la solución son <br> comprobadas antes de ser puestas en <br> producción y se verifica que se cumplen los <br> criterios de aceptación en materia de seguridad <br> y no se deteriora la seguridad de otros <br> componentes del sistema, comprobándose las <br> posibles vulnerabilidades según los principales <br> estándares del sector. |  |


![Imagen 1 - Página 30](858 DD_assets\pagina30_img1.png)

![Imagen 2 - Página 30](858 DD_assets\pagina30_img2.png)

![Imagen 3 - Página 30](858 DD_assets\pagina30_img3.png)

![Imagen 4 - Página 30](858 DD_assets\pagina30_img4.png)

![Imagen 5 - Página 30](858 DD_assets\pagina30_img5.png)

---

<!-- Página 31 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
sector, habiéndose realizado un análisis de
riesgos que se expone en la Guía de relación
entre proveedor y cliente (Ver anexo II de ésta
guía).
El proveedor ha dotado a la solución de Se dispondrá de soluciones anti-DoS, ya sea
funcionalidades mínimas para controlar: implementadas como funcionalidades en el FW,
 Sesiones internas (concurrentes, abiertas). mediante dispositivos especializados, o
 Acciones fuera de los parámetros de contratando servicios específicos al proveedor
seguridad interna del cliente (cancelar, de comunicaciones.
mp.s.8
bloquear, generar notificaciones y Se dimensionará el sistema con holgura,
Protección frente
B M A 20% 80% registros). respecto a las tablas de dimensionamiento que
a la denegación
proporciona el proveedor en la Guía de
de servicio
instalación.
Para categoría alta se establecerán
procedimientos de reacción a los ataques, que
incluyan comunicación con el proveedor de
comunicaciones.
No aplica. Para categoría alta se garantizará la existencia y
disponibilidad de medios alternativos para
mp.s.9 prestar los servicios que presta la solución
Medios B M A 0% 100% implantada, en el caso de que fallen los medios
alternativos habituales. Estos medios alternativos estarán
sujetos a las mismas garantías de protección que
los medios habituales.
Centro Criptológico Nacional 31

|  |  |  |  |  |  | sector, habiéndose realizado un análisis de <br> riesgos que se expone en la Guía de relación <br> entre proveedor y cliente (Ver anexo II de ésta <br> guía). |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| mp.s.8 <br> Protección frente <br> a la denegación <br> de servicio | B | M | A | 20% | 80% | El proveedor ha dotado a la solución de <br> funcionalidades mínimas para controlar: <br>  Sesiones internas (concurrentes, abiertas). <br>  Acciones fuera de los parámetros de <br> seguridad interna del cliente (cancelar, <br> bloquear, generar notificaciones y <br> registros). | Se dispondrá de soluciones anti-DoS, ya sea <br> implementadas como funcionalidades en el FW, <br> mediante dispositivos especializados, o <br> contratando servicios específicos al proveedor <br> de comunicaciones. <br> Se dimensionará el sistema con holgura, <br> respecto a las tablas de dimensionamiento que <br> proporciona el proveedor en la Guía de <br> instalación. <br> Para categoría alta se establecerán <br> procedimientos de reacción a los ataques, que <br> incluyan comunicación con el proveedor de <br> comunicaciones. |  |
| mp.s.9 <br> Medios <br> alternativos | B | M | A | 0% | 100% | No aplica. | Para categoría alta se garantizará la existencia y <br> disponibilidad de medios alternativos para <br> prestar los servicios que presta la solución <br> implantada, en el caso de que fallen los medios <br> habituales. Estos medios alternativos estarán <br> sujetos a las mismas garantías de protección que <br> los medios habituales. |  |


![Imagen 1 - Página 31](858 DD_assets\pagina31_img1.png)

![Imagen 2 - Página 31](858 DD_assets\pagina31_img2.png)

![Imagen 3 - Página 31](858 DD_assets\pagina31_img3.png)

![Imagen 4 - Página 31](858 DD_assets\pagina31_img4.png)

![Imagen 5 - Página 31](858 DD_assets\pagina31_img5.png)

---

<!-- Página 32 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
ANEXO II (Ejemplo para confeccionar el análisis de riesgos de la solución implantada)
NOTA: Se recuerda que el valor del riesgo puede calcularse en función de la probabilidad de que se materialicen los riesgos identificados
(amenazas) y de su consecuencia (impacto). En esta tabla únicamente se identifican algunos riesgos basados en el TOP 10 de OWASP y algunos
otros, y se plasman posibles acciones de mitigación por parte del proveedor (desarrollador) y del cliente que contrata la solución.
Se recomienda al proveedor que personalice las acciones de mitigación, así como los riesgos identificados, para que abarquen al conjunto de la
solución implantada y su integración con la infraestructura de la organización cliente.
Identificación de Riesgos
Consecuencia Posible acción de mitigación del proveedor Posible acción de mitigación de la
Riesgo Descripción del riesgo
(impacto) (desarrollador) organización cliente
Las fallas de inyección ocurren cuando un Pérdida o corrupción de datos, pérdida Estas fallas son fáciles de descubrir al examinar el No aplica.
atacante puede enviar información no de privilegios o negación de acceso. código, pero difíciles de descubrir por medio de
confiable a un intérprete de comandos. Algunas veces, una inyección puede pruebas. En consecuencia, se recomienda que el
Estas fallas son muy comunes, llevar al compromiso total del servidor. desarrollador incorpore a su metodología análisis de
particularmente en el código antiguo. código fuente.
Casi cualquier fuente de datos puede ser A nivel de desarrollo, la prevención de la inyección
un vector de ataque de inyección: requiere mantener los datos separados de los
OWASP A1: variables de entorno, parámetros, comandos y consultas.
Inyección servicios web externos e internos y todo Utilice la validación de entrada positiva o "lista blanca"
tipo de usuarios. Las vulnerabilidades de en el lado del servidor. Esto no proporciona una
inyección a menudo se presentan en protección completa ya que muchas aplicaciones
consultas SQL, LDAP, XPath o NoSQL, requieren caracteres especiales, como áreas de texto o
comandos del sistema operativo, API para aplicaciones móviles.
analizadores XML, encabezados SMTP, Use LIMIT y otros controles SQL dentro de las consultas
etc. para evitar la divulgación masiva de registros en caso
de inyección SQL.
Ocurre cuando un atacante es capaz de Los atacantes únicamente tienen que Prever doble factor de autenticación. Establecer una robusta política de
asumir la identidad de un usuario, obtener acceso a unas pocas cuentas, o Los ID de sesión no deben estar en la URL, deben contraseñas.
comprometiendo así el acceso a las solo a una cuenta con derechos de almacenarse de forma segura e invalidarse después de Emplear doble factor de autenticación.
credenciales o tokens del mismo. administrador, para estar en cerrar sesión, período de inactividad o tiempos
OWASP A2: Ruptura Los atacantes tienen acceso a cientos de condiciones de comprometer el máximos de vida.
de la autenticación millones de combinaciones válidas de sistema. Dependiendo del dominio de la
nombre de usuario y contraseña para solución, puede tener importantes
rellenar credenciales, disponen de listas consecuencias.
de cuentas administrativas
predeterminadas, pueden intentar
Centro Criptológico Nacional 32

| Identificación de Riesgos |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Riesgo | Descripción del riesgo |  | Consecuencia |  |  | Posible acción de mitigación del proveedor |  |  | Posible acción de mitigación de la |  |
|  |  |  | (impacto) |  |  | (desarrollador) |  |  | organización cliente |  |
| OWASP A1: <br> Inyección | Las fallas de inyección ocurren cuando un <br> atacante puede enviar información no <br> confiable a un intérprete de comandos. <br> Estas fallas son muy comunes, <br> particularmente en el código antiguo. <br> Casi cualquier fuente de datos puede ser <br> un vector de ataque de inyección: <br> variables de entorno, parámetros, <br> servicios web externos e internos y todo <br> tipo de usuarios. Las vulnerabilidades de <br> inyección a menudo se presentan en <br> consultas SQL, LDAP, XPath o NoSQL, <br> comandos del sistema operativo, <br> analizadores XML, encabezados SMTP, <br> etc. | Pérdida o corrupción de datos, pérdida <br> de privilegios o negación de acceso. <br> Algunas veces, una inyección puede <br> llevar al compromiso total del servidor. |  |  | Estas fallas son fáciles de descubrir al examinar el <br> código, pero difíciles de descubrir por medio de <br> pruebas. En consecuencia, se recomienda que el <br> desarrollador incorpore a su metodología análisis de <br> código fuente. <br> A nivel de desarrollo, la prevención de la inyección <br> requiere mantener los datos separados de los <br> comandos y consultas. <br> Utilice la validación de entrada positiva o "lista blanca" <br> en el lado del servidor. Esto no proporciona una <br> protección completa ya que muchas aplicaciones <br> requieren caracteres especiales, como áreas de texto o <br> API para aplicaciones móviles. <br> Use LIMIT y otros controles SQL dentro de las consultas <br> para evitar la divulgación masiva de registros en caso <br> de inyección SQL. |  |  | No aplica. |  |  |
| OWASP A2: Ruptura <br> de la autenticación | Ocurre cuando un atacante es capaz de <br> asumir la identidad de un usuario, <br> comprometiendo así el acceso a las <br> credenciales o tokens del mismo. <br> Los atacantes tienen acceso a cientos de <br> millones de combinaciones válidas de <br> nombre de usuario y contraseña para <br> rellenar credenciales, disponen de listas <br> de cuentas administrativas <br> predeterminadas, pueden intentar | Los atacantes únicamente tienen que <br> obtener acceso a unas pocas cuentas, o <br> solo a una cuenta con derechos de <br> administrador, para estar en <br> condiciones de comprometer el <br> sistema. Dependiendo del dominio de la <br> solución, puede tener importantes <br> consecuencias. |  |  | Prever doble factor de autenticación. <br> Los ID de sesión no deben estar en la URL, deben <br> almacenarse de forma segura e invalidarse después de <br> cerrar sesión, período de inactividad o tiempos <br> máximos de vida. |  |  | Establecer una robusta política de <br> contraseñas. <br> Emplear doble factor de autenticación. |  |  |


![Imagen 1 - Página 32](858 DD_assets\pagina32_img1.png)

![Imagen 2 - Página 32](858 DD_assets\pagina32_img2.png)

![Imagen 3 - Página 32](858 DD_assets\pagina32_img3.png)

![Imagen 4 - Página 32](858 DD_assets\pagina32_img4.png)

![Imagen 5 - Página 32](858 DD_assets\pagina32_img5.png)

---

<!-- Página 33 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
ataques de fuerza bruta automatizada o
mediante herramientas de ataque de
diccionario. Los ataques de
administración de sesión se entienden
bien, particularmente si localizan tokens
de sesión no vencidos.
En lugar de atacar directamente a la La vulnerabilidad con frecuencia Emplear una gestión de claves adecuada, almacenando Disponer de una política de calificación de la
criptografía, el vector de ataque consiste compromete la totalidad de los datos las contraseñas utilizando funciones de hash robustas y información.
en que los atacantes roban claves, que deberían haber sido protegidos. adaptativas. Clasificar los datos procesados, almacenados
ejecutan ataques tipo “man-in-the- Por lo general, esta información puede Deshabilitar el almacenamiento en caché para las o transmitidos por la solución implantada en
middle” o roban datos de texto sin cifrar incluir datos de información respuestas de las aplicaciones respecto a presentar base a dicha política. De ellos identifique las
del servidor mientras están en tránsito o identificativa personal (PII) que a consultas de la base de datos que contengan datos categorías especiales de datos según el RGPD.
en la aplicación cliente del usuario como menudo requieren protección según lo confidenciales. Aplicar controles o medidas de seguridad
OWASP A3: puede ser un navegador. Generalmente definido por el RGPD y demás según dicha clasificación.
Exposición de datos se requiere un ataque manual. Las bases legislación aplicable en materia de Cifrar todos los datos confidenciales en
sensibles de datos de contraseñas de las que los protección de datos. tránsito y también en reposo para categoría
atacantes se hayan podido apropiar alta del sistema. En ese caso, asegúrese de
podrían ser objeto de ataques de fuerza contar con algoritmos, protocolos y claves
bruta con ayuda de las unidades de estándar fuertes y actualizados.
procesamiento de gráficos (GPU). Verificar de forma independiente la
efectividad de la parametrización y la
configuración de seguridad en general de la
solución implantada.
Los atacantes pueden explotar los Estas vulnerabilidades se pueden usar Siempre que sea posible, deben emplearse formatos Puede considerarse el uso de firewalls de
procesadores XML vulnerables (antiguos para extraer datos, ejecutar una de datos poco complejos, evitando grandes series de aplicaciones web (WAF) para detectar,
o mal configurados) si pueden cargar XML solicitud remota desde el servidor, datos confidenciales. monitorear y bloquear ataques XXE.
o incluir contenido hostil en un escanear sistemas internos, realizar un Se deben parchear o actualizar todos los procesadores
documento XML, explotando código ataque de denegación de servicio, etc. XML y bibliotecas en uso por las aplicaciones o en el
vulnerable, dependencias o sistema operativo subyacente.
integraciones. Deshabilitar la entidad externa XML y el procesamiento
de DTD en todos los analizadores XML de la aplicación,
según la hoja de OWASP "Prevención XXE", por
OWASP A4:
ejemplo.
Entidades externas
Implemente la validación positiva “lista blanca”, el
XML (XXE)
filtrado o la desinfección de entrada en el lado del
servidor para evitar datos hostiles dentro de los
documentos, encabezados o nodos XML.
Verifique que la funcionalidad de carga de archivos
XML o XSL valida el XML entrante mediante la
validación XSD o similar.
Durante el desarrollo, la revisión manual del código
fuente es la mejor alternativa en aplicaciones grandes y
complejas con muchas integraciones.
Centro Criptológico Nacional 33

|  | ataques de fuerza bruta automatizada o <br> mediante herramientas de ataque de <br> diccionario. Los ataques de <br> administración de sesión se entienden <br> bien, particularmente si localizan tokens <br> de sesión no vencidos. |  |  |  |
| --- | --- | --- | --- | --- |
| OWASP A3: <br> Exposición de datos <br> sensibles | En lugar de atacar directamente a la <br> criptografía, el vector de ataque consiste <br> en que los atacantes roban claves, <br> ejecutan ataques tipo “man-in-the- <br> middle” o roban datos de texto sin cifrar <br> del servidor mientras están en tránsito o <br> en la aplicación cliente del usuario como <br> puede ser un navegador. Generalmente <br> se requiere un ataque manual. Las bases <br> de datos de contraseñas de las que los <br> atacantes se hayan podido apropiar <br> podrían ser objeto de ataques de fuerza <br> bruta con ayuda de las unidades de <br> procesamiento de gráficos (GPU). | La vulnerabilidad con frecuencia <br> compromete la totalidad de los datos <br> que deberían haber sido protegidos. <br> Por lo general, esta información puede <br> incluir datos de información <br> identificativa personal (PII) que a <br> menudo requieren protección según lo <br> definido por el RGPD y demás <br> legislación aplicable en materia de <br> protección de datos. | Emplear una gestión de claves adecuada, almacenando <br> las contraseñas utilizando funciones de hash robustas y <br> adaptativas. <br> Deshabilitar el almacenamiento en caché para las <br> respuestas de las aplicaciones respecto a presentar <br> consultas de la base de datos que contengan datos <br> confidenciales. | Disponer de una política de calificación de la <br> información. <br> Clasificar los datos procesados, almacenados <br> o transmitidos por la solución implantada en <br> base a dicha política. De ellos identifique las <br> categorías especiales de datos según el RGPD. <br> Aplicar controles o medidas de seguridad <br> según dicha clasificación. <br> Cifrar todos los datos confidenciales en <br> tránsito y también en reposo para categoría <br> alta del sistema. En ese caso, asegúrese de <br> contar con algoritmos, protocolos y claves <br> estándar fuertes y actualizados. <br> Verificar de forma independiente la <br> efectividad de la parametrización y la <br> configuración de seguridad en general de la <br> solución implantada. |
| OWASP A4: <br> Entidades externas <br> XML (XXE) | Los atacantes pueden explotar los <br> procesadores XML vulnerables (antiguos <br> o mal configurados) si pueden cargar XML <br> o incluir contenido hostil en un <br> documento XML, explotando código <br> vulnerable, dependencias o <br> integraciones. | Estas vulnerabilidades se pueden usar <br> para extraer datos, ejecutar una <br> solicitud remota desde el servidor, <br> escanear sistemas internos, realizar un <br> ataque de denegación de servicio, etc. | Siempre que sea posible, deben emplearse formatos <br> de datos poco complejos, evitando grandes series de <br> datos confidenciales. <br> Se deben parchear o actualizar todos los procesadores <br> XML y bibliotecas en uso por las aplicaciones o en el <br> sistema operativo subyacente. <br> Deshabilitar la entidad externa XML y el procesamiento <br> de DTD en todos los analizadores XML de la aplicación, <br> según la hoja de OWASP "Prevención XXE", por <br> ejemplo. <br> Implemente la validación positiva “lista blanca”, el <br> filtrado o la desinfección de entrada en el lado del <br> servidor para evitar datos hostiles dentro de los <br> documentos, encabezados o nodos XML. <br> Verifique que la funcionalidad de carga de archivos <br> XML o XSL valida el XML entrante mediante la <br> validación XSD o similar. <br> Durante el desarrollo, la revisión manual del código <br> fuente es la mejor alternativa en aplicaciones grandes y <br> complejas con muchas integraciones. | Puede considerarse el uso de firewalls de <br> aplicaciones web (WAF) para detectar, <br> monitorear y bloquear ataques XXE. |


![Imagen 1 - Página 33](858 DD_assets\pagina33_img1.png)

![Imagen 2 - Página 33](858 DD_assets\pagina33_img2.png)

![Imagen 3 - Página 33](858 DD_assets\pagina33_img3.png)

![Imagen 4 - Página 33](858 DD_assets\pagina33_img4.png)

![Imagen 5 - Página 33](858 DD_assets\pagina33_img5.png)

---

<!-- Página 34 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
La explotación del control de acceso es El impacto técnico es que los atacantes El control de acceso solo es efectivo si se aplica en el
una habilidad básica de los vectores de pueden actuar como usuarios o lado del servidor, o en una API del servidor, donde el
ataque. Las herramientas que realizan administradores, o usuarios con atacante no puede modificar la verificación del control
pruebas de seguridad estáticas (SAST) y funciones privilegiadas que crean, de acceso o los metadatos.
dinámicas (DAST) pueden detectar la acceden, actualizan o eliminan Con la excepción de los recursos publicados
ausencia de control de acceso, pero no cualquier registro. abiertamente, denegar por defecto.
pueden verificar si es operativo cuando En desarrollo, implementar mecanismos confiables y
está presente. La eficacia del control de probados de control de acceso una vez y reutilizarlos
acceso únicamente es detectable usando en todas las aplicaciones, incluida la minimización del
medios de prueba manuales. uso de Intercambio de Recursos de Origen Cruzado
(CORS).
Los controles de acceso del modelo deben exigir la
propiedad del registro, en lugar de aceptar que el
usuario puede crear, leer, actualizar o eliminar
OWASP A5: cualquier registro.
Ruptura del control Debe deshabilitarse la lista del directorio del servidor
de acceso web y asegurarse de que los metadatos del archivo
(por ejemplo, .git) y los archivos de respaldo no estén
presentes en las raíces web.
Deben registrarse los errores de autenticación,
alertando a los administradores cuando sea apropiado
(por ejemplo, ante errores repetidos)
Debe limitarse la velocidad de la API y del acceso al
controlador para minimizar el daño de las
herramientas de ataque automatizado.
Los JSON Web Token (JWT) (ver RFC-7519) deben
invalidarse en el servidor después de cerrar la sesión.
Los desarrolladores y/o el personal de control de
calidad deben incluir pruebas de control de acceso
funcional y pruebas de integración de la solución
implantada.
Los atacantes a menudo intentarán Tales vulnerabilidades frecuentemente Los entornos de desarrollo, control de calidad y Un proceso de bastionado sistemático que
explotar fallas no parcheadas o acceder a dan a los atacantes acceso no producción deben configurarse de manera idéntica, facilite la implementación de entornos
cuentas predeterminadas, páginas no autorizado a algunos datos del sistema pero con diferentes credenciales utilizadas en cada protegidos adecuadamente.
utilizadas, archivos y directorios o funcionalidad. Ocasionalmente, entorno. Las plataformas de la solución implantada
OWASP A6: desprotegidos, etc. para obtener acceso o dichas vulnerabilidades resultan en un En relación al desarrollo de la solución, una deben estar minimizadas, sin características,
Configuración conocimiento no autorizado del sistema. compromiso completo del sistema. arquitectura de aplicación segmentada proporciona componentes y documentación innecesarias.
incorrecta de la una separación efectiva y segura entre componentes o Del mismo modo deben eliminarse, o no
seguridad tenants, con segmentación, contenedores o grupos de instalarse, funcionalidades y frameworks no
seguridad en la nube (ACL). utilizados.
Debe disponerse de un procedimiento para
revisar y actualizar las configuraciones
apropiadas conforme a todas las notas de
Centro Criptológico Nacional 34

| OWASP A5: <br> Ruptura del control <br> de acceso | La explotación del control de acceso es <br> una habilidad básica de los vectores de <br> ataque. Las herramientas que realizan <br> pruebas de seguridad estáticas (SAST) y <br> dinámicas (DAST) pueden detectar la <br> ausencia de control de acceso, pero no <br> pueden verificar si es operativo cuando <br> está presente. La eficacia del control de <br> acceso únicamente es detectable usando <br> medios de prueba manuales. | El impacto técnico es que los atacantes <br> pueden actuar como usuarios o <br> administradores, o usuarios con <br> funciones privilegiadas que crean, <br> acceden, actualizan o eliminan <br> cualquier registro. | El control de acceso solo es efectivo si se aplica en el <br> lado del servidor, o en una API del servidor, donde el <br> atacante no puede modificar la verificación del control <br> de acceso o los metadatos. <br> Con la excepción de los recursos publicados <br> abiertamente, denegar por defecto. <br> En desarrollo, implementar mecanismos confiables y <br> probados de control de acceso una vez y reutilizarlos <br> en todas las aplicaciones, incluida la minimización del <br> uso de Intercambio de Recursos de Origen Cruzado <br> (CORS). <br> Los controles de acceso del modelo deben exigir la <br> propiedad del registro, en lugar de aceptar que el <br> usuario puede crear, leer, actualizar o eliminar <br> cualquier registro. <br> Debe deshabilitarse la lista del directorio del servidor <br> web y asegurarse de que los metadatos del archivo <br> (por ejemplo, .git) y los archivos de respaldo no estén <br> presentes en las raíces web. <br> Deben registrarse los errores de autenticación, <br> alertando a los administradores cuando sea apropiado <br> (por ejemplo, ante errores repetidos) <br> Debe limitarse la velocidad de la API y del acceso al <br> controlador para minimizar el daño de las <br> herramientas de ataque automatizado. <br> Los JSON Web Token (JWT) (ver RFC-7519) deben <br> invalidarse en el servidor después de cerrar la sesión. <br> Los desarrolladores y/o el personal de control de <br> calidad deben incluir pruebas de control de acceso <br> funcional y pruebas de integración de la solución <br> implantada. |  |
| --- | --- | --- | --- | --- |
| OWASP A6: <br> Configuración <br> incorrecta de la <br> seguridad | Los atacantes a menudo intentarán <br> explotar fallas no parcheadas o acceder a <br> cuentas predeterminadas, páginas no <br> utilizadas, archivos y directorios <br> desprotegidos, etc. para obtener acceso o <br> conocimiento no autorizado del sistema. | Tales vulnerabilidades frecuentemente <br> dan a los atacantes acceso no <br> autorizado a algunos datos del sistema <br> o funcionalidad. Ocasionalmente, <br> dichas vulnerabilidades resultan en un <br> compromiso completo del sistema. | Los entornos de desarrollo, control de calidad y <br> producción deben configurarse de manera idéntica, <br> pero con diferentes credenciales utilizadas en cada <br> entorno. <br> En relación al desarrollo de la solución, una <br> arquitectura de aplicación segmentada proporciona <br> una separación efectiva y segura entre componentes o <br> tenants, con segmentación, contenedores o grupos de <br> seguridad en la nube (ACL). | Un proceso de bastionado sistemático que <br> facilite la implementación de entornos <br> protegidos adecuadamente. <br> Las plataformas de la solución implantada <br> deben estar minimizadas, sin características, <br> componentes y documentación innecesarias. <br> Del mismo modo deben eliminarse, o no <br> instalarse, funcionalidades y frameworks no <br> utilizados. <br> Debe disponerse de un procedimiento para <br> revisar y actualizar las configuraciones <br> apropiadas conforme a todas las notas de |


![Imagen 1 - Página 34](858 DD_assets\pagina34_img1.png)

![Imagen 2 - Página 34](858 DD_assets\pagina34_img2.png)

![Imagen 3 - Página 34](858 DD_assets\pagina34_img3.png)

![Imagen 4 - Página 34](858 DD_assets\pagina34_img4.png)

![Imagen 5 - Página 34](858 DD_assets\pagina34_img5.png)

---

<!-- Página 35 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
seguridad, actualizaciones y parches, como
parte del proceso de administración de
parches.
Ocurren cuando una aplicación toma El impacto de XSS es moderado para Estas vulnerabilidades son detectadas de forma
datos no confiables y los envía al XSS reflejado y DOM, y severo para XSS relativamente fácil a través de pruebas o por medio de
navegador web sin una validación y almacenado, con ejecución remota de análisis del código.
codificación apropiada. Permite a los código en el navegador de la víctima, lo La prevención de XSS requiere la separación de datos
atacantes ejecutar secuencias de que permite robar credenciales, no confiables del contenido activo del navegador. Esto
comandos en el navegador de la víctima sesiones o entregar malware a la se puede lograr empleando frameworks que escapan
los cuales pueden secuestrar las sesiones víctima. automáticamente a XSS por diseño. Es imperativo
de los usuarios, destruir sitios web o conocer las limitaciones de la protección XSS de cada
dirigir al usuario a un sitio malicioso. framework y maneje adecuadamente los casos de uso
Existen marcos de explotación de estas que no están cubiertos.
vulnerabilidades disponibles de forma Emplear técnicas de escape de datos en las solicitudes
OWASP A7:
gratuita. HTTP no confiables, basadas en el contexto en la salida
Cross-Site Scripting
HTML (cuerpo, atributo, JavaScript, CSS o URL)
(XSS)
resolverán las vulnerabilidades XSS reflejadas y
almacenadas. La hoja de OWASP "Prevención XSS"
tiene detalles sobre las técnicas de escape de datos
necesarias.
La aplicación de codificación sensible al contexto al
modificar el documento del navegador en el lado del
cliente actúa contra DOM XSS. Cuando esto no se
puede evitar, se pueden aplicar técnicas de escape
sensibles al contexto similares a las API del navegador
como se describe en la hoja de OWASP "Prevención
XSS basada en DOM".
Estos defectos ocurren cuando una El impacto de explotar las Implementar verificaciones de integridad tales como Registrar excepciones y errores detectados de
aplicación recibe objetos serializados vulnerabilidades de deserialización firmas digitales en cualquier objeto serializado para deserialización, como cuando el tipo entrante
dañinos y estos objetos pueden ser puede conducir a ataques de repetición, evitar la creación de objetos hostiles o la manipulación no es el tipo esperado, o la deserialización
manipulados o borrados por el atacante inyecciones o elevar sus privilegios de de datos. presenta excepciones. También generar
para realizar ataques. ejecución. En el peor de los casos, la Hacer cumplir estrictas restricciones de tipo durante la alertas si un usuario concreto deserializa
OWASP A8:
deserialización puede conducir a la deserialización, antes de la creación de objetos, ya que constantemente.
Deserialización
ejecución remota de código en el el código generalmente espera un conjunto definible Restringir la conectividad de red entrante y
insegura
servidor. de clases. Se han demostrado derivaciones a esta saliente desde contenedores o servidores que
técnica, por lo que no es aconsejable depender deserializan, monitorizando el proceso.
únicamente de esto.
Aislar y ejecutar código que se desrealiza en entornos
de bajos privilegios cuando es posible.
OWASP A9: El vector de ataque tiene en cuenta que, Algunos componentes tales como Supervisar continuamente las fuentes como CVE y NVD Debe haber un proceso de administración de
Empleo de si bien es fácil encontrar exploits para librerías, frameworks y otros módulos para detectar vulnerabilidades en los componentes. parches para eliminar dependencias no
componentes con muchas vulnerabilidades conocidas, otras de software casi siempre funcionan con Emplear herramientas de análisis de composición de utilizadas, características innecesarias,
vulnerabilidades vulnerabilidades requieren un esfuerzo todos los privilegios. Si e ataca un software para automatizar el proceso. componentes, archivos y documentación.
Centro Criptológico Nacional 35

|  |  |  |  | seguridad, actualizaciones y parches, como <br> parte del proceso de administración de <br> parches. |
| --- | --- | --- | --- | --- |
| OWASP A7: <br> Cross-Site Scripting <br> (XSS) | Ocurren cuando una aplicación toma <br> datos no confiables y los envía al <br> navegador web sin una validación y <br> codificación apropiada. Permite a los <br> atacantes ejecutar secuencias de <br> comandos en el navegador de la víctima <br> los cuales pueden secuestrar las sesiones <br> de los usuarios, destruir sitios web o <br> dirigir al usuario a un sitio malicioso. <br> Existen marcos de explotación de estas <br> vulnerabilidades disponibles de forma <br> gratuita. | El impacto de XSS es moderado para <br> XSS reflejado y DOM, y severo para XSS <br> almacenado, con ejecución remota de <br> código en el navegador de la víctima, lo <br> que permite robar credenciales, <br> sesiones o entregar malware a la <br> víctima. | Estas vulnerabilidades son detectadas de forma <br> relativamente fácil a través de pruebas o por medio de <br> análisis del código. <br> La prevención de XSS requiere la separación de datos <br> no confiables del contenido activo del navegador. Esto <br> se puede lograr empleando frameworks que escapan <br> automáticamente a XSS por diseño. Es imperativo <br> conocer las limitaciones de la protección XSS de cada <br> framework y maneje adecuadamente los casos de uso <br> que no están cubiertos. <br> Emplear técnicas de escape de datos en las solicitudes <br> HTTP no confiables, basadas en el contexto en la salida <br> HTML (cuerpo, atributo, JavaScript, CSS o URL) <br> resolverán las vulnerabilidades XSS reflejadas y <br> almacenadas. La hoja de OWASP "Prevención XSS" <br> tiene detalles sobre las técnicas de escape de datos <br> necesarias. <br> La aplicación de codificación sensible al contexto al <br> modificar el documento del navegador en el lado del <br> cliente actúa contra DOM XSS. Cuando esto no se <br> puede evitar, se pueden aplicar técnicas de escape <br> sensibles al contexto similares a las API del navegador <br> como se describe en la hoja de OWASP "Prevención <br> XSS basada en DOM". |  |
| OWASP A8: <br> Deserialización <br> insegura | Estos defectos ocurren cuando una <br> aplicación recibe objetos serializados <br> dañinos y estos objetos pueden ser <br> manipulados o borrados por el atacante <br> para realizar ataques. | El impacto de explotar las <br> vulnerabilidades de deserialización <br> puede conducir a ataques de repetición, <br> inyecciones o elevar sus privilegios de <br> ejecución. En el peor de los casos, la <br> deserialización puede conducir a la <br> ejecución remota de código en el <br> servidor. | Implementar verificaciones de integridad tales como <br> firmas digitales en cualquier objeto serializado para <br> evitar la creación de objetos hostiles o la manipulación <br> de datos. <br> Hacer cumplir estrictas restricciones de tipo durante la <br> deserialización, antes de la creación de objetos, ya que <br> el código generalmente espera un conjunto definible <br> de clases. Se han demostrado derivaciones a esta <br> técnica, por lo que no es aconsejable depender <br> únicamente de esto. <br> Aislar y ejecutar código que se desrealiza en entornos <br> de bajos privilegios cuando es posible. | Registrar excepciones y errores detectados de <br> deserialización, como cuando el tipo entrante <br> no es el tipo esperado, o la deserialización <br> presenta excepciones. También generar <br> alertas si un usuario concreto deserializa <br> constantemente. <br> Restringir la conectividad de red entrante y <br> saliente desde contenedores o servidores que <br> deserializan, monitorizando el proceso. |
| OWASP A9: <br> Empleo de <br> componentes con <br> vulnerabilidades | El vector de ataque tiene en cuenta que, <br> si bien es fácil encontrar exploits para <br> muchas vulnerabilidades conocidas, otras <br> vulnerabilidades requieren un esfuerzo | Algunos componentes tales como <br> librerías, frameworks y otros módulos <br> de software casi siempre funcionan con <br> todos los privilegios. Si e ataca un | Supervisar continuamente las fuentes como CVE y NVD <br> para detectar vulnerabilidades en los componentes. <br> Emplear herramientas de análisis de composición de <br> software para automatizar el proceso. | Debe haber un proceso de administración de <br> parches para eliminar dependencias no <br> utilizadas, características innecesarias, <br> componentes, archivos y documentación. |


![Imagen 1 - Página 35](858 DD_assets\pagina35_img1.png)

![Imagen 2 - Página 35](858 DD_assets\pagina35_img2.png)

![Imagen 3 - Página 35](858 DD_assets\pagina35_img3.png)

![Imagen 4 - Página 35](858 DD_assets\pagina35_img4.png)

![Imagen 5 - Página 35](858 DD_assets\pagina35_img5.png)

---

<!-- Página 36 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
conocidas concentrado para desarrollar un exploit componente vulnerable esto podría Suscribirse a las alertas por correo electrónico para Realizar un inventario continuo de las
personalizado. facilitar la intrusión en el servidor o una conocer las vulnerabilidades de seguridad relacionadas versiones de los componentes del lado del
perdida seria de datos. con los componentes que se utilizan. cliente y del lado del servidor (por ejemplo,
Únicamente obtener componentes de fuentes oficiales frameworks, bibliotecas) y sus dependencias.
a través de enlaces seguros. Preferiblemente paquetes Si no es posible aplicar parches, considere
firmados para reducir la posibilidad de incluir un implementar un parche virtual para
componente modificado y malicioso. monitorizar, detectar o proteger contra el
Supervisar las bibliotecas y los componentes que no problema descubierto.
están mantenidos o que no crean parches de seguridad Cada organización cliente debe asegurarse de
para versiones anteriores. que exista un plan continuo para monitorizar,
clasificar y aplicar actualizaciones o cambios
de configuración durante la vida útil de la
solución implantada.
La explotación insuficiente de LOGS y la Los ataques de mayor éxito empiezan Asegurarse de que todos los errores de inicio de Establecer monitorización y alertas efectivas
monitorización insuficiente, son la base con el sondeo de vulnerabilidades. sesión, control de acceso y validación de entrada del de manera que las actividades sospechosas se
de casi todos los incidentes importantes. Permitir que tales sondas continúen lado del servidor puedan registrarse con suficiente detecten y respondan de manera oportuna.
Los atacantes confían en la falta de actuando puede aumentar la contexto de usuario para identificar cuentas Establecer o adoptar un plan de respuesta y
monitorización y respuesta oportuna para probabilidad de una explotación exitosa sospechosas o maliciosas, y conservarse durante el recuperación de incidentes.
lograr sus objetivos sin ser detectados. casi al 100%. tiempo suficiente para permitir un análisis forense Emplear firewalls de aplicaciones web (WAF).
OWASP A10: diferido.
Insuficiente registro Asegurarse de que los registros se generen en un
y monitorización formato que las herramientas de correlación
centralizadas puedan tratarlo fácilmente.
Asegurarse de que las transacciones de alto valor
tengan una pista de auditoría con controles de
integridad para evitar alteraciones o supresiones, como
pueden ser tablas de bases de datos de solo agregar o
similares.
Otros Riesgos
Consecuencia Posible acción de mitigación del proveedor Posible acción de mitigación de la
Riesgo Descripción del riesgo
(impacto) (desarrollador) organización cliente
Ocurre cuando un desarrollador expone Comprometen toda la información que Deben evitarse referencias en claro a objetos de No aplica.
una referencia a un objeto de pueda ser referida por parámetros. implementación interna.
implementación interna, tal como un Efectuar análisis de código para mostrar rápidamente
Referencia directa a
fichero, directorio, o base de datos. Los si las autorizaciones se verifican correctamente
objetos
atacantes pueden manipular estas
referencias para acceder a datos no
autorizados.
Ausencia de control Este vector de ataque se da cuando no se Permiten el acceso no autorizado de los Las aplicaciones necesitan verificar el control de No aplica.
de acceso a verifica el control de accesos en el atacantes accesos en el servidor cuando se accede a cada una de
funciones servidor al acceder a cada una de las a funciones del sistema. Las funciones sus funciones.
Centro Criptológico Nacional 36

| conocidas | concentrado para desarrollar un exploit <br> personalizado. | componente vulnerable esto podría <br> facilitar la intrusión en el servidor o una <br> perdida seria de datos. |  |  | Suscribirse a las alertas por correo electrónico para <br> conocer las vulnerabilidades de seguridad relacionadas <br> con los componentes que se utilizan. <br> Únicamente obtener componentes de fuentes oficiales <br> a través de enlaces seguros. Preferiblemente paquetes <br> firmados para reducir la posibilidad de incluir un <br> componente modificado y malicioso. <br> Supervisar las bibliotecas y los componentes que no <br> están mantenidos o que no crean parches de seguridad <br> para versiones anteriores. |  |  | Realizar un inventario continuo de las <br> versiones de los componentes del lado del <br> cliente y del lado del servidor (por ejemplo, <br> frameworks, bibliotecas) y sus dependencias. <br> Si no es posible aplicar parches, considere <br> implementar un parche virtual para <br> monitorizar, detectar o proteger contra el <br> problema descubierto. <br> Cada organización cliente debe asegurarse de <br> que exista un plan continuo para monitorizar, <br> clasificar y aplicar actualizaciones o cambios <br> de configuración durante la vida útil de la <br> solución implantada. |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| OWASP A10: <br> Insuficiente registro <br> y monitorización | La explotación insuficiente de LOGS y la <br> monitorización insuficiente, son la base <br> de casi todos los incidentes importantes. <br> Los atacantes confían en la falta de <br> monitorización y respuesta oportuna para <br> lograr sus objetivos sin ser detectados. | Los ataques de mayor éxito empiezan <br> con el sondeo de vulnerabilidades. <br> Permitir que tales sondas continúen <br> actuando puede aumentar la <br> probabilidad de una explotación exitosa <br> casi al 100%. |  |  | Asegurarse de que todos los errores de inicio de <br> sesión, control de acceso y validación de entrada del <br> lado del servidor puedan registrarse con suficiente <br> contexto de usuario para identificar cuentas <br> sospechosas o maliciosas, y conservarse durante el <br> tiempo suficiente para permitir un análisis forense <br> diferido. <br> Asegurarse de que los registros se generen en un <br> formato que las herramientas de correlación <br> centralizadas puedan tratarlo fácilmente. <br> Asegurarse de que las transacciones de alto valor <br> tengan una pista de auditoría con controles de <br> integridad para evitar alteraciones o supresiones, como <br> pueden ser tablas de bases de datos de solo agregar o <br> similares. |  |  | Establecer monitorización y alertas efectivas <br> de manera que las actividades sospechosas se <br> detecten y respondan de manera oportuna. <br> Establecer o adoptar un plan de respuesta y <br> recuperación de incidentes. <br> Emplear firewalls de aplicaciones web (WAF). |  |  |
| Otros Riesgos |  |  |  |  |  |  |  |  |  |  |
| Riesgo | Descripción del riesgo |  | Consecuencia |  |  | Posible acción de mitigación del proveedor |  |  | Posible acción de mitigación de la |  |
|  |  |  | (impacto) |  |  | (desarrollador) |  |  | organización cliente |  |
| Referencia directa a <br> objetos | Ocurre cuando un desarrollador expone <br> una referencia a un objeto de <br> implementación interna, tal como un <br> fichero, directorio, o base de datos. Los <br> atacantes pueden manipular estas <br> referencias para acceder a datos no <br> autorizados. | Comprometen toda la información que <br> pueda ser referida por parámetros. |  |  | Deben evitarse referencias en claro a objetos de <br> implementación interna. <br> Efectuar análisis de código para mostrar rápidamente <br> si las autorizaciones se verifican correctamente |  |  | No aplica. |  |  |
| Ausencia de control <br> de acceso a <br> funciones | Este vector de ataque se da cuando no se <br> verifica el control de accesos en el <br> servidor al acceder a cada una de las | Permiten el acceso no autorizado de los <br> atacantes <br> a funciones del sistema. Las funciones |  |  | Las aplicaciones necesitan verificar el control de <br> accesos en el servidor cuando se accede a cada una de <br> sus funciones. |  |  | No aplica. |  |  |


![Imagen 1 - Página 36](858 DD_assets\pagina36_img1.png)

![Imagen 2 - Página 36](858 DD_assets\pagina36_img2.png)

![Imagen 3 - Página 36](858 DD_assets\pagina36_img3.png)

![Imagen 4 - Página 36](858 DD_assets\pagina36_img4.png)

![Imagen 5 - Página 36](858 DD_assets\pagina36_img5.png)

---

<!-- Página 37 de 37 -->

CCN-STIC-858 Implantación de sistemas ON-PREMISE
funciones. Si las solicitudes de acceso no administrativas son un objetivo clave de
se verifican, los atacantes podrán realizar este tipo de ataques
peticiones sin la autorización adecuada
accediendo a la función directamente.
Permite al atacante forzar al navegador Los atacantes pueden cambiar cualquier Realizar análisis de código para detectarlo. Realizar pruebas de penetración para
de la víctima para generar solicitudes que dato que detectarlo.
Falsificación de la aplicación vulnerable piensa que son la víctima está autorizada a cambiar, o
peticiones en sitios peticiones legítimas que provienen de la acceder cualquier funcionalidad donde
cruzados (CSRF) víctima. La detección es bastante fácil a esté autorizada, incluyendo registro,
través de pruebas de penetración o de cambio de estado o cierre de sesión.
análisis del código.
Algunas aplicaciones pueden filtrar Acceso a datos de estado interno y Codificar los mensajes de error que proporciona la Únicamente el equipo de soporte del
Manejo incorrecto involuntariamente información sobre su conocimiento de vulnerabilidades por aplicación de manera que se minimice la información proveedor de la solución y el CAU de la
de errores configuración y funcionamiento. medio de mensajes de error. proporcionada en los mismos. organización cliente deben conocer el
significado de los códigos de error.
Centro Criptológico Nacional 37

|  | funciones. Si las solicitudes de acceso no <br> se verifican, los atacantes podrán realizar <br> peticiones sin la autorización adecuada <br> accediendo a la función directamente. | administrativas son un objetivo clave de <br> este tipo de ataques |  |  |
| --- | --- | --- | --- | --- |
| Falsificación de <br> peticiones en sitios <br> cruzados (CSRF) | Permite al atacante forzar al navegador <br> de la víctima para generar solicitudes que <br> la aplicación vulnerable piensa que son <br> peticiones legítimas que provienen de la <br> víctima. La detección es bastante fácil a <br> través de pruebas de penetración o de <br> análisis del código. | Los atacantes pueden cambiar cualquier <br> dato que <br> la víctima está autorizada a cambiar, o <br> acceder cualquier funcionalidad donde <br> esté autorizada, incluyendo registro, <br> cambio de estado o cierre de sesión. | Realizar análisis de código para detectarlo. | Realizar pruebas de penetración para <br> detectarlo. |
| Manejo incorrecto <br> de errores | Algunas aplicaciones pueden filtrar <br> involuntariamente información sobre su <br> configuración y funcionamiento. | Acceso a datos de estado interno y <br> conocimiento de vulnerabilidades por <br> medio de mensajes de error. | Codificar los mensajes de error que proporciona la <br> aplicación de manera que se minimice la información <br> proporcionada en los mismos. | Únicamente el equipo de soporte del <br> proveedor de la solución y el CAU de la <br> organización cliente deben conocer el <br> significado de los códigos de error. |


![Imagen 1 - Página 37](858 DD_assets\pagina37_img1.png)

![Imagen 2 - Página 37](858 DD_assets\pagina37_img2.png)

![Imagen 3 - Página 37](858 DD_assets\pagina37_img3.png)

![Imagen 4 - Página 37](858 DD_assets\pagina37_img4.png)

![Imagen 5 - Página 37](858 DD_assets\pagina37_img5.png)