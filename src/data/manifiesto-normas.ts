/**
 * Manifiesto de normas CCN-STIC / ENS / BOE validas.
 *
 * Contiene la lista completa y ordenada de los 121 archivos .md validos
 * del directorio de normas. Todos los archivos son normas convertidas
 * desde PDF a markdown.
 *
 * Generado a partir del inventario verificado del repositorio.
 */

/** Cantidad total de normas validas esperadas en el directorio. */
export const TOTAL_NORMAS_ESPERADAS = 121;

/**
 * Lista completa y ordenada alfabeticamente de los 121 archivos .md validos.
 *
 * IMPORTANTE: los nombres de archivo deben coincidir EXACTAMENTE con los del
 * sistema de archivos, incluyendo espacios, guiones, guiones bajos, caracteres
 * acentuados y mayusculas/minusculas.
 */
export const MANIFIESTO_NORMAS: string[] = [
  '_CCN_STIC_887B.md',
  '_CCN-STIC 891 Perfil Cumplimiento Especifico Salud.md',
  '_CCN-STIC-889D_CS Oracle OCI Database-Instancias VM.md',
  '_CCN-STIC-889E_CS Oracle OCI Compute-Instancias VM y Bare Metal.md',
  '_CCN-STIC-889F CS Oracle C@C Sistemas Exadata-Autonomous DB.md',
  '11file.md',
  '800-Glosario_de_terminos_ENS.md',
  '801_ENS-responsabilidades.md',
  '802-Auditoria_ENS.md',
  '803_ENS-valoracion.md',
  '804_medidas_de_implantacion_del_ens.md',
  '805-ENS_politica.md',
  '806_ENS-adecuacion.md',
  '806_ENS-adecuacionAA.md',
  '807-Criptologia_de_empleo_ENS.md',
  '807-Criptologia_de_empleo_ENSC.md',
  '809.md',
  '811-Interconexion_en_el_ENS.md',
  '812-Entornos_y_aplicaciones_web.md',
  '813-Componentes_Certificados_en_el_ENS.md',
  '814-Seguridad_en_correo_electronico.md',
  '815_Metricas_e_indicadores_en_el_ENS.md',
  '816 OK.md',
  '820-Proteccion_contra_DoS.md',
  '821 1.md',
  '821 2.md',
  '821 3.md',
  '821 5.md',
  '821 6.md',
  '821 7.md',
  '8214.md',
  '821AA.md',
  '822-Procedimientos_de_seguridad-081112.md',
  '822-Procedimientos_de_seguridad-ANEXOI-081112.md',
  '822-Procedimientos_de_seguridad-ANEXOII-081112.md',
  '822-Procedimientos_de_seguridad-ANEXOIII-081112.md',
  '825.md',
  '825-27001_ENS.md',
  '827-Gestion_dispositivos_moviles_ENS.md',
  '834L.md',
  '852 AA.md',
  '852.md',
  '85211.md',
  '858 DD.md',
  '858 E.md',
  '858 RR.md',
  '881 22.md',
  '881.md',
  '881A.md',
  '881B.md',
  '881BC.md',
  '881C.md',
  '881GUIA.md',
  '882L.md',
  '88344.md',
  '884F.md',
  '885C.md',
  '885D.md',
  '885ES.md',
  '887.md',
  '887A.md',
  '887C.md',
  '887E.md',
  '887F.md',
  '887G.md',
  '8881A.md',
  '888C.md',
  '889-77.md',
  '889A.md',
  '889B.md',
  '889C.md',
  'Anexo III. Plan_Adecuación Diputaciones.md',
  'BOE-003_Codigo_de_la_Funcion_Publica.md',
  'BOE-029_Codigo_de_Administracion_Electronica.md',
  'BOE-031_Codigo_de_Contratos_del_Sector_Publico.md',
  'BOE-044_Codigo_de_Derecho_Administrativo.md',
  'BOE-282_Procedimiento_Administrativo_Comun.md',
  'BOE-A-2016-10108.md',
  'BOE-A-2016-10109.md',
  'BOE-A-2018-4573.md',
  'BOE-A-2018-5370.md',
  'CCN_STIC_836_Seguridad en VPN en el marco del ENS.md',
  'CCN-STIC 808.md',
  'CCN-STIC 819 Medidas Compensatorias.md',
  'CCN-STIC 823 Annex I - Clauses and Service Level Agreements-EN_.md',
  'CCN-STIC 831 Registro actividad de los usuarios.md',
  'CCN-STIC 883D - Perfil Cumplimiento Específico Diputaciones.md',
  'CCN-STIC 884D.md',
  'CCN-STIC 885A.md',
  'CCN-STIC 885B.md',
  'CCN-STIC 885E.md',
  'CCN-STIC 885F.md',
  'CCN-STIC 885G.md',
  'CCN-STIC 886 Perfil Cumplimiento Especifico para LORETO-NG BASE.md',
  'CCN-STIC 887D.md',
  'CCN-STIC 888B.md',
  'CCN-STIC 888-PERFIL_DE_CUMPLIMIENTO_GOOGLE_.md',
  'CCN-STIC 889J.md',
  'CCN-STIC 889K.md',
  'CCN-STIC 890.md',
  'CCN-STIC 896-PCE-SSG.md',
  'CCN-STIC 897.md',
  'CCN-STIC-817 National Security Framework cyber-incident management.md',
  'CCN-STIC-817_Gestion_de_Ciberincidentes_ENS.md',
  'CCN-STIC-823 Use of Cloud services-EN_.md',
  'CCN-STIC-826_Implementacion de Seguridad Nextcloud.md',
  'CCN-STIC-835 Borrado de Metadatos en el marco del ENS.md',
  'CCN-STIC-837 ENS - Seguridad en Bluetooth.md',
  'CCN-STIC-884A - Guia de Configuracion segura para Azure.md',
  'CCN-STIC-884B - Secure configuration guide for Azure Kubernetes Services EN.md',
  'CCN-STIC-884E - Guia de Configuracion segura para Azure Sentinel_.md',
  'CCN-STIC-885 - Office 365 Compliance Profile EN_.md',
  'CCN-STIC-885D - Secure configuration guide for Microsoft Teams EN.md',
  'CCN-STIC-889G.md',
  'CCN-STIC-889H.md',
  'CCN-STIC-889I.md',
  'ea89bfb7-7977-4f87-8164-7389948d9a5f.md',
  'file.html.md',
  'ORACLE889.md',
  'RD 311.2022.md',
  'SCP852.md',
];

/**
 * Valida los archivos presentes en la carpeta de normas contra el manifiesto.
 *
 * @param archivosEnCarpeta - Lista de nombres de archivo .md encontrados en el
 *   directorio de normas.
 * @returns Un objeto con dos listas:
 *   - `faltantes`: archivos que estan en el manifiesto pero no en la carpeta.
 *   - `desconocidos`: archivos que estan en la carpeta pero no en el manifiesto.
 */
export function validarManifiesto(archivosEnCarpeta: string[]): {
  faltantes: string[];
  desconocidos: string[];
} {
  const conjuntoManifiesto = new Set(MANIFIESTO_NORMAS);
  const conjuntoCarpeta = new Set(archivosEnCarpeta);

  const faltantes = MANIFIESTO_NORMAS.filter(
    (nombre) => !conjuntoCarpeta.has(nombre)
  );

  const desconocidos = archivosEnCarpeta.filter(
    (nombre) => !conjuntoManifiesto.has(nombre)
  );

  return { faltantes, desconocidos };
}
